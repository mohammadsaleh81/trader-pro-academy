var Md=Object.defineProperty;var _i=t=>{throw TypeError(t)};var Dd=(t,s,r)=>s in t?Md(t,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[s]=r;var Fs=(t,s,r)=>Dd(t,typeof s!="symbol"?s+"":s,r),sa=(t,s,r)=>s.has(t)||_i("Cannot "+r);var M=(t,s,r)=>(sa(t,s,"read from private field"),r?r.call(t):s.get(t)),je=(t,s,r)=>s.has(t)?_i("Cannot add the same private member more than once"):s instanceof WeakSet?s.add(t):s.set(t,r),oe=(t,s,r,n)=>(sa(t,s,"write to private field"),n?n.call(t,r):s.set(t,r),r),nt=(t,s,r)=>(sa(t,s,"access private method"),r);var Zr=(t,s,r,n)=>({set _(a){oe(t,s,a,r)},get _(){return M(t,s,n)}});import{t as $d,b as Fd,j as e,d as Wr,e as Bd,u as En,S as Fo}from"./vendor-ui-B3Oz90YK.js";import{a as Ud,r as m,R as U,v as zd,u as Ze,L as me,c as dr,d as Ms,e as Hd,N as Vs,O as Bo,B as qd,f as Wd,g as ve}from"./vendor-react-BuQ4bly7.js";import{V as Uo,R as zo,A as Ho,C as qo,T as Wo,D as Vo,P as Vd,c as kn,a as Ba,b as Go,d as Gd,e as Kd,f as Qd,g as Yd,h as $t,i as Mt,j as Jd,O as Ko,k as Xd,l as Qo,m as Zd,n as Yo,o as Jo,p as eu,q as Xo,r as tu,I as su,u as ru,s as Zo,t as nu,S as el,v as tl,w as au,x as sl,y as rl,z as nl,B as al,E as il,L as ol,F as ll,G as iu,H as ou,J as cl,K as dl,M as ul,N as ml,Q as lu,U as hl,W as cu,X as du,Y as uu,Z as mu}from"./vendor-components-BE2aZuOm.js";import{u as hu,F as fu,C as pu,o as xu,r as gu,a as bu,b as fl,n as yu,c as pl,s as ra}from"./vendor-form-DkNWSewD.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var xl,Ii=Ud;xl=Ii.createRoot,Ii.hydrateRoot;const vu=1,ju=5e3;let na=0;function Nu(){return na=(na+1)%Number.MAX_SAFE_INTEGER,na.toString()}const aa=new Map,Ri=t=>{if(aa.has(t))return;const s=setTimeout(()=>{aa.delete(t),Er({type:"REMOVE_TOAST",toastId:t})},ju);aa.set(t,s)},wu=(t,s)=>{switch(s.type){case"ADD_TOAST":return{...t,toasts:[s.toast,...t.toasts].slice(0,vu)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(r=>r.id===s.toast.id?{...r,...s.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=s;return r?Ri(r):t.toasts.forEach(n=>{Ri(n.id)}),{...t,toasts:t.toasts.map(n=>n.id===r||r===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return s.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(r=>r.id!==s.toastId)}}},nn=[];let an={toasts:[]};function Er(t){an=wu(an,t),nn.forEach(s=>{s(an)})}function be({...t}){const s=Nu(),r=a=>Er({type:"UPDATE_TOAST",toast:{...a,id:s}}),n=()=>Er({type:"DISMISS_TOAST",toastId:s});return Er({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:a=>{a||n()}}}),{id:s,dismiss:n,update:r}}be.success=t=>be({...t,variant:"success"});be.info=t=>be({...t,variant:"info"});be.warning=t=>be({...t,variant:"warning"});be.destructive=t=>be({...t,variant:"destructive"});function ot(){const[t,s]=m.useState(an);return m.useEffect(()=>(nn.push(s),()=>{const r=nn.indexOf(s);r>-1&&nn.splice(r,1)}),[t]),{...t,toast:be,dismiss:r=>Er({type:"DISMISS_TOAST",toastId:r})}}/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Su=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),gl=(...t)=>t.filter((s,r,n)=>!!s&&s.trim()!==""&&n.indexOf(s)===r).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Cu={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eu=m.forwardRef(({color:t="currentColor",size:s=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:i,iconNode:o,...c},l)=>m.createElement("svg",{ref:l,...Cu,width:s,height:s,stroke:t,strokeWidth:n?Number(r)*24/Number(s):r,className:gl("lucide",a),...c},[...o.map(([d,u])=>m.createElement(d,u)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=(t,s)=>{const r=m.forwardRef(({className:n,...a},i)=>m.createElement(Eu,{ref:i,iconNode:s,className:gl(`lucide-${Su(t)}`,n),...a}));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ua=J("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yt=J("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bl=J("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const va=J("BellOff",[["path",{d:"M8.7 3A6 6 0 0 1 18 8a21.3 21.3 0 0 0 .6 5",key:"o7mx20"}],["path",{d:"M17 17H3s3-2 3-9a4.67 4.67 0 0 1 .3-1.7",key:"16f1lm"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ir=J("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ur=J("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yl=J("BookmarkPlus",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}],["line",{x1:"12",x2:"12",y1:"7",y2:"13",key:"1cppfj"}],["line",{x1:"15",x2:"9",y1:"10",y2:"10",key:"1gty7f"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ps=J("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ku=J("Bug",[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tn=J("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tu=J("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const za=J("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pu=J("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ja=J("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vl=J("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gs=J("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oi=J("CircleArrowUp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=J("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const or=J("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Au=J("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qt=J("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _u=J("Dot",[["circle",{cx:"12.1",cy:"12.1",r:"1",key:"18d7e5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ha=J("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iu=J("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ru=J("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ou=J("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _s=J("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lu=J("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mu=J("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Du=J("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jl=J("Headphones",[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $u=J("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fu=J("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qa=J("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bu=J("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kt=J("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bs=J("Loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wa=J("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uu=J("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ia=J("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zu=J("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hu=J("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qu=J("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nl=J("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Is=J("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ir=J("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pn=J("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wu=J("Reply",[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rr=J("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vu=J("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ks=J("Share",[["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["polyline",{points:"16 6 12 2 8 6",key:"m901s6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"15",key:"1p0rca"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Li=J("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ys=J("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gu=J("SkipBack",[["polygon",{points:"19 20 9 12 19 4 19 20",key:"o2sva"}],["line",{x1:"5",x2:"5",y1:"19",y2:"5",key:"1ocqjk"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wl=J("SkipForward",[["polygon",{points:"5 4 15 12 5 20 5 4",key:"16p6eg"}],["line",{x1:"19",x2:"19",y1:"5",y2:"19",key:"futhcm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kr=J("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ku=J("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sl=J("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Na=J("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qs=J("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qu=J("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yu=J("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vs=J("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Or=J("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Va=J("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ju=J("Volume2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cl=J("Wallet",[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lr=J("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oa=J("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);function W(...t){return $d(Fd(t))}function El(t){try{return new Date(t).toLocaleDateString("fa-IR",{year:"numeric",month:"long",day:"numeric"})}catch{return t}}function Gt(t){if(typeof t=="string")return t;if(typeof t=="object"&&t!==null){if(t.first_name&&t.last_name)return`${t.first_name} ${t.last_name}`;if(t.first_name)return t.first_name;if(t.username)return t.username;if(t.email)return t.email}return"نویسنده"}function Xu(t){if(!t)return"زمان شروع مشخص نشده";try{return new Date(t).toLocaleString("fa-IR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return t}}const Zu=Vd,kl=m.forwardRef(({className:t,...s},r)=>e.jsx(Uo,{ref:r,className:W("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...s}));kl.displayName=Uo.displayName;const em=Wr("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground",success:"success group border-green-200 bg-green-50 text-green-800",info:"info group border-blue-200 bg-blue-50 text-blue-800",warning:"warning group border-amber-200 bg-amber-50 text-amber-800"}},defaultVariants:{variant:"default"}}),Tl=m.forwardRef(({className:t,variant:s,...r},n)=>e.jsx(zo,{ref:n,className:W(em({variant:s}),"animate-fade-in",t),...r}));Tl.displayName=zo.displayName;const tm=m.forwardRef(({className:t,...s},r)=>e.jsx(Ho,{ref:r,className:W("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...s}));tm.displayName=Ho.displayName;const Pl=m.forwardRef(({className:t,...s},r)=>e.jsx(qo,{ref:r,className:W("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...s,children:e.jsx(Lr,{className:"h-4 w-4"})}));Pl.displayName=qo.displayName;const Al=m.forwardRef(({className:t,...s},r)=>e.jsx(Wo,{ref:r,className:W("text-sm font-semibold",t),...s}));Al.displayName=Wo.displayName;const _l=m.forwardRef(({className:t,...s},r)=>e.jsx(Vo,{ref:r,className:W("text-sm opacity-90",t),...s}));_l.displayName=Vo.displayName;const sm=({variant:t})=>t==="success"?e.jsx(mt,{className:"h-5 w-5 text-green-500 mr-2"}):t==="destructive"?e.jsx(or,{className:"h-5 w-5 text-red-500 mr-2"}):t==="warning"?e.jsx(Qs,{className:"h-5 w-5 text-amber-500 mr-2"}):t==="info"?e.jsx(qa,{className:"h-5 w-5 text-blue-500 mr-2"}):null,Il=m.forwardRef(({variant:t,children:s,className:r,...n},a)=>e.jsx(Tl,{ref:a,variant:t,className:W("flex",r),...n,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(sm,{variant:t}),s]})}));Il.displayName="ToastWithIcon";function rm(){const{toasts:t}=ot();return e.jsxs(Zu,{children:[t.map(function({id:s,title:r,description:n,action:a,variant:i,...o}){return e.jsxs(Il,{variant:i,...o,children:[e.jsxs("div",{className:"grid gap-1",children:[r&&e.jsx(Al,{children:r}),n&&e.jsx(_l,{children:n})]}),a,e.jsx(Pl,{})]},s)}),e.jsx(kl,{})]})}var Mi=["light","dark"],nm="(prefers-color-scheme: dark)",am=m.createContext(void 0),im={setTheme:t=>{},themes:[]},om=()=>{var t;return(t=m.useContext(am))!=null?t:im};m.memo(({forcedTheme:t,storageKey:s,attribute:r,enableSystem:n,enableColorScheme:a,defaultTheme:i,value:o,attrs:c,nonce:l})=>{let d=i==="system",u=r==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${c.map(g=>`'${g}'`).join(",")})`};`:`var d=document.documentElement,n='${r}',s='setAttribute';`,h=a?Mi.includes(i)&&i?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${i}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",f=(g,y=!1,b=!0)=>{let p=o?o[g]:g,j=y?g+"|| ''":`'${p}'`,v="";return a&&b&&!y&&Mi.includes(g)&&(v+=`d.style.colorScheme = '${g}';`),r==="class"?y||p?v+=`c.add(${j})`:v+="null":p&&(v+=`d[s](n,${j})`),v},x=t?`!function(){${u}${f(t)}}()`:n?`!function(){try{${u}var e=localStorage.getItem('${s}');if('system'===e||(!e&&${d})){var t='${nm}',m=window.matchMedia(t);if(m.media!==t||m.matches){${f("dark")}}else{${f("light")}}}else if(e){${o?`var x=${JSON.stringify(o)};`:""}${f(o?"x[e]":"e",!0)}}${d?"":"else{"+f(i,!1,!1)+"}"}${h}}catch(e){}}()`:`!function(){try{${u}var e=localStorage.getItem('${s}');if(e){${o?`var x=${JSON.stringify(o)};`:""}${f(o?"x[e]":"e",!0)}}else{${f(i,!1,!1)};}${h}}catch(t){}}();`;return m.createElement("script",{nonce:l,dangerouslySetInnerHTML:{__html:x}})});var lm=t=>{switch(t){case"success":return um;case"info":return hm;case"warning":return mm;case"error":return fm;default:return null}},cm=Array(12).fill(0),dm=({visible:t,className:s})=>U.createElement("div",{className:["sonner-loading-wrapper",s].filter(Boolean).join(" "),"data-visible":t},U.createElement("div",{className:"sonner-spinner"},cm.map((r,n)=>U.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),um=U.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},U.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),mm=U.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},U.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),hm=U.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},U.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),fm=U.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},U.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),pm=U.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},U.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),U.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),xm=()=>{let[t,s]=U.useState(document.hidden);return U.useEffect(()=>{let r=()=>{s(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),t},wa=1,gm=class{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{let s=this.subscribers.indexOf(t);this.subscribers.splice(s,1)}),this.publish=t=>{this.subscribers.forEach(s=>s(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var s;let{message:r,...n}=t,a=typeof(t==null?void 0:t.id)=="number"||((s=t.id)==null?void 0:s.length)>0?t.id:wa++,i=this.toasts.find(c=>c.id===a),o=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(a)&&this.dismissedToasts.delete(a),i?this.toasts=this.toasts.map(c=>c.id===a?(this.publish({...c,...t,id:a,title:r}),{...c,...t,id:a,dismissible:o,title:r}):c):this.addToast({title:r,...n,dismissible:o,id:a}),a},this.dismiss=t=>(this.dismissedToasts.add(t),t||this.toasts.forEach(s=>{this.subscribers.forEach(r=>r({id:s.id,dismiss:!0}))}),this.subscribers.forEach(s=>s({id:t,dismiss:!0})),t),this.message=(t,s)=>this.create({...s,message:t}),this.error=(t,s)=>this.create({...s,message:t,type:"error"}),this.success=(t,s)=>this.create({...s,type:"success",message:t}),this.info=(t,s)=>this.create({...s,type:"info",message:t}),this.warning=(t,s)=>this.create({...s,type:"warning",message:t}),this.loading=(t,s)=>this.create({...s,type:"loading",message:t}),this.promise=(t,s)=>{if(!s)return;let r;s.loading!==void 0&&(r=this.create({...s,promise:t,type:"loading",message:s.loading,description:typeof s.description!="function"?s.description:void 0}));let n=t instanceof Promise?t:t(),a=r!==void 0,i,o=n.then(async l=>{if(i=["resolve",l],U.isValidElement(l))a=!1,this.create({id:r,type:"default",message:l});else if(ym(l)&&!l.ok){a=!1;let d=typeof s.error=="function"?await s.error(`HTTP error! status: ${l.status}`):s.error,u=typeof s.description=="function"?await s.description(`HTTP error! status: ${l.status}`):s.description;this.create({id:r,type:"error",message:d,description:u})}else if(s.success!==void 0){a=!1;let d=typeof s.success=="function"?await s.success(l):s.success,u=typeof s.description=="function"?await s.description(l):s.description;this.create({id:r,type:"success",message:d,description:u})}}).catch(async l=>{if(i=["reject",l],s.error!==void 0){a=!1;let d=typeof s.error=="function"?await s.error(l):s.error,u=typeof s.description=="function"?await s.description(l):s.description;this.create({id:r,type:"error",message:d,description:u})}}).finally(()=>{var l;a&&(this.dismiss(r),r=void 0),(l=s.finally)==null||l.call(s)}),c=()=>new Promise((l,d)=>o.then(()=>i[0]==="reject"?d(i[1]):l(i[1])).catch(d));return typeof r!="string"&&typeof r!="number"?{unwrap:c}:Object.assign(r,{unwrap:c})},this.custom=(t,s)=>{let r=(s==null?void 0:s.id)||wa++;return this.create({jsx:t(r),id:r,...s}),r},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},gt=new gm,bm=(t,s)=>{let r=(s==null?void 0:s.id)||wa++;return gt.addToast({title:t,...s,id:r}),r},ym=t=>t&&typeof t=="object"&&"ok"in t&&typeof t.ok=="boolean"&&"status"in t&&typeof t.status=="number",vm=bm,jm=()=>gt.toasts,Nm=()=>gt.getActiveToasts(),wm=Object.assign(vm,{success:gt.success,info:gt.info,warning:gt.warning,error:gt.error,custom:gt.custom,message:gt.message,promise:gt.promise,dismiss:gt.dismiss,loading:gt.loading},{getHistory:jm,getToasts:Nm});function Sm(t,{insertAt:s}={}){if(typeof document>"u")return;let r=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",s==="top"&&r.firstChild?r.insertBefore(n,r.firstChild):r.appendChild(n),n.styleSheet?n.styleSheet.cssText=t:n.appendChild(document.createTextNode(t))}Sm(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function en(t){return t.label!==void 0}var Cm=3,Em="32px",km="16px",Di=4e3,Tm=356,Pm=14,Am=20,_m=200;function _t(...t){return t.filter(Boolean).join(" ")}function Im(t){let[s,r]=t.split("-"),n=[];return s&&n.push(s),r&&n.push(r),n}var Rm=t=>{var s,r,n,a,i,o,c,l,d,u,h;let{invert:f,toast:x,unstyled:g,interacting:y,setHeights:b,visibleToasts:p,heights:j,index:v,toasts:w,expanded:N,removeToast:k,defaultRichColors:S,closeButton:E,style:A,cancelButtonStyle:z,actionButtonStyle:D,className:T="",descriptionClassName:R="",duration:F,position:Z,gap:B,loadingIcon:Y,expandByDefault:I,classNames:P,icons:_,closeButtonAriaLabel:L="Close toast",pauseWhenPageIsHidden:q}=t,[V,K]=U.useState(null),[se,ze]=U.useState(null),[ie,Ae]=U.useState(!1),[He,Le]=U.useState(!1),[ge,Q]=U.useState(!1),[xe,G]=U.useState(!1),[ee,ye]=U.useState(!1),[Ne,Se]=U.useState(0),[ue,ke]=U.useState(0),Qe=U.useRef(x.duration||F||Di),We=U.useRef(null),Me=U.useRef(null),Ve=v===0,Ge=v+1<=p,we=x.type,Ke=x.dismissible!==!1,Jt=x.className||"",Pt=x.descriptionClassName||"",et=U.useMemo(()=>j.findIndex(X=>X.toastId===x.id)||0,[j,x.id]),Bt=U.useMemo(()=>{var X;return(X=x.closeButton)!=null?X:E},[x.closeButton,E]),vt=U.useMemo(()=>x.duration||F||Di,[x.duration,F]),qe=U.useRef(0),$e=U.useRef(0),jt=U.useRef(0),Ct=U.useRef(null),[Ns,fr]=Z.split("-"),Ut=U.useMemo(()=>j.reduce((X,he,Ce)=>Ce>=et?X:X+he.height,0),[j,et]),Xt=xm(),Ds=x.invert||f,Et=we==="loading";$e.current=U.useMemo(()=>et*B+Ut,[et,Ut]),U.useEffect(()=>{Qe.current=vt},[vt]),U.useEffect(()=>{Ae(!0)},[]),U.useEffect(()=>{let X=Me.current;if(X){let he=X.getBoundingClientRect().height;return ke(he),b(Ce=>[{toastId:x.id,height:he,position:x.position},...Ce]),()=>b(Ce=>Ce.filter(pt=>pt.toastId!==x.id))}},[b,x.id]),U.useLayoutEffect(()=>{if(!ie)return;let X=Me.current,he=X.style.height;X.style.height="auto";let Ce=X.getBoundingClientRect().height;X.style.height=he,ke(Ce),b(pt=>pt.find(lt=>lt.toastId===x.id)?pt.map(lt=>lt.toastId===x.id?{...lt,height:Ce}:lt):[{toastId:x.id,height:Ce,position:x.position},...pt])},[ie,x.title,x.description,b,x.id]);let Nt=U.useCallback(()=>{Le(!0),Se($e.current),b(X=>X.filter(he=>he.toastId!==x.id)),setTimeout(()=>{k(x)},_m)},[x,k,b,$e]);U.useEffect(()=>{if(x.promise&&we==="loading"||x.duration===1/0||x.type==="loading")return;let X;return N||y||q&&Xt?(()=>{if(jt.current<qe.current){let he=new Date().getTime()-qe.current;Qe.current=Qe.current-he}jt.current=new Date().getTime()})():Qe.current!==1/0&&(qe.current=new Date().getTime(),X=setTimeout(()=>{var he;(he=x.onAutoClose)==null||he.call(x,x),Nt()},Qe.current)),()=>clearTimeout(X)},[N,y,x,we,q,Xt,Nt]),U.useEffect(()=>{x.delete&&Nt()},[Nt,x.delete]);function pr(){var X,he,Ce;return _!=null&&_.loading?U.createElement("div",{className:_t(P==null?void 0:P.loader,(X=x==null?void 0:x.classNames)==null?void 0:X.loader,"sonner-loader"),"data-visible":we==="loading"},_.loading):Y?U.createElement("div",{className:_t(P==null?void 0:P.loader,(he=x==null?void 0:x.classNames)==null?void 0:he.loader,"sonner-loader"),"data-visible":we==="loading"},Y):U.createElement(dm,{className:_t(P==null?void 0:P.loader,(Ce=x==null?void 0:x.classNames)==null?void 0:Ce.loader),visible:we==="loading"})}return U.createElement("li",{tabIndex:0,ref:Me,className:_t(T,Jt,P==null?void 0:P.toast,(s=x==null?void 0:x.classNames)==null?void 0:s.toast,P==null?void 0:P.default,P==null?void 0:P[we],(r=x==null?void 0:x.classNames)==null?void 0:r[we]),"data-sonner-toast":"","data-rich-colors":(n=x.richColors)!=null?n:S,"data-styled":!(x.jsx||x.unstyled||g),"data-mounted":ie,"data-promise":!!x.promise,"data-swiped":ee,"data-removed":He,"data-visible":Ge,"data-y-position":Ns,"data-x-position":fr,"data-index":v,"data-front":Ve,"data-swiping":ge,"data-dismissible":Ke,"data-type":we,"data-invert":Ds,"data-swipe-out":xe,"data-swipe-direction":se,"data-expanded":!!(N||I&&ie),style:{"--index":v,"--toasts-before":v,"--z-index":w.length-v,"--offset":`${He?Ne:$e.current}px`,"--initial-height":I?"auto":`${ue}px`,...A,...x.style},onDragEnd:()=>{Q(!1),K(null),Ct.current=null},onPointerDown:X=>{Et||!Ke||(We.current=new Date,Se($e.current),X.target.setPointerCapture(X.pointerId),X.target.tagName!=="BUTTON"&&(Q(!0),Ct.current={x:X.clientX,y:X.clientY}))},onPointerUp:()=>{var X,he,Ce,pt;if(xe||!Ke)return;Ct.current=null;let lt=Number(((X=Me.current)==null?void 0:X.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),At=Number(((he=Me.current)==null?void 0:he.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),zt=new Date().getTime()-((Ce=We.current)==null?void 0:Ce.getTime()),wt=V==="x"?lt:At,Ye=Math.abs(wt)/zt;if(Math.abs(wt)>=Am||Ye>.11){Se($e.current),(pt=x.onDismiss)==null||pt.call(x,x),ze(V==="x"?lt>0?"right":"left":At>0?"down":"up"),Nt(),G(!0),ye(!1);return}Q(!1),K(null)},onPointerMove:X=>{var he,Ce,pt,lt;if(!Ct.current||!Ke||((he=window.getSelection())==null?void 0:he.toString().length)>0)return;let At=X.clientY-Ct.current.y,zt=X.clientX-Ct.current.x,wt=(Ce=t.swipeDirections)!=null?Ce:Im(Z);!V&&(Math.abs(zt)>1||Math.abs(At)>1)&&K(Math.abs(zt)>Math.abs(At)?"x":"y");let Ye={x:0,y:0};V==="y"?(wt.includes("top")||wt.includes("bottom"))&&(wt.includes("top")&&At<0||wt.includes("bottom")&&At>0)&&(Ye.y=At):V==="x"&&(wt.includes("left")||wt.includes("right"))&&(wt.includes("left")&&zt<0||wt.includes("right")&&zt>0)&&(Ye.x=zt),(Math.abs(Ye.x)>0||Math.abs(Ye.y)>0)&&ye(!0),(pt=Me.current)==null||pt.style.setProperty("--swipe-amount-x",`${Ye.x}px`),(lt=Me.current)==null||lt.style.setProperty("--swipe-amount-y",`${Ye.y}px`)}},Bt&&!x.jsx?U.createElement("button",{"aria-label":L,"data-disabled":Et,"data-close-button":!0,onClick:Et||!Ke?()=>{}:()=>{var X;Nt(),(X=x.onDismiss)==null||X.call(x,x)},className:_t(P==null?void 0:P.closeButton,(a=x==null?void 0:x.classNames)==null?void 0:a.closeButton)},(i=_==null?void 0:_.close)!=null?i:pm):null,x.jsx||m.isValidElement(x.title)?x.jsx?x.jsx:typeof x.title=="function"?x.title():x.title:U.createElement(U.Fragment,null,we||x.icon||x.promise?U.createElement("div",{"data-icon":"",className:_t(P==null?void 0:P.icon,(o=x==null?void 0:x.classNames)==null?void 0:o.icon)},x.promise||x.type==="loading"&&!x.icon?x.icon||pr():null,x.type!=="loading"?x.icon||(_==null?void 0:_[we])||lm(we):null):null,U.createElement("div",{"data-content":"",className:_t(P==null?void 0:P.content,(c=x==null?void 0:x.classNames)==null?void 0:c.content)},U.createElement("div",{"data-title":"",className:_t(P==null?void 0:P.title,(l=x==null?void 0:x.classNames)==null?void 0:l.title)},typeof x.title=="function"?x.title():x.title),x.description?U.createElement("div",{"data-description":"",className:_t(R,Pt,P==null?void 0:P.description,(d=x==null?void 0:x.classNames)==null?void 0:d.description)},typeof x.description=="function"?x.description():x.description):null),m.isValidElement(x.cancel)?x.cancel:x.cancel&&en(x.cancel)?U.createElement("button",{"data-button":!0,"data-cancel":!0,style:x.cancelButtonStyle||z,onClick:X=>{var he,Ce;en(x.cancel)&&Ke&&((Ce=(he=x.cancel).onClick)==null||Ce.call(he,X),Nt())},className:_t(P==null?void 0:P.cancelButton,(u=x==null?void 0:x.classNames)==null?void 0:u.cancelButton)},x.cancel.label):null,m.isValidElement(x.action)?x.action:x.action&&en(x.action)?U.createElement("button",{"data-button":!0,"data-action":!0,style:x.actionButtonStyle||D,onClick:X=>{var he,Ce;en(x.action)&&((Ce=(he=x.action).onClick)==null||Ce.call(he,X),!X.defaultPrevented&&Nt())},className:_t(P==null?void 0:P.actionButton,(h=x==null?void 0:x.classNames)==null?void 0:h.actionButton)},x.action.label):null))};function $i(){if(typeof window>"u"||typeof document>"u")return"ltr";let t=document.documentElement.getAttribute("dir");return t==="auto"||!t?window.getComputedStyle(document.documentElement).direction:t}function Om(t,s){let r={};return[t,s].forEach((n,a)=>{let i=a===1,o=i?"--mobile-offset":"--offset",c=i?km:Em;function l(d){["top","right","bottom","left"].forEach(u=>{r[`${o}-${u}`]=typeof d=="number"?`${d}px`:d})}typeof n=="number"||typeof n=="string"?l(n):typeof n=="object"?["top","right","bottom","left"].forEach(d=>{n[d]===void 0?r[`${o}-${d}`]=c:r[`${o}-${d}`]=typeof n[d]=="number"?`${n[d]}px`:n[d]}):l(c)}),r}var Lm=m.forwardRef(function(t,s){let{invert:r,position:n="bottom-right",hotkey:a=["altKey","KeyT"],expand:i,closeButton:o,className:c,offset:l,mobileOffset:d,theme:u="light",richColors:h,duration:f,style:x,visibleToasts:g=Cm,toastOptions:y,dir:b=$i(),gap:p=Pm,loadingIcon:j,icons:v,containerAriaLabel:w="Notifications",pauseWhenPageIsHidden:N}=t,[k,S]=U.useState([]),E=U.useMemo(()=>Array.from(new Set([n].concat(k.filter(q=>q.position).map(q=>q.position)))),[k,n]),[A,z]=U.useState([]),[D,T]=U.useState(!1),[R,F]=U.useState(!1),[Z,B]=U.useState(u!=="system"?u:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),Y=U.useRef(null),I=a.join("+").replace(/Key/g,"").replace(/Digit/g,""),P=U.useRef(null),_=U.useRef(!1),L=U.useCallback(q=>{S(V=>{var K;return(K=V.find(se=>se.id===q.id))!=null&&K.delete||gt.dismiss(q.id),V.filter(({id:se})=>se!==q.id)})},[]);return U.useEffect(()=>gt.subscribe(q=>{if(q.dismiss){S(V=>V.map(K=>K.id===q.id?{...K,delete:!0}:K));return}setTimeout(()=>{zd.flushSync(()=>{S(V=>{let K=V.findIndex(se=>se.id===q.id);return K!==-1?[...V.slice(0,K),{...V[K],...q},...V.slice(K+1)]:[q,...V]})})})}),[]),U.useEffect(()=>{if(u!=="system"){B(u);return}if(u==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?B("dark"):B("light")),typeof window>"u")return;let q=window.matchMedia("(prefers-color-scheme: dark)");try{q.addEventListener("change",({matches:V})=>{B(V?"dark":"light")})}catch{q.addListener(({matches:K})=>{try{B(K?"dark":"light")}catch(se){console.error(se)}})}},[u]),U.useEffect(()=>{k.length<=1&&T(!1)},[k]),U.useEffect(()=>{let q=V=>{var K,se;a.every(ze=>V[ze]||V.code===ze)&&(T(!0),(K=Y.current)==null||K.focus()),V.code==="Escape"&&(document.activeElement===Y.current||(se=Y.current)!=null&&se.contains(document.activeElement))&&T(!1)};return document.addEventListener("keydown",q),()=>document.removeEventListener("keydown",q)},[a]),U.useEffect(()=>{if(Y.current)return()=>{P.current&&(P.current.focus({preventScroll:!0}),P.current=null,_.current=!1)}},[Y.current]),U.createElement("section",{ref:s,"aria-label":`${w} ${I}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},E.map((q,V)=>{var K;let[se,ze]=q.split("-");return k.length?U.createElement("ol",{key:q,dir:b==="auto"?$i():b,tabIndex:-1,ref:Y,className:c,"data-sonner-toaster":!0,"data-theme":Z,"data-y-position":se,"data-lifted":D&&k.length>1&&!i,"data-x-position":ze,style:{"--front-toast-height":`${((K=A[0])==null?void 0:K.height)||0}px`,"--width":`${Tm}px`,"--gap":`${p}px`,...x,...Om(l,d)},onBlur:ie=>{_.current&&!ie.currentTarget.contains(ie.relatedTarget)&&(_.current=!1,P.current&&(P.current.focus({preventScroll:!0}),P.current=null))},onFocus:ie=>{ie.target instanceof HTMLElement&&ie.target.dataset.dismissible==="false"||_.current||(_.current=!0,P.current=ie.relatedTarget)},onMouseEnter:()=>T(!0),onMouseMove:()=>T(!0),onMouseLeave:()=>{R||T(!1)},onDragEnd:()=>T(!1),onPointerDown:ie=>{ie.target instanceof HTMLElement&&ie.target.dataset.dismissible==="false"||F(!0)},onPointerUp:()=>F(!1)},k.filter(ie=>!ie.position&&V===0||ie.position===q).map((ie,Ae)=>{var He,Le;return U.createElement(Rm,{key:ie.id,icons:v,index:Ae,toast:ie,defaultRichColors:h,duration:(He=y==null?void 0:y.duration)!=null?He:f,className:y==null?void 0:y.className,descriptionClassName:y==null?void 0:y.descriptionClassName,invert:r,visibleToasts:g,closeButton:(Le=y==null?void 0:y.closeButton)!=null?Le:o,interacting:R,position:q,style:y==null?void 0:y.style,unstyled:y==null?void 0:y.unstyled,classNames:y==null?void 0:y.classNames,cancelButtonStyle:y==null?void 0:y.cancelButtonStyle,actionButtonStyle:y==null?void 0:y.actionButtonStyle,removeToast:L,toasts:k.filter(ge=>ge.position==ie.position),heights:A.filter(ge=>ge.position==ie.position),setHeights:z,expandByDefault:i,gap:p,loadingIcon:j,expanded:D,pauseWhenPageIsHidden:N,swipeDirections:t.swipeDirections})})):null}))});const Mm=({...t})=>{const{theme:s="system"}=om();return e.jsx(Lm,{theme:s,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg group-[.toaster]:animate-fade-in",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground",success:"group-[.toaster]:border-green-200 group-[.toaster]:bg-green-50 group-[.toaster]:text-green-800",error:"group-[.toaster]:border-red-200 group-[.toaster]:bg-red-50 group-[.toaster]:text-red-800",warning:"group-[.toaster]:border-amber-200 group-[.toaster]:bg-amber-50 group-[.toaster]:text-amber-800",info:"group-[.toaster]:border-blue-200 group-[.toaster]:bg-blue-50 group-[.toaster]:text-blue-800"}},...t})};({...wm});var[An,A0]=kn("Tooltip",[Go]),Ga=Go(),Rl="TooltipProvider",Dm=700,Fi="tooltip.open",[$m,Ol]=An(Rl),Ll=t=>{const{__scopeTooltip:s,delayDuration:r=Dm,skipDelayDuration:n=300,disableHoverableContent:a=!1,children:i}=t,o=m.useRef(!0),c=m.useRef(!1),l=m.useRef(0);return m.useEffect(()=>{const d=l.current;return()=>window.clearTimeout(d)},[]),e.jsx($m,{scope:s,isOpenDelayedRef:o,delayDuration:r,onOpen:m.useCallback(()=>{window.clearTimeout(l.current),o.current=!1},[]),onClose:m.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>o.current=!0,n)},[n]),isPointerInTransitRef:c,onPointerInTransitChange:m.useCallback(d=>{c.current=d},[]),disableHoverableContent:a,children:i})};Ll.displayName=Rl;var Ml="Tooltip",[_0,_n]=An(Ml),Sa="TooltipTrigger",Fm=m.forwardRef((t,s)=>{const{__scopeTooltip:r,...n}=t,a=_n(Sa,r),i=Ol(Sa,r),o=Ga(r),c=m.useRef(null),l=En(s,c,a.onTriggerChange),d=m.useRef(!1),u=m.useRef(!1),h=m.useCallback(()=>d.current=!1,[]);return m.useEffect(()=>()=>document.removeEventListener("pointerup",h),[h]),e.jsx(Yd,{asChild:!0,...o,children:e.jsx($t.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...n,ref:l,onPointerMove:Mt(t.onPointerMove,f=>{f.pointerType!=="touch"&&!u.current&&!i.isPointerInTransitRef.current&&(a.onTriggerEnter(),u.current=!0)}),onPointerLeave:Mt(t.onPointerLeave,()=>{a.onTriggerLeave(),u.current=!1}),onPointerDown:Mt(t.onPointerDown,()=>{a.open&&a.onClose(),d.current=!0,document.addEventListener("pointerup",h,{once:!0})}),onFocus:Mt(t.onFocus,()=>{d.current||a.onOpen()}),onBlur:Mt(t.onBlur,a.onClose),onClick:Mt(t.onClick,a.onClose)})})});Fm.displayName=Sa;var Bm="TooltipPortal",[I0,Um]=An(Bm,{forceMount:void 0}),lr="TooltipContent",Dl=m.forwardRef((t,s)=>{const r=Um(lr,t.__scopeTooltip),{forceMount:n=r.forceMount,side:a="top",...i}=t,o=_n(lr,t.__scopeTooltip);return e.jsx(Ba,{present:n||o.open,children:o.disableHoverableContent?e.jsx($l,{side:a,...i,ref:s}):e.jsx(zm,{side:a,...i,ref:s})})}),zm=m.forwardRef((t,s)=>{const r=_n(lr,t.__scopeTooltip),n=Ol(lr,t.__scopeTooltip),a=m.useRef(null),i=En(s,a),[o,c]=m.useState(null),{trigger:l,onClose:d}=r,u=a.current,{onPointerInTransitChange:h}=n,f=m.useCallback(()=>{c(null),h(!1)},[h]),x=m.useCallback((g,y)=>{const b=g.currentTarget,p={x:g.clientX,y:g.clientY},j=Gm(p,b.getBoundingClientRect()),v=Km(p,j),w=Qm(y.getBoundingClientRect()),N=Jm([...v,...w]);c(N),h(!0)},[h]);return m.useEffect(()=>()=>f(),[f]),m.useEffect(()=>{if(l&&u){const g=b=>x(b,u),y=b=>x(b,l);return l.addEventListener("pointerleave",g),u.addEventListener("pointerleave",y),()=>{l.removeEventListener("pointerleave",g),u.removeEventListener("pointerleave",y)}}},[l,u,x,f]),m.useEffect(()=>{if(o){const g=y=>{const b=y.target,p={x:y.clientX,y:y.clientY},j=(l==null?void 0:l.contains(b))||(u==null?void 0:u.contains(b)),v=!Ym(p,o);j?f():v&&(f(),d())};return document.addEventListener("pointermove",g),()=>document.removeEventListener("pointermove",g)}},[l,u,o,d,f]),e.jsx($l,{...t,ref:i})}),[Hm,qm]=An(Ml,{isInside:!1}),Wm=Bd("TooltipContent"),$l=m.forwardRef((t,s)=>{const{__scopeTooltip:r,children:n,"aria-label":a,onEscapeKeyDown:i,onPointerDownOutside:o,...c}=t,l=_n(lr,r),d=Ga(r),{onClose:u}=l;return m.useEffect(()=>(document.addEventListener(Fi,u),()=>document.removeEventListener(Fi,u)),[u]),m.useEffect(()=>{if(l.trigger){const h=f=>{const x=f.target;x!=null&&x.contains(l.trigger)&&u()};return window.addEventListener("scroll",h,{capture:!0}),()=>window.removeEventListener("scroll",h,{capture:!0})}},[l.trigger,u]),e.jsx(Gd,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:h=>h.preventDefault(),onDismiss:u,children:e.jsxs(Kd,{"data-state":l.stateAttribute,...d,...c,ref:s,style:{...c.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[e.jsx(Wm,{children:n}),e.jsx(Hm,{scope:r,isInside:!0,children:e.jsx(Qd,{id:l.contentId,role:"tooltip",children:a||n})})]})})});Dl.displayName=lr;var Fl="TooltipArrow",Vm=m.forwardRef((t,s)=>{const{__scopeTooltip:r,...n}=t,a=Ga(r);return qm(Fl,r).isInside?null:e.jsx(Jd,{...a,...n,ref:s})});Vm.displayName=Fl;function Gm(t,s){const r=Math.abs(s.top-t.y),n=Math.abs(s.bottom-t.y),a=Math.abs(s.right-t.x),i=Math.abs(s.left-t.x);switch(Math.min(r,n,a,i)){case i:return"left";case a:return"right";case r:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function Km(t,s,r=5){const n=[];switch(s){case"top":n.push({x:t.x-r,y:t.y+r},{x:t.x+r,y:t.y+r});break;case"bottom":n.push({x:t.x-r,y:t.y-r},{x:t.x+r,y:t.y-r});break;case"left":n.push({x:t.x+r,y:t.y-r},{x:t.x+r,y:t.y+r});break;case"right":n.push({x:t.x-r,y:t.y-r},{x:t.x-r,y:t.y+r});break}return n}function Qm(t){const{top:s,right:r,bottom:n,left:a}=t;return[{x:a,y:s},{x:r,y:s},{x:r,y:n},{x:a,y:n}]}function Ym(t,s){const{x:r,y:n}=t;let a=!1;for(let i=0,o=s.length-1;i<s.length;o=i++){const c=s[i],l=s[o],d=c.x,u=c.y,h=l.x,f=l.y;u>n!=f>n&&r<(h-d)*(n-u)/(f-u)+d&&(a=!a)}return a}function Jm(t){const s=t.slice();return s.sort((r,n)=>r.x<n.x?-1:r.x>n.x?1:r.y<n.y?-1:r.y>n.y?1:0),Xm(s)}function Xm(t){if(t.length<=1)return t.slice();const s=[];for(let n=0;n<t.length;n++){const a=t[n];for(;s.length>=2;){const i=s[s.length-1],o=s[s.length-2];if((i.x-o.x)*(a.y-o.y)>=(i.y-o.y)*(a.x-o.x))s.pop();else break}s.push(a)}s.pop();const r=[];for(let n=t.length-1;n>=0;n--){const a=t[n];for(;r.length>=2;){const i=r[r.length-1],o=r[r.length-2];if((i.x-o.x)*(a.y-o.y)>=(i.y-o.y)*(a.x-o.x))r.pop();else break}r.push(a)}return r.pop(),s.length===1&&r.length===1&&s[0].x===r[0].x&&s[0].y===r[0].y?s:s.concat(r)}var Zm=Ll,Bl=Dl;const eh=Zm,th=m.forwardRef(({className:t,sideOffset:s=4,...r},n)=>e.jsx(Bl,{ref:n,sideOffset:s,className:W("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...r}));th.displayName=Bl.displayName;var In=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Rn=typeof window>"u"||"Deno"in globalThis;function Rt(){}function sh(t,s){return typeof t=="function"?t(s):t}function rh(t){return typeof t=="number"&&t>=0&&t!==1/0}function nh(t,s){return Math.max(t+(s||0)-Date.now(),0)}function Ca(t,s){return typeof t=="function"?t(s):t}function ah(t,s){return typeof t=="function"?t(s):t}function Bi(t,s){const{type:r="all",exact:n,fetchStatus:a,predicate:i,queryKey:o,stale:c}=t;if(o){if(n){if(s.queryHash!==Ka(o,s.options))return!1}else if(!Dr(s.queryKey,o))return!1}if(r!=="all"){const l=s.isActive();if(r==="active"&&!l||r==="inactive"&&l)return!1}return!(typeof c=="boolean"&&s.isStale()!==c||a&&a!==s.state.fetchStatus||i&&!i(s))}function Ui(t,s){const{exact:r,status:n,predicate:a,mutationKey:i}=t;if(i){if(!s.options.mutationKey)return!1;if(r){if(Mr(s.options.mutationKey)!==Mr(i))return!1}else if(!Dr(s.options.mutationKey,i))return!1}return!(n&&s.state.status!==n||a&&!a(s))}function Ka(t,s){return((s==null?void 0:s.queryKeyHashFn)||Mr)(t)}function Mr(t){return JSON.stringify(t,(s,r)=>Ea(r)?Object.keys(r).sort().reduce((n,a)=>(n[a]=r[a],n),{}):r)}function Dr(t,s){return t===s?!0:typeof t!=typeof s?!1:t&&s&&typeof t=="object"&&typeof s=="object"?Object.keys(s).every(r=>Dr(t[r],s[r])):!1}function Ul(t,s){if(t===s)return t;const r=zi(t)&&zi(s);if(r||Ea(t)&&Ea(s)){const n=r?t:Object.keys(t),a=n.length,i=r?s:Object.keys(s),o=i.length,c=r?[]:{},l=new Set(n);let d=0;for(let u=0;u<o;u++){const h=r?u:i[u];(!r&&l.has(h)||r)&&t[h]===void 0&&s[h]===void 0?(c[h]=void 0,d++):(c[h]=Ul(t[h],s[h]),c[h]===t[h]&&t[h]!==void 0&&d++)}return a===o&&d===a?t:c}return s}function zi(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function Ea(t){if(!Hi(t))return!1;const s=t.constructor;if(s===void 0)return!0;const r=s.prototype;return!(!Hi(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function Hi(t){return Object.prototype.toString.call(t)==="[object Object]"}function ih(t){return new Promise(s=>{setTimeout(s,t)})}function oh(t,s,r){return typeof r.structuralSharing=="function"?r.structuralSharing(t,s):r.structuralSharing!==!1?Ul(t,s):s}function lh(t,s,r=0){const n=[...t,s];return r&&n.length>r?n.slice(1):n}function ch(t,s,r=0){const n=[s,...t];return r&&n.length>r?n.slice(0,-1):n}var Qa=Symbol();function zl(t,s){return!t.queryFn&&(s!=null&&s.initialPromise)?()=>s.initialPromise:!t.queryFn||t.queryFn===Qa?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}var Ss,ds,Js,_o,dh=(_o=class extends In{constructor(){super();je(this,Ss);je(this,ds);je(this,Js);oe(this,Js,s=>{if(!Rn&&window.addEventListener){const r=()=>s();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){M(this,ds)||this.setEventListener(M(this,Js))}onUnsubscribe(){var s;this.hasListeners()||((s=M(this,ds))==null||s.call(this),oe(this,ds,void 0))}setEventListener(s){var r;oe(this,Js,s),(r=M(this,ds))==null||r.call(this),oe(this,ds,s(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(s){M(this,Ss)!==s&&(oe(this,Ss,s),this.onFocus())}onFocus(){const s=this.isFocused();this.listeners.forEach(r=>{r(s)})}isFocused(){var s;return typeof M(this,Ss)=="boolean"?M(this,Ss):((s=globalThis.document)==null?void 0:s.visibilityState)!=="hidden"}},Ss=new WeakMap,ds=new WeakMap,Js=new WeakMap,_o),Hl=new dh,Xs,us,Zs,Io,uh=(Io=class extends In{constructor(){super();je(this,Xs,!0);je(this,us);je(this,Zs);oe(this,Zs,s=>{if(!Rn&&window.addEventListener){const r=()=>s(!0),n=()=>s(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){M(this,us)||this.setEventListener(M(this,Zs))}onUnsubscribe(){var s;this.hasListeners()||((s=M(this,us))==null||s.call(this),oe(this,us,void 0))}setEventListener(s){var r;oe(this,Zs,s),(r=M(this,us))==null||r.call(this),oe(this,us,s(this.setOnline.bind(this)))}setOnline(s){M(this,Xs)!==s&&(oe(this,Xs,s),this.listeners.forEach(n=>{n(s)}))}isOnline(){return M(this,Xs)}},Xs=new WeakMap,us=new WeakMap,Zs=new WeakMap,Io),yn=new uh;function mh(){let t,s;const r=new Promise((a,i)=>{t=a,s=i});r.status="pending",r.catch(()=>{});function n(a){Object.assign(r,a),delete r.resolve,delete r.reject}return r.resolve=a=>{n({status:"fulfilled",value:a}),t(a)},r.reject=a=>{n({status:"rejected",reason:a}),s(a)},r}function hh(t){return Math.min(1e3*2**t,3e4)}function ql(t){return(t??"online")==="online"?yn.isOnline():!0}var Wl=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function la(t){return t instanceof Wl}function Vl(t){let s=!1,r=0,n=!1,a;const i=mh(),o=y=>{var b;n||(f(new Wl(y)),(b=t.abort)==null||b.call(t))},c=()=>{s=!0},l=()=>{s=!1},d=()=>Hl.isFocused()&&(t.networkMode==="always"||yn.isOnline())&&t.canRun(),u=()=>ql(t.networkMode)&&t.canRun(),h=y=>{var b;n||(n=!0,(b=t.onSuccess)==null||b.call(t,y),a==null||a(),i.resolve(y))},f=y=>{var b;n||(n=!0,(b=t.onError)==null||b.call(t,y),a==null||a(),i.reject(y))},x=()=>new Promise(y=>{var b;a=p=>{(n||d())&&y(p)},(b=t.onPause)==null||b.call(t)}).then(()=>{var y;a=void 0,n||(y=t.onContinue)==null||y.call(t)}),g=()=>{if(n)return;let y;const b=r===0?t.initialPromise:void 0;try{y=b??t.fn()}catch(p){y=Promise.reject(p)}Promise.resolve(y).then(h).catch(p=>{var k;if(n)return;const j=t.retry??(Rn?0:3),v=t.retryDelay??hh,w=typeof v=="function"?v(r,p):v,N=j===!0||typeof j=="number"&&r<j||typeof j=="function"&&j(r,p);if(s||!N){f(p);return}r++,(k=t.onFail)==null||k.call(t,r,p),ih(w).then(()=>d()?void 0:x()).then(()=>{s?f(p):g()})})};return{promise:i,cancel:o,continue:()=>(a==null||a(),i),cancelRetry:c,continueRetry:l,canStart:u,start:()=>(u()?g():x().then(g),i)}}var fh=t=>setTimeout(t,0);function ph(){let t=[],s=0,r=c=>{c()},n=c=>{c()},a=fh;const i=c=>{s?t.push(c):a(()=>{r(c)})},o=()=>{const c=t;t=[],c.length&&a(()=>{n(()=>{c.forEach(l=>{r(l)})})})};return{batch:c=>{let l;s++;try{l=c()}finally{s--,s||o()}return l},batchCalls:c=>(...l)=>{i(()=>{c(...l)})},schedule:i,setNotifyFunction:c=>{r=c},setBatchNotifyFunction:c=>{n=c},setScheduler:c=>{a=c}}}var ut=ph(),Cs,Ro,Gl=(Ro=class{constructor(){je(this,Cs)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),rh(this.gcTime)&&oe(this,Cs,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(Rn?1/0:5*60*1e3))}clearGcTimeout(){M(this,Cs)&&(clearTimeout(M(this,Cs)),oe(this,Cs,void 0))}},Cs=new WeakMap,Ro),er,tr,kt,Es,at,Hr,ks,Ot,ts,Oo,xh=(Oo=class extends Gl{constructor(s){super();je(this,Ot);je(this,er);je(this,tr);je(this,kt);je(this,Es);je(this,at);je(this,Hr);je(this,ks);oe(this,ks,!1),oe(this,Hr,s.defaultOptions),this.setOptions(s.options),this.observers=[],oe(this,Es,s.client),oe(this,kt,M(this,Es).getQueryCache()),this.queryKey=s.queryKey,this.queryHash=s.queryHash,oe(this,er,bh(this.options)),this.state=s.state??M(this,er),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var s;return(s=M(this,at))==null?void 0:s.promise}setOptions(s){this.options={...M(this,Hr),...s},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&M(this,kt).remove(this)}setData(s,r){const n=oh(this.state.data,s,this.options);return nt(this,Ot,ts).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(s,r){nt(this,Ot,ts).call(this,{type:"setState",state:s,setStateOptions:r})}cancel(s){var n,a;const r=(n=M(this,at))==null?void 0:n.promise;return(a=M(this,at))==null||a.cancel(s),r?r.then(Rt).catch(Rt):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(M(this,er))}isActive(){return this.observers.some(s=>ah(s.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Qa||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(s=>Ca(s.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(s=>s.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(s=0){return this.state.data===void 0?!0:s==="static"?!1:this.state.isInvalidated?!0:!nh(this.state.dataUpdatedAt,s)}onFocus(){var r;const s=this.observers.find(n=>n.shouldFetchOnWindowFocus());s==null||s.refetch({cancelRefetch:!1}),(r=M(this,at))==null||r.continue()}onOnline(){var r;const s=this.observers.find(n=>n.shouldFetchOnReconnect());s==null||s.refetch({cancelRefetch:!1}),(r=M(this,at))==null||r.continue()}addObserver(s){this.observers.includes(s)||(this.observers.push(s),this.clearGcTimeout(),M(this,kt).notify({type:"observerAdded",query:this,observer:s}))}removeObserver(s){this.observers.includes(s)&&(this.observers=this.observers.filter(r=>r!==s),this.observers.length||(M(this,at)&&(M(this,ks)?M(this,at).cancel({revert:!0}):M(this,at).cancelRetry()),this.scheduleGc()),M(this,kt).notify({type:"observerRemoved",query:this,observer:s}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||nt(this,Ot,ts).call(this,{type:"invalidate"})}fetch(s,r){var d,u,h;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(M(this,at))return M(this,at).continueRetry(),M(this,at).promise}if(s&&this.setOptions(s),!this.options.queryFn){const f=this.observers.find(x=>x.options.queryFn);f&&this.setOptions(f.options)}const n=new AbortController,a=f=>{Object.defineProperty(f,"signal",{enumerable:!0,get:()=>(oe(this,ks,!0),n.signal)})},i=()=>{const f=zl(this.options,r),g=(()=>{const y={client:M(this,Es),queryKey:this.queryKey,meta:this.meta};return a(y),y})();return oe(this,ks,!1),this.options.persister?this.options.persister(f,g,this):f(g)},c=(()=>{const f={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:M(this,Es),state:this.state,fetchFn:i};return a(f),f})();(d=this.options.behavior)==null||d.onFetch(c,this),oe(this,tr,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((u=c.fetchOptions)==null?void 0:u.meta))&&nt(this,Ot,ts).call(this,{type:"fetch",meta:(h=c.fetchOptions)==null?void 0:h.meta});const l=f=>{var x,g,y,b;la(f)&&f.silent||nt(this,Ot,ts).call(this,{type:"error",error:f}),la(f)||((g=(x=M(this,kt).config).onError)==null||g.call(x,f,this),(b=(y=M(this,kt).config).onSettled)==null||b.call(y,this.state.data,f,this)),this.scheduleGc()};return oe(this,at,Vl({initialPromise:r==null?void 0:r.initialPromise,fn:c.fetchFn,abort:n.abort.bind(n),onSuccess:f=>{var x,g,y,b;if(f===void 0){l(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(f)}catch(p){l(p);return}(g=(x=M(this,kt).config).onSuccess)==null||g.call(x,f,this),(b=(y=M(this,kt).config).onSettled)==null||b.call(y,f,this.state.error,this),this.scheduleGc()},onError:l,onFail:(f,x)=>{nt(this,Ot,ts).call(this,{type:"failed",failureCount:f,error:x})},onPause:()=>{nt(this,Ot,ts).call(this,{type:"pause"})},onContinue:()=>{nt(this,Ot,ts).call(this,{type:"continue"})},retry:c.options.retry,retryDelay:c.options.retryDelay,networkMode:c.options.networkMode,canRun:()=>!0})),M(this,at).start()}},er=new WeakMap,tr=new WeakMap,kt=new WeakMap,Es=new WeakMap,at=new WeakMap,Hr=new WeakMap,ks=new WeakMap,Ot=new WeakSet,ts=function(s){const r=n=>{switch(s.type){case"failed":return{...n,fetchFailureCount:s.failureCount,fetchFailureReason:s.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...gh(n.data,this.options),fetchMeta:s.meta??null};case"success":return{...n,data:s.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:s.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!s.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const a=s.error;return la(a)&&a.revert&&M(this,tr)?{...M(this,tr),fetchStatus:"idle"}:{...n,error:a,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...s.state}}};this.state=r(this.state),ut.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),M(this,kt).notify({query:this,type:"updated",action:s})})},Oo);function gh(t,s){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:ql(s.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function bh(t){const s=typeof t.initialData=="function"?t.initialData():t.initialData,r=s!==void 0,n=r?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:s,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var qt,Lo,yh=(Lo=class extends In{constructor(s={}){super();je(this,qt);this.config=s,oe(this,qt,new Map)}build(s,r,n){const a=r.queryKey,i=r.queryHash??Ka(a,r);let o=this.get(i);return o||(o=new xh({client:s,queryKey:a,queryHash:i,options:s.defaultQueryOptions(r),state:n,defaultOptions:s.getQueryDefaults(a)}),this.add(o)),o}add(s){M(this,qt).has(s.queryHash)||(M(this,qt).set(s.queryHash,s),this.notify({type:"added",query:s}))}remove(s){const r=M(this,qt).get(s.queryHash);r&&(s.destroy(),r===s&&M(this,qt).delete(s.queryHash),this.notify({type:"removed",query:s}))}clear(){ut.batch(()=>{this.getAll().forEach(s=>{this.remove(s)})})}get(s){return M(this,qt).get(s)}getAll(){return[...M(this,qt).values()]}find(s){const r={exact:!0,...s};return this.getAll().find(n=>Bi(r,n))}findAll(s={}){const r=this.getAll();return Object.keys(s).length>0?r.filter(n=>Bi(s,n)):r}notify(s){ut.batch(()=>{this.listeners.forEach(r=>{r(s)})})}onFocus(){ut.batch(()=>{this.getAll().forEach(s=>{s.onFocus()})})}onOnline(){ut.batch(()=>{this.getAll().forEach(s=>{s.onOnline()})})}},qt=new WeakMap,Lo),Wt,dt,Ts,Vt,ls,Mo,vh=(Mo=class extends Gl{constructor(s){super();je(this,Vt);je(this,Wt);je(this,dt);je(this,Ts);this.mutationId=s.mutationId,oe(this,dt,s.mutationCache),oe(this,Wt,[]),this.state=s.state||jh(),this.setOptions(s.options),this.scheduleGc()}setOptions(s){this.options=s,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(s){M(this,Wt).includes(s)||(M(this,Wt).push(s),this.clearGcTimeout(),M(this,dt).notify({type:"observerAdded",mutation:this,observer:s}))}removeObserver(s){oe(this,Wt,M(this,Wt).filter(r=>r!==s)),this.scheduleGc(),M(this,dt).notify({type:"observerRemoved",mutation:this,observer:s})}optionalRemove(){M(this,Wt).length||(this.state.status==="pending"?this.scheduleGc():M(this,dt).remove(this))}continue(){var s;return((s=M(this,Ts))==null?void 0:s.continue())??this.execute(this.state.variables)}async execute(s){var i,o,c,l,d,u,h,f,x,g,y,b,p,j,v,w,N,k,S,E;const r=()=>{nt(this,Vt,ls).call(this,{type:"continue"})};oe(this,Ts,Vl({fn:()=>this.options.mutationFn?this.options.mutationFn(s):Promise.reject(new Error("No mutationFn found")),onFail:(A,z)=>{nt(this,Vt,ls).call(this,{type:"failed",failureCount:A,error:z})},onPause:()=>{nt(this,Vt,ls).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>M(this,dt).canRun(this)}));const n=this.state.status==="pending",a=!M(this,Ts).canStart();try{if(n)r();else{nt(this,Vt,ls).call(this,{type:"pending",variables:s,isPaused:a}),await((o=(i=M(this,dt).config).onMutate)==null?void 0:o.call(i,s,this));const z=await((l=(c=this.options).onMutate)==null?void 0:l.call(c,s));z!==this.state.context&&nt(this,Vt,ls).call(this,{type:"pending",context:z,variables:s,isPaused:a})}const A=await M(this,Ts).start();return await((u=(d=M(this,dt).config).onSuccess)==null?void 0:u.call(d,A,s,this.state.context,this)),await((f=(h=this.options).onSuccess)==null?void 0:f.call(h,A,s,this.state.context)),await((g=(x=M(this,dt).config).onSettled)==null?void 0:g.call(x,A,null,this.state.variables,this.state.context,this)),await((b=(y=this.options).onSettled)==null?void 0:b.call(y,A,null,s,this.state.context)),nt(this,Vt,ls).call(this,{type:"success",data:A}),A}catch(A){try{throw await((j=(p=M(this,dt).config).onError)==null?void 0:j.call(p,A,s,this.state.context,this)),await((w=(v=this.options).onError)==null?void 0:w.call(v,A,s,this.state.context)),await((k=(N=M(this,dt).config).onSettled)==null?void 0:k.call(N,void 0,A,this.state.variables,this.state.context,this)),await((E=(S=this.options).onSettled)==null?void 0:E.call(S,void 0,A,s,this.state.context)),A}finally{nt(this,Vt,ls).call(this,{type:"error",error:A})}}finally{M(this,dt).runNext(this)}}},Wt=new WeakMap,dt=new WeakMap,Ts=new WeakMap,Vt=new WeakSet,ls=function(s){const r=n=>{switch(s.type){case"failed":return{...n,failureCount:s.failureCount,failureReason:s.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:s.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:s.isPaused,status:"pending",variables:s.variables,submittedAt:Date.now()};case"success":return{...n,data:s.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:s.error,failureCount:n.failureCount+1,failureReason:s.error,isPaused:!1,status:"error"}}};this.state=r(this.state),ut.batch(()=>{M(this,Wt).forEach(n=>{n.onMutationUpdate(s)}),M(this,dt).notify({mutation:this,type:"updated",action:s})})},Mo);function jh(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var rs,Lt,qr,Do,Nh=(Do=class extends In{constructor(s={}){super();je(this,rs);je(this,Lt);je(this,qr);this.config=s,oe(this,rs,new Set),oe(this,Lt,new Map),oe(this,qr,0)}build(s,r,n){const a=new vh({mutationCache:this,mutationId:++Zr(this,qr)._,options:s.defaultMutationOptions(r),state:n});return this.add(a),a}add(s){M(this,rs).add(s);const r=tn(s);if(typeof r=="string"){const n=M(this,Lt).get(r);n?n.push(s):M(this,Lt).set(r,[s])}this.notify({type:"added",mutation:s})}remove(s){if(M(this,rs).delete(s)){const r=tn(s);if(typeof r=="string"){const n=M(this,Lt).get(r);if(n)if(n.length>1){const a=n.indexOf(s);a!==-1&&n.splice(a,1)}else n[0]===s&&M(this,Lt).delete(r)}}this.notify({type:"removed",mutation:s})}canRun(s){const r=tn(s);if(typeof r=="string"){const n=M(this,Lt).get(r),a=n==null?void 0:n.find(i=>i.state.status==="pending");return!a||a===s}else return!0}runNext(s){var n;const r=tn(s);if(typeof r=="string"){const a=(n=M(this,Lt).get(r))==null?void 0:n.find(i=>i!==s&&i.state.isPaused);return(a==null?void 0:a.continue())??Promise.resolve()}else return Promise.resolve()}clear(){ut.batch(()=>{M(this,rs).forEach(s=>{this.notify({type:"removed",mutation:s})}),M(this,rs).clear(),M(this,Lt).clear()})}getAll(){return Array.from(M(this,rs))}find(s){const r={exact:!0,...s};return this.getAll().find(n=>Ui(r,n))}findAll(s={}){return this.getAll().filter(r=>Ui(s,r))}notify(s){ut.batch(()=>{this.listeners.forEach(r=>{r(s)})})}resumePausedMutations(){const s=this.getAll().filter(r=>r.state.isPaused);return ut.batch(()=>Promise.all(s.map(r=>r.continue().catch(Rt))))}},rs=new WeakMap,Lt=new WeakMap,qr=new WeakMap,Do);function tn(t){var s;return(s=t.options.scope)==null?void 0:s.id}function qi(t){return{onFetch:(s,r)=>{var u,h,f,x,g;const n=s.options,a=(f=(h=(u=s.fetchOptions)==null?void 0:u.meta)==null?void 0:h.fetchMore)==null?void 0:f.direction,i=((x=s.state.data)==null?void 0:x.pages)||[],o=((g=s.state.data)==null?void 0:g.pageParams)||[];let c={pages:[],pageParams:[]},l=0;const d=async()=>{let y=!1;const b=v=>{Object.defineProperty(v,"signal",{enumerable:!0,get:()=>(s.signal.aborted?y=!0:s.signal.addEventListener("abort",()=>{y=!0}),s.signal)})},p=zl(s.options,s.fetchOptions),j=async(v,w,N)=>{if(y)return Promise.reject();if(w==null&&v.pages.length)return Promise.resolve(v);const S=(()=>{const D={client:s.client,queryKey:s.queryKey,pageParam:w,direction:N?"backward":"forward",meta:s.options.meta};return b(D),D})(),E=await p(S),{maxPages:A}=s.options,z=N?ch:lh;return{pages:z(v.pages,E,A),pageParams:z(v.pageParams,w,A)}};if(a&&i.length){const v=a==="backward",w=v?wh:Wi,N={pages:i,pageParams:o},k=w(n,N);c=await j(N,k,v)}else{const v=t??i.length;do{const w=l===0?o[0]??n.initialPageParam:Wi(n,c);if(l>0&&w==null)break;c=await j(c,w),l++}while(l<v)}return c};s.options.persister?s.fetchFn=()=>{var y,b;return(b=(y=s.options).persister)==null?void 0:b.call(y,d,{client:s.client,queryKey:s.queryKey,meta:s.options.meta,signal:s.signal},r)}:s.fetchFn=d}}}function Wi(t,{pages:s,pageParams:r}){const n=s.length-1;return s.length>0?t.getNextPageParam(s[n],s,r[n],r):void 0}function wh(t,{pages:s,pageParams:r}){var n;return s.length>0?(n=t.getPreviousPageParam)==null?void 0:n.call(t,s[0],s,r[0],r):void 0}var Fe,ms,hs,sr,rr,fs,nr,ar,$o,Sh=($o=class{constructor(t={}){je(this,Fe);je(this,ms);je(this,hs);je(this,sr);je(this,rr);je(this,fs);je(this,nr);je(this,ar);oe(this,Fe,t.queryCache||new yh),oe(this,ms,t.mutationCache||new Nh),oe(this,hs,t.defaultOptions||{}),oe(this,sr,new Map),oe(this,rr,new Map),oe(this,fs,0)}mount(){Zr(this,fs)._++,M(this,fs)===1&&(oe(this,nr,Hl.subscribe(async t=>{t&&(await this.resumePausedMutations(),M(this,Fe).onFocus())})),oe(this,ar,yn.subscribe(async t=>{t&&(await this.resumePausedMutations(),M(this,Fe).onOnline())})))}unmount(){var t,s;Zr(this,fs)._--,M(this,fs)===0&&((t=M(this,nr))==null||t.call(this),oe(this,nr,void 0),(s=M(this,ar))==null||s.call(this),oe(this,ar,void 0))}isFetching(t){return M(this,Fe).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return M(this,ms).findAll({...t,status:"pending"}).length}getQueryData(t){var r;const s=this.defaultQueryOptions({queryKey:t});return(r=M(this,Fe).get(s.queryHash))==null?void 0:r.state.data}ensureQueryData(t){const s=this.defaultQueryOptions(t),r=M(this,Fe).build(this,s),n=r.state.data;return n===void 0?this.fetchQuery(t):(t.revalidateIfStale&&r.isStaleByTime(Ca(s.staleTime,r))&&this.prefetchQuery(s),Promise.resolve(n))}getQueriesData(t){return M(this,Fe).findAll(t).map(({queryKey:s,state:r})=>{const n=r.data;return[s,n]})}setQueryData(t,s,r){const n=this.defaultQueryOptions({queryKey:t}),a=M(this,Fe).get(n.queryHash),i=a==null?void 0:a.state.data,o=sh(s,i);if(o!==void 0)return M(this,Fe).build(this,n).setData(o,{...r,manual:!0})}setQueriesData(t,s,r){return ut.batch(()=>M(this,Fe).findAll(t).map(({queryKey:n})=>[n,this.setQueryData(n,s,r)]))}getQueryState(t){var r;const s=this.defaultQueryOptions({queryKey:t});return(r=M(this,Fe).get(s.queryHash))==null?void 0:r.state}removeQueries(t){const s=M(this,Fe);ut.batch(()=>{s.findAll(t).forEach(r=>{s.remove(r)})})}resetQueries(t,s){const r=M(this,Fe);return ut.batch(()=>(r.findAll(t).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...t},s)))}cancelQueries(t,s={}){const r={revert:!0,...s},n=ut.batch(()=>M(this,Fe).findAll(t).map(a=>a.cancel(r)));return Promise.all(n).then(Rt).catch(Rt)}invalidateQueries(t,s={}){return ut.batch(()=>(M(this,Fe).findAll(t).forEach(r=>{r.invalidate()}),(t==null?void 0:t.refetchType)==="none"?Promise.resolve():this.refetchQueries({...t,type:(t==null?void 0:t.refetchType)??(t==null?void 0:t.type)??"active"},s)))}refetchQueries(t,s={}){const r={...s,cancelRefetch:s.cancelRefetch??!0},n=ut.batch(()=>M(this,Fe).findAll(t).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let i=a.fetch(void 0,r);return r.throwOnError||(i=i.catch(Rt)),a.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(n).then(Rt)}fetchQuery(t){const s=this.defaultQueryOptions(t);s.retry===void 0&&(s.retry=!1);const r=M(this,Fe).build(this,s);return r.isStaleByTime(Ca(s.staleTime,r))?r.fetch(s):Promise.resolve(r.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(Rt).catch(Rt)}fetchInfiniteQuery(t){return t.behavior=qi(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(Rt).catch(Rt)}ensureInfiniteQueryData(t){return t.behavior=qi(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return yn.isOnline()?M(this,ms).resumePausedMutations():Promise.resolve()}getQueryCache(){return M(this,Fe)}getMutationCache(){return M(this,ms)}getDefaultOptions(){return M(this,hs)}setDefaultOptions(t){oe(this,hs,t)}setQueryDefaults(t,s){M(this,sr).set(Mr(t),{queryKey:t,defaultOptions:s})}getQueryDefaults(t){const s=[...M(this,sr).values()],r={};return s.forEach(n=>{Dr(t,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(t,s){M(this,rr).set(Mr(t),{mutationKey:t,defaultOptions:s})}getMutationDefaults(t){const s=[...M(this,rr).values()],r={};return s.forEach(n=>{Dr(t,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(t){if(t._defaulted)return t;const s={...M(this,hs).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return s.queryHash||(s.queryHash=Ka(s.queryKey,s)),s.refetchOnReconnect===void 0&&(s.refetchOnReconnect=s.networkMode!=="always"),s.throwOnError===void 0&&(s.throwOnError=!!s.suspense),!s.networkMode&&s.persister&&(s.networkMode="offlineFirst"),s.queryFn===Qa&&(s.enabled=!1),s}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...M(this,hs).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){M(this,Fe).clear(),M(this,ms).clear()}},Fe=new WeakMap,ms=new WeakMap,hs=new WeakMap,sr=new WeakMap,rr=new WeakMap,fs=new WeakMap,nr=new WeakMap,ar=new WeakMap,$o),Kl=m.createContext(void 0),Ch=t=>{const s=m.useContext(Kl);if(!s)throw new Error("No QueryClient set, use QueryClientProvider to set one");return s},Eh=({client:t,children:s})=>(m.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),e.jsx(Kl.Provider,{value:t,children:s}));window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"||window.location.hostname.includes("91.99.49.130");const le="https://api.mrtrader.net",pe={REQUEST_OTP:"/user/auth/request-otp/",VERIFY_OTP:"/user/auth/verify-otp/",PROFILE:"/user/profile/",AVATAR:"/user/profile/avatar/",ARTICLES:"/content/articles/",ARTICLE_DETAIL:t=>`/content/articles/${t}/`,VIDEOS:"/content/videos/",VIDEO_DETAIL:t=>`/content/videos/${t}/`,PODCASTS:"/content/podcasts/",PODCAST_DETAIL:t=>`/content/podcasts/${t}/`,LIVESTREAMS:"/content/livestreams/",LIVESTREAM_DETAIL:t=>`/content/livestreams/${t}/`,BOOKMARKS:"/content/bookmarks/",BOOKMARK_DETAIL:t=>`/content/bookmarks/${t}/`,LIKES:"/content/likes/",LIKE_DETAIL:t=>`/content/likes/${t}/`,COMMENTS:"/content/comments/",COMMENT_DETAIL:t=>`/content/comments/${t}/`,ARTICLE_COMMENTS:t=>`/content/articles/${t}/comments/`,VIDEO_COMMENTS:t=>`/content/videos/${t}/comments/`,PODCAST_COMMENTS:t=>`/content/podcasts/${t}/comments/`,MEDIA_COMMENTS:"/content/media-comments/",MEDIA_COMMENTS_LIST:"/content/media-comments/list/",MEDIA_COMMENT_DETAIL:t=>`/content/media-comments/${t}/`,COURSES:"/crs/courses/",COURSE_DETAIL:t=>`/crs/courses/${t}/`,COURSE_LEARN:t=>`/crs/courses/${t}/learn/`,LESSON_PROGRESS:(t,s)=>`/crs/courses/${t}/lessons/${s}/progress/`,LESSON_COMPLETE:(t,s)=>`/crs/courses/${t}/lessons/${s}/complete/`,MY_COURSES:"/crs/my-courses/"},ka={PLACEHOLDER_CONTENT:"https://placehold.co/600x400/e2e8f0/64748b?text=No+Image"},ns="auth_tokens";function Ql(t,s){return function(){return t.apply(s,arguments)}}const{toString:kh}=Object.prototype,{getPrototypeOf:Ya}=Object,{iterator:On,toStringTag:Yl}=Symbol,Ln=(t=>s=>{const r=kh.call(s);return t[r]||(t[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Ft=t=>(t=t.toLowerCase(),s=>Ln(s)===t),Mn=t=>s=>typeof s===t,{isArray:mr}=Array,$r=Mn("undefined");function Th(t){return t!==null&&!$r(t)&&t.constructor!==null&&!$r(t.constructor)&&bt(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const Jl=Ft("ArrayBuffer");function Ph(t){let s;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?s=ArrayBuffer.isView(t):s=t&&t.buffer&&Jl(t.buffer),s}const Ah=Mn("string"),bt=Mn("function"),Xl=Mn("number"),Dn=t=>t!==null&&typeof t=="object",_h=t=>t===!0||t===!1,on=t=>{if(Ln(t)!=="object")return!1;const s=Ya(t);return(s===null||s===Object.prototype||Object.getPrototypeOf(s)===null)&&!(Yl in t)&&!(On in t)},Ih=Ft("Date"),Rh=Ft("File"),Oh=Ft("Blob"),Lh=Ft("FileList"),Mh=t=>Dn(t)&&bt(t.pipe),Dh=t=>{let s;return t&&(typeof FormData=="function"&&t instanceof FormData||bt(t.append)&&((s=Ln(t))==="formdata"||s==="object"&&bt(t.toString)&&t.toString()==="[object FormData]"))},$h=Ft("URLSearchParams"),[Fh,Bh,Uh,zh]=["ReadableStream","Request","Response","Headers"].map(Ft),Hh=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Vr(t,s,{allOwnKeys:r=!1}={}){if(t===null||typeof t>"u")return;let n,a;if(typeof t!="object"&&(t=[t]),mr(t))for(n=0,a=t.length;n<a;n++)s.call(null,t[n],n,t);else{const i=r?Object.getOwnPropertyNames(t):Object.keys(t),o=i.length;let c;for(n=0;n<o;n++)c=i[n],s.call(null,t[c],c,t)}}function Zl(t,s){s=s.toLowerCase();const r=Object.keys(t);let n=r.length,a;for(;n-- >0;)if(a=r[n],s===a.toLowerCase())return a;return null}const ws=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,ec=t=>!$r(t)&&t!==ws;function Ta(){const{caseless:t}=ec(this)&&this||{},s={},r=(n,a)=>{const i=t&&Zl(s,a)||a;on(s[i])&&on(n)?s[i]=Ta(s[i],n):on(n)?s[i]=Ta({},n):mr(n)?s[i]=n.slice():s[i]=n};for(let n=0,a=arguments.length;n<a;n++)arguments[n]&&Vr(arguments[n],r);return s}const qh=(t,s,r,{allOwnKeys:n}={})=>(Vr(s,(a,i)=>{r&&bt(a)?t[i]=Ql(a,r):t[i]=a},{allOwnKeys:n}),t),Wh=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),Vh=(t,s,r,n)=>{t.prototype=Object.create(s.prototype,n),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:s.prototype}),r&&Object.assign(t.prototype,r)},Gh=(t,s,r,n)=>{let a,i,o;const c={};if(s=s||{},t==null)return s;do{for(a=Object.getOwnPropertyNames(t),i=a.length;i-- >0;)o=a[i],(!n||n(o,t,s))&&!c[o]&&(s[o]=t[o],c[o]=!0);t=r!==!1&&Ya(t)}while(t&&(!r||r(t,s))&&t!==Object.prototype);return s},Kh=(t,s,r)=>{t=String(t),(r===void 0||r>t.length)&&(r=t.length),r-=s.length;const n=t.indexOf(s,r);return n!==-1&&n===r},Qh=t=>{if(!t)return null;if(mr(t))return t;let s=t.length;if(!Xl(s))return null;const r=new Array(s);for(;s-- >0;)r[s]=t[s];return r},Yh=(t=>s=>t&&s instanceof t)(typeof Uint8Array<"u"&&Ya(Uint8Array)),Jh=(t,s)=>{const n=(t&&t[On]).call(t);let a;for(;(a=n.next())&&!a.done;){const i=a.value;s.call(t,i[0],i[1])}},Xh=(t,s)=>{let r;const n=[];for(;(r=t.exec(s))!==null;)n.push(r);return n},Zh=Ft("HTMLFormElement"),ef=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,a){return n.toUpperCase()+a}),Vi=(({hasOwnProperty:t})=>(s,r)=>t.call(s,r))(Object.prototype),tf=Ft("RegExp"),tc=(t,s)=>{const r=Object.getOwnPropertyDescriptors(t),n={};Vr(r,(a,i)=>{let o;(o=s(a,i,t))!==!1&&(n[i]=o||a)}),Object.defineProperties(t,n)},sf=t=>{tc(t,(s,r)=>{if(bt(t)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=t[r];if(bt(n)){if(s.enumerable=!1,"writable"in s){s.writable=!1;return}s.set||(s.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},rf=(t,s)=>{const r={},n=a=>{a.forEach(i=>{r[i]=!0})};return mr(t)?n(t):n(String(t).split(s)),r},nf=()=>{},af=(t,s)=>t!=null&&Number.isFinite(t=+t)?t:s;function of(t){return!!(t&&bt(t.append)&&t[Yl]==="FormData"&&t[On])}const lf=t=>{const s=new Array(10),r=(n,a)=>{if(Dn(n)){if(s.indexOf(n)>=0)return;if(!("toJSON"in n)){s[a]=n;const i=mr(n)?[]:{};return Vr(n,(o,c)=>{const l=r(o,a+1);!$r(l)&&(i[c]=l)}),s[a]=void 0,i}}return n};return r(t,0)},cf=Ft("AsyncFunction"),df=t=>t&&(Dn(t)||bt(t))&&bt(t.then)&&bt(t.catch),sc=((t,s)=>t?setImmediate:s?((r,n)=>(ws.addEventListener("message",({source:a,data:i})=>{a===ws&&i===r&&n.length&&n.shift()()},!1),a=>{n.push(a),ws.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",bt(ws.postMessage)),uf=typeof queueMicrotask<"u"?queueMicrotask.bind(ws):typeof process<"u"&&process.nextTick||sc,mf=t=>t!=null&&bt(t[On]),O={isArray:mr,isArrayBuffer:Jl,isBuffer:Th,isFormData:Dh,isArrayBufferView:Ph,isString:Ah,isNumber:Xl,isBoolean:_h,isObject:Dn,isPlainObject:on,isReadableStream:Fh,isRequest:Bh,isResponse:Uh,isHeaders:zh,isUndefined:$r,isDate:Ih,isFile:Rh,isBlob:Oh,isRegExp:tf,isFunction:bt,isStream:Mh,isURLSearchParams:$h,isTypedArray:Yh,isFileList:Lh,forEach:Vr,merge:Ta,extend:qh,trim:Hh,stripBOM:Wh,inherits:Vh,toFlatObject:Gh,kindOf:Ln,kindOfTest:Ft,endsWith:Kh,toArray:Qh,forEachEntry:Jh,matchAll:Xh,isHTMLForm:Zh,hasOwnProperty:Vi,hasOwnProp:Vi,reduceDescriptors:tc,freezeMethods:sf,toObjectSet:rf,toCamelCase:ef,noop:nf,toFiniteNumber:af,findKey:Zl,global:ws,isContextDefined:ec,isSpecCompliantForm:of,toJSONObject:lf,isAsyncFn:cf,isThenable:df,setImmediate:sc,asap:uf,isIterable:mf};function ce(t,s,r,n,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",s&&(this.code=s),r&&(this.config=r),n&&(this.request=n),a&&(this.response=a,this.status=a.status?a.status:null)}O.inherits(ce,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:O.toJSONObject(this.config),code:this.code,status:this.status}}});const rc=ce.prototype,nc={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{nc[t]={value:t}});Object.defineProperties(ce,nc);Object.defineProperty(rc,"isAxiosError",{value:!0});ce.from=(t,s,r,n,a,i)=>{const o=Object.create(rc);return O.toFlatObject(t,o,function(l){return l!==Error.prototype},c=>c!=="isAxiosError"),ce.call(o,t.message,s,r,n,a),o.cause=t,o.name=t.name,i&&Object.assign(o,i),o};const hf=null;function Pa(t){return O.isPlainObject(t)||O.isArray(t)}function ac(t){return O.endsWith(t,"[]")?t.slice(0,-2):t}function Gi(t,s,r){return t?t.concat(s).map(function(a,i){return a=ac(a),!r&&i?"["+a+"]":a}).join(r?".":""):s}function ff(t){return O.isArray(t)&&!t.some(Pa)}const pf=O.toFlatObject(O,{},null,function(s){return/^is[A-Z]/.test(s)});function $n(t,s,r){if(!O.isObject(t))throw new TypeError("target must be an object");s=s||new FormData,r=O.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(y,b){return!O.isUndefined(b[y])});const n=r.metaTokens,a=r.visitor||u,i=r.dots,o=r.indexes,l=(r.Blob||typeof Blob<"u"&&Blob)&&O.isSpecCompliantForm(s);if(!O.isFunction(a))throw new TypeError("visitor must be a function");function d(g){if(g===null)return"";if(O.isDate(g))return g.toISOString();if(!l&&O.isBlob(g))throw new ce("Blob is not supported. Use a Buffer instead.");return O.isArrayBuffer(g)||O.isTypedArray(g)?l&&typeof Blob=="function"?new Blob([g]):Buffer.from(g):g}function u(g,y,b){let p=g;if(g&&!b&&typeof g=="object"){if(O.endsWith(y,"{}"))y=n?y:y.slice(0,-2),g=JSON.stringify(g);else if(O.isArray(g)&&ff(g)||(O.isFileList(g)||O.endsWith(y,"[]"))&&(p=O.toArray(g)))return y=ac(y),p.forEach(function(v,w){!(O.isUndefined(v)||v===null)&&s.append(o===!0?Gi([y],w,i):o===null?y:y+"[]",d(v))}),!1}return Pa(g)?!0:(s.append(Gi(b,y,i),d(g)),!1)}const h=[],f=Object.assign(pf,{defaultVisitor:u,convertValue:d,isVisitable:Pa});function x(g,y){if(!O.isUndefined(g)){if(h.indexOf(g)!==-1)throw Error("Circular reference detected in "+y.join("."));h.push(g),O.forEach(g,function(p,j){(!(O.isUndefined(p)||p===null)&&a.call(s,p,O.isString(j)?j.trim():j,y,f))===!0&&x(p,y?y.concat(j):[j])}),h.pop()}}if(!O.isObject(t))throw new TypeError("data must be an object");return x(t),s}function Ki(t){const s={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(n){return s[n]})}function Ja(t,s){this._pairs=[],t&&$n(t,this,s)}const ic=Ja.prototype;ic.append=function(s,r){this._pairs.push([s,r])};ic.toString=function(s){const r=s?function(n){return s.call(this,n,Ki)}:Ki;return this._pairs.map(function(a){return r(a[0])+"="+r(a[1])},"").join("&")};function xf(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function oc(t,s,r){if(!s)return t;const n=r&&r.encode||xf;O.isFunction(r)&&(r={serialize:r});const a=r&&r.serialize;let i;if(a?i=a(s,r):i=O.isURLSearchParams(s)?s.toString():new Ja(s,r).toString(n),i){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+i}return t}class Qi{constructor(){this.handlers=[]}use(s,r,n){return this.handlers.push({fulfilled:s,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(s){this.handlers[s]&&(this.handlers[s]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(s){O.forEach(this.handlers,function(n){n!==null&&s(n)})}}const lc={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},gf=typeof URLSearchParams<"u"?URLSearchParams:Ja,bf=typeof FormData<"u"?FormData:null,yf=typeof Blob<"u"?Blob:null,vf={isBrowser:!0,classes:{URLSearchParams:gf,FormData:bf,Blob:yf},protocols:["http","https","file","blob","url","data"]},Xa=typeof window<"u"&&typeof document<"u",Aa=typeof navigator=="object"&&navigator||void 0,jf=Xa&&(!Aa||["ReactNative","NativeScript","NS"].indexOf(Aa.product)<0),Nf=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",wf=Xa&&window.location.href||"http://localhost",Sf=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Xa,hasStandardBrowserEnv:jf,hasStandardBrowserWebWorkerEnv:Nf,navigator:Aa,origin:wf},Symbol.toStringTag,{value:"Module"})),it={...Sf,...vf};function Cf(t,s){return $n(t,new it.classes.URLSearchParams,Object.assign({visitor:function(r,n,a,i){return it.isNode&&O.isBuffer(r)?(this.append(n,r.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},s))}function Ef(t){return O.matchAll(/\w+|\[(\w*)]/g,t).map(s=>s[0]==="[]"?"":s[1]||s[0])}function kf(t){const s={},r=Object.keys(t);let n;const a=r.length;let i;for(n=0;n<a;n++)i=r[n],s[i]=t[i];return s}function cc(t){function s(r,n,a,i){let o=r[i++];if(o==="__proto__")return!0;const c=Number.isFinite(+o),l=i>=r.length;return o=!o&&O.isArray(a)?a.length:o,l?(O.hasOwnProp(a,o)?a[o]=[a[o],n]:a[o]=n,!c):((!a[o]||!O.isObject(a[o]))&&(a[o]=[]),s(r,n,a[o],i)&&O.isArray(a[o])&&(a[o]=kf(a[o])),!c)}if(O.isFormData(t)&&O.isFunction(t.entries)){const r={};return O.forEachEntry(t,(n,a)=>{s(Ef(n),a,r,0)}),r}return null}function Tf(t,s,r){if(O.isString(t))try{return(s||JSON.parse)(t),O.trim(t)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(t)}const Gr={transitional:lc,adapter:["xhr","http","fetch"],transformRequest:[function(s,r){const n=r.getContentType()||"",a=n.indexOf("application/json")>-1,i=O.isObject(s);if(i&&O.isHTMLForm(s)&&(s=new FormData(s)),O.isFormData(s))return a?JSON.stringify(cc(s)):s;if(O.isArrayBuffer(s)||O.isBuffer(s)||O.isStream(s)||O.isFile(s)||O.isBlob(s)||O.isReadableStream(s))return s;if(O.isArrayBufferView(s))return s.buffer;if(O.isURLSearchParams(s))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),s.toString();let c;if(i){if(n.indexOf("application/x-www-form-urlencoded")>-1)return Cf(s,this.formSerializer).toString();if((c=O.isFileList(s))||n.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return $n(c?{"files[]":s}:s,l&&new l,this.formSerializer)}}return i||a?(r.setContentType("application/json",!1),Tf(s)):s}],transformResponse:[function(s){const r=this.transitional||Gr.transitional,n=r&&r.forcedJSONParsing,a=this.responseType==="json";if(O.isResponse(s)||O.isReadableStream(s))return s;if(s&&O.isString(s)&&(n&&!this.responseType||a)){const o=!(r&&r.silentJSONParsing)&&a;try{return JSON.parse(s)}catch(c){if(o)throw c.name==="SyntaxError"?ce.from(c,ce.ERR_BAD_RESPONSE,this,null,this.response):c}}return s}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:it.classes.FormData,Blob:it.classes.Blob},validateStatus:function(s){return s>=200&&s<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};O.forEach(["delete","get","head","post","put","patch"],t=>{Gr.headers[t]={}});const Pf=O.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Af=t=>{const s={};let r,n,a;return t&&t.split(`
`).forEach(function(o){a=o.indexOf(":"),r=o.substring(0,a).trim().toLowerCase(),n=o.substring(a+1).trim(),!(!r||s[r]&&Pf[r])&&(r==="set-cookie"?s[r]?s[r].push(n):s[r]=[n]:s[r]=s[r]?s[r]+", "+n:n)}),s},Yi=Symbol("internals");function gr(t){return t&&String(t).trim().toLowerCase()}function ln(t){return t===!1||t==null?t:O.isArray(t)?t.map(ln):String(t)}function _f(t){const s=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(t);)s[n[1]]=n[2];return s}const If=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function ca(t,s,r,n,a){if(O.isFunction(n))return n.call(this,s,r);if(a&&(s=r),!!O.isString(s)){if(O.isString(n))return s.indexOf(n)!==-1;if(O.isRegExp(n))return n.test(s)}}function Rf(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(s,r,n)=>r.toUpperCase()+n)}function Of(t,s){const r=O.toCamelCase(" "+s);["get","set","has"].forEach(n=>{Object.defineProperty(t,n+r,{value:function(a,i,o){return this[n].call(this,s,a,i,o)},configurable:!0})})}let yt=class{constructor(s){s&&this.set(s)}set(s,r,n){const a=this;function i(c,l,d){const u=gr(l);if(!u)throw new Error("header name must be a non-empty string");const h=O.findKey(a,u);(!h||a[h]===void 0||d===!0||d===void 0&&a[h]!==!1)&&(a[h||l]=ln(c))}const o=(c,l)=>O.forEach(c,(d,u)=>i(d,u,l));if(O.isPlainObject(s)||s instanceof this.constructor)o(s,r);else if(O.isString(s)&&(s=s.trim())&&!If(s))o(Af(s),r);else if(O.isObject(s)&&O.isIterable(s)){let c={},l,d;for(const u of s){if(!O.isArray(u))throw TypeError("Object iterator must return a key-value pair");c[d=u[0]]=(l=c[d])?O.isArray(l)?[...l,u[1]]:[l,u[1]]:u[1]}o(c,r)}else s!=null&&i(r,s,n);return this}get(s,r){if(s=gr(s),s){const n=O.findKey(this,s);if(n){const a=this[n];if(!r)return a;if(r===!0)return _f(a);if(O.isFunction(r))return r.call(this,a,n);if(O.isRegExp(r))return r.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(s,r){if(s=gr(s),s){const n=O.findKey(this,s);return!!(n&&this[n]!==void 0&&(!r||ca(this,this[n],n,r)))}return!1}delete(s,r){const n=this;let a=!1;function i(o){if(o=gr(o),o){const c=O.findKey(n,o);c&&(!r||ca(n,n[c],c,r))&&(delete n[c],a=!0)}}return O.isArray(s)?s.forEach(i):i(s),a}clear(s){const r=Object.keys(this);let n=r.length,a=!1;for(;n--;){const i=r[n];(!s||ca(this,this[i],i,s,!0))&&(delete this[i],a=!0)}return a}normalize(s){const r=this,n={};return O.forEach(this,(a,i)=>{const o=O.findKey(n,i);if(o){r[o]=ln(a),delete r[i];return}const c=s?Rf(i):String(i).trim();c!==i&&delete r[i],r[c]=ln(a),n[c]=!0}),this}concat(...s){return this.constructor.concat(this,...s)}toJSON(s){const r=Object.create(null);return O.forEach(this,(n,a)=>{n!=null&&n!==!1&&(r[a]=s&&O.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([s,r])=>s+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(s){return s instanceof this?s:new this(s)}static concat(s,...r){const n=new this(s);return r.forEach(a=>n.set(a)),n}static accessor(s){const n=(this[Yi]=this[Yi]={accessors:{}}).accessors,a=this.prototype;function i(o){const c=gr(o);n[c]||(Of(a,o),n[c]=!0)}return O.isArray(s)?s.forEach(i):i(s),this}};yt.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);O.reduceDescriptors(yt.prototype,({value:t},s)=>{let r=s[0].toUpperCase()+s.slice(1);return{get:()=>t,set(n){this[r]=n}}});O.freezeMethods(yt);function da(t,s){const r=this||Gr,n=s||r,a=yt.from(n.headers);let i=n.data;return O.forEach(t,function(c){i=c.call(r,i,a.normalize(),s?s.status:void 0)}),a.normalize(),i}function dc(t){return!!(t&&t.__CANCEL__)}function hr(t,s,r){ce.call(this,t??"canceled",ce.ERR_CANCELED,s,r),this.name="CanceledError"}O.inherits(hr,ce,{__CANCEL__:!0});function uc(t,s,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?t(r):s(new ce("Request failed with status code "+r.status,[ce.ERR_BAD_REQUEST,ce.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function Lf(t){const s=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return s&&s[1]||""}function Mf(t,s){t=t||10;const r=new Array(t),n=new Array(t);let a=0,i=0,o;return s=s!==void 0?s:1e3,function(l){const d=Date.now(),u=n[i];o||(o=d),r[a]=l,n[a]=d;let h=i,f=0;for(;h!==a;)f+=r[h++],h=h%t;if(a=(a+1)%t,a===i&&(i=(i+1)%t),d-o<s)return;const x=u&&d-u;return x?Math.round(f*1e3/x):void 0}}function Df(t,s){let r=0,n=1e3/s,a,i;const o=(d,u=Date.now())=>{r=u,a=null,i&&(clearTimeout(i),i=null),t.apply(null,d)};return[(...d)=>{const u=Date.now(),h=u-r;h>=n?o(d,u):(a=d,i||(i=setTimeout(()=>{i=null,o(a)},n-h)))},()=>a&&o(a)]}const vn=(t,s,r=3)=>{let n=0;const a=Mf(50,250);return Df(i=>{const o=i.loaded,c=i.lengthComputable?i.total:void 0,l=o-n,d=a(l),u=o<=c;n=o;const h={loaded:o,total:c,progress:c?o/c:void 0,bytes:l,rate:d||void 0,estimated:d&&c&&u?(c-o)/d:void 0,event:i,lengthComputable:c!=null,[s?"download":"upload"]:!0};t(h)},r)},Ji=(t,s)=>{const r=t!=null;return[n=>s[0]({lengthComputable:r,total:t,loaded:n}),s[1]]},Xi=t=>(...s)=>O.asap(()=>t(...s)),$f=it.hasStandardBrowserEnv?((t,s)=>r=>(r=new URL(r,it.origin),t.protocol===r.protocol&&t.host===r.host&&(s||t.port===r.port)))(new URL(it.origin),it.navigator&&/(msie|trident)/i.test(it.navigator.userAgent)):()=>!0,Ff=it.hasStandardBrowserEnv?{write(t,s,r,n,a,i){const o=[t+"="+encodeURIComponent(s)];O.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),O.isString(n)&&o.push("path="+n),O.isString(a)&&o.push("domain="+a),i===!0&&o.push("secure"),document.cookie=o.join("; ")},read(t){const s=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return s?decodeURIComponent(s[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Bf(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function Uf(t,s){return s?t.replace(/\/?\/$/,"")+"/"+s.replace(/^\/+/,""):t}function mc(t,s,r){let n=!Bf(s);return t&&(n||r==!1)?Uf(t,s):s}const Zi=t=>t instanceof yt?{...t}:t;function Rs(t,s){s=s||{};const r={};function n(d,u,h,f){return O.isPlainObject(d)&&O.isPlainObject(u)?O.merge.call({caseless:f},d,u):O.isPlainObject(u)?O.merge({},u):O.isArray(u)?u.slice():u}function a(d,u,h,f){if(O.isUndefined(u)){if(!O.isUndefined(d))return n(void 0,d,h,f)}else return n(d,u,h,f)}function i(d,u){if(!O.isUndefined(u))return n(void 0,u)}function o(d,u){if(O.isUndefined(u)){if(!O.isUndefined(d))return n(void 0,d)}else return n(void 0,u)}function c(d,u,h){if(h in s)return n(d,u);if(h in t)return n(void 0,d)}const l={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:c,headers:(d,u,h)=>a(Zi(d),Zi(u),h,!0)};return O.forEach(Object.keys(Object.assign({},t,s)),function(u){const h=l[u]||a,f=h(t[u],s[u],u);O.isUndefined(f)&&h!==c||(r[u]=f)}),r}const hc=t=>{const s=Rs({},t);let{data:r,withXSRFToken:n,xsrfHeaderName:a,xsrfCookieName:i,headers:o,auth:c}=s;s.headers=o=yt.from(o),s.url=oc(mc(s.baseURL,s.url,s.allowAbsoluteUrls),t.params,t.paramsSerializer),c&&o.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):"")));let l;if(O.isFormData(r)){if(it.hasStandardBrowserEnv||it.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((l=o.getContentType())!==!1){const[d,...u]=l?l.split(";").map(h=>h.trim()).filter(Boolean):[];o.setContentType([d||"multipart/form-data",...u].join("; "))}}if(it.hasStandardBrowserEnv&&(n&&O.isFunction(n)&&(n=n(s)),n||n!==!1&&$f(s.url))){const d=a&&i&&Ff.read(i);d&&o.set(a,d)}return s},zf=typeof XMLHttpRequest<"u",Hf=zf&&function(t){return new Promise(function(r,n){const a=hc(t);let i=a.data;const o=yt.from(a.headers).normalize();let{responseType:c,onUploadProgress:l,onDownloadProgress:d}=a,u,h,f,x,g;function y(){x&&x(),g&&g(),a.cancelToken&&a.cancelToken.unsubscribe(u),a.signal&&a.signal.removeEventListener("abort",u)}let b=new XMLHttpRequest;b.open(a.method.toUpperCase(),a.url,!0),b.timeout=a.timeout;function p(){if(!b)return;const v=yt.from("getAllResponseHeaders"in b&&b.getAllResponseHeaders()),N={data:!c||c==="text"||c==="json"?b.responseText:b.response,status:b.status,statusText:b.statusText,headers:v,config:t,request:b};uc(function(S){r(S),y()},function(S){n(S),y()},N),b=null}"onloadend"in b?b.onloadend=p:b.onreadystatechange=function(){!b||b.readyState!==4||b.status===0&&!(b.responseURL&&b.responseURL.indexOf("file:")===0)||setTimeout(p)},b.onabort=function(){b&&(n(new ce("Request aborted",ce.ECONNABORTED,t,b)),b=null)},b.onerror=function(){n(new ce("Network Error",ce.ERR_NETWORK,t,b)),b=null},b.ontimeout=function(){let w=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const N=a.transitional||lc;a.timeoutErrorMessage&&(w=a.timeoutErrorMessage),n(new ce(w,N.clarifyTimeoutError?ce.ETIMEDOUT:ce.ECONNABORTED,t,b)),b=null},i===void 0&&o.setContentType(null),"setRequestHeader"in b&&O.forEach(o.toJSON(),function(w,N){b.setRequestHeader(N,w)}),O.isUndefined(a.withCredentials)||(b.withCredentials=!!a.withCredentials),c&&c!=="json"&&(b.responseType=a.responseType),d&&([f,g]=vn(d,!0),b.addEventListener("progress",f)),l&&b.upload&&([h,x]=vn(l),b.upload.addEventListener("progress",h),b.upload.addEventListener("loadend",x)),(a.cancelToken||a.signal)&&(u=v=>{b&&(n(!v||v.type?new hr(null,t,b):v),b.abort(),b=null)},a.cancelToken&&a.cancelToken.subscribe(u),a.signal&&(a.signal.aborted?u():a.signal.addEventListener("abort",u)));const j=Lf(a.url);if(j&&it.protocols.indexOf(j)===-1){n(new ce("Unsupported protocol "+j+":",ce.ERR_BAD_REQUEST,t));return}b.send(i||null)})},qf=(t,s)=>{const{length:r}=t=t?t.filter(Boolean):[];if(s||r){let n=new AbortController,a;const i=function(d){if(!a){a=!0,c();const u=d instanceof Error?d:this.reason;n.abort(u instanceof ce?u:new hr(u instanceof Error?u.message:u))}};let o=s&&setTimeout(()=>{o=null,i(new ce(`timeout ${s} of ms exceeded`,ce.ETIMEDOUT))},s);const c=()=>{t&&(o&&clearTimeout(o),o=null,t.forEach(d=>{d.unsubscribe?d.unsubscribe(i):d.removeEventListener("abort",i)}),t=null)};t.forEach(d=>d.addEventListener("abort",i));const{signal:l}=n;return l.unsubscribe=()=>O.asap(c),l}},Wf=function*(t,s){let r=t.byteLength;if(r<s){yield t;return}let n=0,a;for(;n<r;)a=n+s,yield t.slice(n,a),n=a},Vf=async function*(t,s){for await(const r of Gf(t))yield*Wf(r,s)},Gf=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const s=t.getReader();try{for(;;){const{done:r,value:n}=await s.read();if(r)break;yield n}}finally{await s.cancel()}},eo=(t,s,r,n)=>{const a=Vf(t,s);let i=0,o,c=l=>{o||(o=!0,n&&n(l))};return new ReadableStream({async pull(l){try{const{done:d,value:u}=await a.next();if(d){c(),l.close();return}let h=u.byteLength;if(r){let f=i+=h;r(f)}l.enqueue(new Uint8Array(u))}catch(d){throw c(d),d}},cancel(l){return c(l),a.return()}},{highWaterMark:2})},Fn=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",fc=Fn&&typeof ReadableStream=="function",Kf=Fn&&(typeof TextEncoder=="function"?(t=>s=>t.encode(s))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),pc=(t,...s)=>{try{return!!t(...s)}catch{return!1}},Qf=fc&&pc(()=>{let t=!1;const s=new Request(it.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!s}),to=64*1024,_a=fc&&pc(()=>O.isReadableStream(new Response("").body)),jn={stream:_a&&(t=>t.body)};Fn&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(s=>{!jn[s]&&(jn[s]=O.isFunction(t[s])?r=>r[s]():(r,n)=>{throw new ce(`Response type '${s}' is not supported`,ce.ERR_NOT_SUPPORT,n)})})})(new Response);const Yf=async t=>{if(t==null)return 0;if(O.isBlob(t))return t.size;if(O.isSpecCompliantForm(t))return(await new Request(it.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(O.isArrayBufferView(t)||O.isArrayBuffer(t))return t.byteLength;if(O.isURLSearchParams(t)&&(t=t+""),O.isString(t))return(await Kf(t)).byteLength},Jf=async(t,s)=>{const r=O.toFiniteNumber(t.getContentLength());return r??Yf(s)},Xf=Fn&&(async t=>{let{url:s,method:r,data:n,signal:a,cancelToken:i,timeout:o,onDownloadProgress:c,onUploadProgress:l,responseType:d,headers:u,withCredentials:h="same-origin",fetchOptions:f}=hc(t);d=d?(d+"").toLowerCase():"text";let x=qf([a,i&&i.toAbortSignal()],o),g;const y=x&&x.unsubscribe&&(()=>{x.unsubscribe()});let b;try{if(l&&Qf&&r!=="get"&&r!=="head"&&(b=await Jf(u,n))!==0){let N=new Request(s,{method:"POST",body:n,duplex:"half"}),k;if(O.isFormData(n)&&(k=N.headers.get("content-type"))&&u.setContentType(k),N.body){const[S,E]=Ji(b,vn(Xi(l)));n=eo(N.body,to,S,E)}}O.isString(h)||(h=h?"include":"omit");const p="credentials"in Request.prototype;g=new Request(s,{...f,signal:x,method:r.toUpperCase(),headers:u.normalize().toJSON(),body:n,duplex:"half",credentials:p?h:void 0});let j=await fetch(g);const v=_a&&(d==="stream"||d==="response");if(_a&&(c||v&&y)){const N={};["status","statusText","headers"].forEach(A=>{N[A]=j[A]});const k=O.toFiniteNumber(j.headers.get("content-length")),[S,E]=c&&Ji(k,vn(Xi(c),!0))||[];j=new Response(eo(j.body,to,S,()=>{E&&E(),y&&y()}),N)}d=d||"text";let w=await jn[O.findKey(jn,d)||"text"](j,t);return!v&&y&&y(),await new Promise((N,k)=>{uc(N,k,{data:w,headers:yt.from(j.headers),status:j.status,statusText:j.statusText,config:t,request:g})})}catch(p){throw y&&y(),p&&p.name==="TypeError"&&/Load failed|fetch/i.test(p.message)?Object.assign(new ce("Network Error",ce.ERR_NETWORK,t,g),{cause:p.cause||p}):ce.from(p,p&&p.code,t,g)}}),Ia={http:hf,xhr:Hf,fetch:Xf};O.forEach(Ia,(t,s)=>{if(t){try{Object.defineProperty(t,"name",{value:s})}catch{}Object.defineProperty(t,"adapterName",{value:s})}});const so=t=>`- ${t}`,Zf=t=>O.isFunction(t)||t===null||t===!1,xc={getAdapter:t=>{t=O.isArray(t)?t:[t];const{length:s}=t;let r,n;const a={};for(let i=0;i<s;i++){r=t[i];let o;if(n=r,!Zf(r)&&(n=Ia[(o=String(r)).toLowerCase()],n===void 0))throw new ce(`Unknown adapter '${o}'`);if(n)break;a[o||"#"+i]=n}if(!n){const i=Object.entries(a).map(([c,l])=>`adapter ${c} `+(l===!1?"is not supported by the environment":"is not available in the build"));let o=s?i.length>1?`since :
`+i.map(so).join(`
`):" "+so(i[0]):"as no adapter specified";throw new ce("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return n},adapters:Ia};function ua(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new hr(null,t)}function ro(t){return ua(t),t.headers=yt.from(t.headers),t.data=da.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),xc.getAdapter(t.adapter||Gr.adapter)(t).then(function(n){return ua(t),n.data=da.call(t,t.transformResponse,n),n.headers=yt.from(n.headers),n},function(n){return dc(n)||(ua(t),n&&n.response&&(n.response.data=da.call(t,t.transformResponse,n.response),n.response.headers=yt.from(n.response.headers))),Promise.reject(n)})}const gc="1.9.0",Bn={};["object","boolean","number","function","string","symbol"].forEach((t,s)=>{Bn[t]=function(n){return typeof n===t||"a"+(s<1?"n ":" ")+t}});const no={};Bn.transitional=function(s,r,n){function a(i,o){return"[Axios v"+gc+"] Transitional option '"+i+"'"+o+(n?". "+n:"")}return(i,o,c)=>{if(s===!1)throw new ce(a(o," has been removed"+(r?" in "+r:"")),ce.ERR_DEPRECATED);return r&&!no[o]&&(no[o]=!0,console.warn(a(o," has been deprecated since v"+r+" and will be removed in the near future"))),s?s(i,o,c):!0}};Bn.spelling=function(s){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${s}`),!0)};function ep(t,s,r){if(typeof t!="object")throw new ce("options must be an object",ce.ERR_BAD_OPTION_VALUE);const n=Object.keys(t);let a=n.length;for(;a-- >0;){const i=n[a],o=s[i];if(o){const c=t[i],l=c===void 0||o(c,i,t);if(l!==!0)throw new ce("option "+i+" must be "+l,ce.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new ce("Unknown option "+i,ce.ERR_BAD_OPTION)}}const cn={assertOptions:ep,validators:Bn},Ht=cn.validators;let As=class{constructor(s){this.defaults=s||{},this.interceptors={request:new Qi,response:new Qi}}async request(s,r){try{return await this._request(s,r)}catch(n){if(n instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const i=a.stack?a.stack.replace(/^.+\n/,""):"";try{n.stack?i&&!String(n.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+i):n.stack=i}catch{}}throw n}}_request(s,r){typeof s=="string"?(r=r||{},r.url=s):r=s||{},r=Rs(this.defaults,r);const{transitional:n,paramsSerializer:a,headers:i}=r;n!==void 0&&cn.assertOptions(n,{silentJSONParsing:Ht.transitional(Ht.boolean),forcedJSONParsing:Ht.transitional(Ht.boolean),clarifyTimeoutError:Ht.transitional(Ht.boolean)},!1),a!=null&&(O.isFunction(a)?r.paramsSerializer={serialize:a}:cn.assertOptions(a,{encode:Ht.function,serialize:Ht.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),cn.assertOptions(r,{baseUrl:Ht.spelling("baseURL"),withXsrfToken:Ht.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=i&&O.merge(i.common,i[r.method]);i&&O.forEach(["delete","get","head","post","put","patch","common"],g=>{delete i[g]}),r.headers=yt.concat(o,i);const c=[];let l=!0;this.interceptors.request.forEach(function(y){typeof y.runWhen=="function"&&y.runWhen(r)===!1||(l=l&&y.synchronous,c.unshift(y.fulfilled,y.rejected))});const d=[];this.interceptors.response.forEach(function(y){d.push(y.fulfilled,y.rejected)});let u,h=0,f;if(!l){const g=[ro.bind(this),void 0];for(g.unshift.apply(g,c),g.push.apply(g,d),f=g.length,u=Promise.resolve(r);h<f;)u=u.then(g[h++],g[h++]);return u}f=c.length;let x=r;for(h=0;h<f;){const g=c[h++],y=c[h++];try{x=g(x)}catch(b){y.call(this,b);break}}try{u=ro.call(this,x)}catch(g){return Promise.reject(g)}for(h=0,f=d.length;h<f;)u=u.then(d[h++],d[h++]);return u}getUri(s){s=Rs(this.defaults,s);const r=mc(s.baseURL,s.url,s.allowAbsoluteUrls);return oc(r,s.params,s.paramsSerializer)}};O.forEach(["delete","get","head","options"],function(s){As.prototype[s]=function(r,n){return this.request(Rs(n||{},{method:s,url:r,data:(n||{}).data}))}});O.forEach(["post","put","patch"],function(s){function r(n){return function(i,o,c){return this.request(Rs(c||{},{method:s,headers:n?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}As.prototype[s]=r(),As.prototype[s+"Form"]=r(!0)});let tp=class bc{constructor(s){if(typeof s!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(i){r=i});const n=this;this.promise.then(a=>{if(!n._listeners)return;let i=n._listeners.length;for(;i-- >0;)n._listeners[i](a);n._listeners=null}),this.promise.then=a=>{let i;const o=new Promise(c=>{n.subscribe(c),i=c}).then(a);return o.cancel=function(){n.unsubscribe(i)},o},s(function(i,o,c){n.reason||(n.reason=new hr(i,o,c),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(s){if(this.reason){s(this.reason);return}this._listeners?this._listeners.push(s):this._listeners=[s]}unsubscribe(s){if(!this._listeners)return;const r=this._listeners.indexOf(s);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const s=new AbortController,r=n=>{s.abort(n)};return this.subscribe(r),s.signal.unsubscribe=()=>this.unsubscribe(r),s.signal}static source(){let s;return{token:new bc(function(a){s=a}),cancel:s}}};function sp(t){return function(r){return t.apply(null,r)}}function rp(t){return O.isObject(t)&&t.isAxiosError===!0}const Ra={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Ra).forEach(([t,s])=>{Ra[s]=t});function yc(t){const s=new As(t),r=Ql(As.prototype.request,s);return O.extend(r,As.prototype,s,{allOwnKeys:!0}),O.extend(r,s,null,{allOwnKeys:!0}),r.create=function(a){return yc(Rs(t,a))},r}const Ue=yc(Gr);Ue.Axios=As;Ue.CanceledError=hr;Ue.CancelToken=tp;Ue.isCancel=dc;Ue.VERSION=gc;Ue.toFormData=$n;Ue.AxiosError=ce;Ue.Cancel=Ue.CanceledError;Ue.all=function(s){return Promise.all(s)};Ue.spread=sp;Ue.isAxiosError=rp;Ue.mergeConfig=Rs;Ue.AxiosHeaders=yt;Ue.formToJSON=t=>cc(O.isHTMLForm(t)?new FormData(t):t);Ue.getAdapter=xc.getAdapter;Ue.HttpStatusCode=Ra;Ue.default=Ue;const{Axios:L0,AxiosError:M0,CanceledError:D0,isCancel:$0,CancelToken:F0,VERSION:B0,all:U0,Cancel:z0,isAxiosError:H0,spread:q0,toFormData:W0,AxiosHeaders:V0,HttpStatusCode:G0,formToJSON:K0,getAdapter:Q0,mergeConfig:Y0}=Ue,Pe=Ue.create({baseURL:le,headers:{"Content-Type":"application/json"}});Pe.interceptors.request.use(t=>{const s=localStorage.getItem(ns),r=s?JSON.parse(s):null;return r!=null&&r.access&&!t.headers.Authorization&&(t.headers.Authorization=`Bearer ${r.access}`),t},t=>Promise.reject(t));Pe.interceptors.response.use(t=>t,async t=>{var r;const s=t.config;if(((r=t.response)==null?void 0:r.status)===401){const n=localStorage.getItem(ns),a=n?JSON.parse(n):null;if(a!=null&&a.refresh&&!s._retry){s._retry=!0;try{const i=await Ue.post(`${le}/auth/token/refresh/`,{refresh:a.refresh}),{access:o}=i.data;return localStorage.setItem(ns,JSON.stringify({...a,access:o})),s.headers.Authorization=`Bearer ${o}`,Pe(s)}catch{localStorage.removeItem(ns)}}}return Promise.reject(t)});class np{constructor(){Fs(this,"login",this.verifyOTP)}getHeaders(s=!1){const r={"Content-Type":"application/json"};if(s){const n=this.getStoredTokens();n!=null&&n.access&&(r.Authorization=`Bearer ${n.access}`)}return r}getStoredTokens(){const s=localStorage.getItem(ns);return s?JSON.parse(s):null}setStoredTokens(s){localStorage.setItem(ns,JSON.stringify(s))}clearStoredTokens(){localStorage.removeItem(ns)}async requestOTP(s){console.log("API: requestOTP called with:",s),console.log("API: Using URL:",`${le}${pe.REQUEST_OTP}`);try{const r=await fetch(`${le}${pe.REQUEST_OTP}`,{method:"POST",headers:this.getHeaders(),body:JSON.stringify({phone_number:s})});if(console.log("API: requestOTP response status:",r.status),console.log("API: requestOTP response headers:",r.headers),!r.ok){const a=await r.text();throw console.error("API: requestOTP failed:",a),new Error(`Failed to request OTP: ${r.status} - ${a}`)}const n=await r.json();return console.log("API: requestOTP success:",n),n}catch(r){throw console.error("API: requestOTP error with primary URL:",r),r}}async verifyOTP(s,r){console.log("API: verifyOTP called with:",s,r),console.log("API: Using URL:",`${le}${pe.VERIFY_OTP}`);try{const n=await fetch(`${le}${pe.VERIFY_OTP}`,{method:"POST",headers:this.getHeaders(),body:JSON.stringify({phone_number:s,code:r})});if(console.log("API: verifyOTP response status:",n.status),!n.ok){const i=await n.json().catch(()=>({}));throw console.error("API: verifyOTP failed:",i),new Error(i.error||`Failed to verify OTP: ${n.status}`)}const a=await n.json();return console.log("API: verifyOTP success:",a),this.setStoredTokens({access:a.access,refresh:a.refresh}),a}catch(n){throw console.error("API: verifyOTP error with primary URL:",n),n}}async getProfile(){const s=await fetch(`${le}${pe.PROFILE}`,{method:"GET",headers:this.getHeaders(!0)});if(!s.ok)throw new Error("Failed to get profile");return s.json()}async updateProfile(s){console.log("API: updateProfile called with data:",s),console.log("API: Using endpoint:",`${le}${pe.PROFILE}`);const r=await fetch(`${le}${pe.PROFILE}`,{method:"PUT",headers:this.getHeaders(!0),body:JSON.stringify(s)});if(console.log("API: updateProfile response status:",r.status),!r.ok){const a=await r.text();throw console.error("API: updateProfile failed:",a),new Error(`Failed to update profile: ${r.status} - ${a}`)}const n=await r.json();return console.log("API: updateProfile success:",n),n}async getAvatar(){const s=await fetch(`${le}${pe.AVATAR}`,{method:"GET",headers:this.getHeaders(!0)});if(!s.ok)throw new Error("Failed to get avatar");return s.json()}async uploadAvatar(s){const r=new FormData;r.append("avatar",s);const n=this.getHeaders(!0);delete n["Content-Type"];const a=await fetch(`${le}${pe.AVATAR}`,{method:"POST",headers:n,body:r});if(!a.ok)throw new Error("Failed to upload avatar");return a.json()}async deleteAvatar(){const s=await fetch(`${le}${pe.AVATAR}`,{method:"DELETE",headers:this.getHeaders(!0)});if(!s.ok)throw new Error("Failed to delete avatar");return s.json()}logout(){this.clearStoredTokens()}async getArticleComments(s){const r=await fetch(`${le}${pe.ARTICLE_COMMENTS(s)}`,{method:"GET",headers:this.getHeaders()});if(!r.ok)throw new Error("Failed to get article comments");return r.json()}async createArticleComment(s,r){const n=await fetch(`${le}${pe.ARTICLE_COMMENTS(s)}`,{method:"POST",headers:this.getHeaders(!0),body:JSON.stringify(r)});if(!n.ok)throw new Error("Failed to create article comment");return n.json()}async getVideoComments(s){const r=await fetch(`${le}${pe.VIDEO_COMMENTS(s)}`,{method:"GET",headers:this.getHeaders()});if(!r.ok)throw new Error("Failed to get video comments");return r.json()}async createVideoComment(s,r){const n=await fetch(`${le}${pe.VIDEO_COMMENTS(s)}`,{method:"POST",headers:this.getHeaders(!0),body:JSON.stringify(r)});if(!n.ok)throw new Error("Failed to create video comment");return n.json()}async getPodcastComments(s){const r=await fetch(`${le}${pe.PODCAST_COMMENTS(s)}`,{method:"GET",headers:this.getHeaders()});if(!r.ok)throw new Error("Failed to get podcast comments");return r.json()}async createPodcastComment(s,r){const n=await fetch(`${le}${pe.PODCAST_COMMENTS(s)}`,{method:"POST",headers:this.getHeaders(!0),body:JSON.stringify(r)});if(!n.ok)throw new Error("Failed to create podcast comment");return n.json()}async getMediaComments(s,r){const n=`${le}${pe.MEDIA_COMMENTS}?content_type=${s}&object_id=${r}`,a=await fetch(n,{method:"GET",headers:this.getHeaders()});if(!a.ok)throw new Error("Failed to get media comments");return a.json()}async createMediaComment(s){const r=await fetch(`${le}${pe.MEDIA_COMMENTS}`,{method:"POST",headers:this.getHeaders(!0),body:JSON.stringify(s)});if(!r.ok)throw new Error("Failed to create media comment");return r.json()}async updateMediaComment(s,r){const n=await fetch(`${le}${pe.MEDIA_COMMENT_DETAIL(s)}`,{method:"PUT",headers:this.getHeaders(!0),body:JSON.stringify({content:r})});if(!n.ok)throw new Error("Failed to update comment");return n.json()}async deleteMediaComment(s){if(!(await fetch(`${le}${pe.MEDIA_COMMENT_DETAIL(s)}`,{method:"DELETE",headers:this.getHeaders(!0)})).ok)throw new Error("Failed to delete comment")}async testApiConnection(){try{console.log("Testing API connection to:",le);const s=await fetch(`${le}/content/articles/?page=1&page_size=1`,{method:"GET",headers:this.getHeaders()});return console.log("API connection test status:",s.status),s.ok?(console.log("API connection successful"),!0):(console.log("API connection failed with status:",s.status),!1)}catch(s){return console.error("API connection test error:",s),!1}}}const Te=new np,tt=t=>t?t.startsWith("http")?t:`${le}${t}`:null,Tr={getAll:async(t=1,s=10)=>{const r=await Pe.get(`${le}${pe.ARTICLES}?page=${t}&page_size=${s}`);return Array.isArray(r.data)?{count:r.data.length,total_pages:1,current_page:1,next:null,previous:null,results:r.data.map(n=>({...n,id:n.id.toString(),category:{...n.category,id:n.category.id.toString()},tags:n.tags.map(a=>({...a,id:a.id.toString()})),thumbnail:tt(n.thumbnail),description:n.summary||"",date:n.published,author:n.author||"نویسنده"}))}:{...r.data,results:r.data.results.map(n=>({...n,id:n.id.toString(),category:{...n.category,id:n.category.id.toString()},tags:n.tags.map(a=>({...a,id:a.id.toString()})),thumbnail:tt(n.thumbnail),description:n.summary||"",date:n.published_at,author:n.author||"نویسنده"}))}},getById:async t=>{const s=await Pe.get(`${le}${pe.ARTICLE_DETAIL(parseInt(t))}`);return{...s.data,id:s.data.id.toString(),category:{...s.data.category,id:s.data.category.id.toString()},tags:s.data.tags.map(r=>({...r,id:r.id.toString()})),thumbnail:tt(s.data.thumbnail),description:s.data.summary||"",date:s.data.published,author:s.data.author||"نویسنده"}}},dn={getAll:async(t=1,s=10)=>{const r=await Pe.get(`${le}${pe.VIDEOS}?page=${t}&page_size=${s}`);return Array.isArray(r.data)?{count:r.data.length,total_pages:1,current_page:1,next:null,previous:null,results:r.data.map(n=>({...n,id:n.id.toString(),author:typeof n.author=="object"?`${n.author.first_name} ${n.author.last_name}`.trim()||n.author.username||n.author.email:n.author||"نویسنده",category:{...n.category,id:n.category.id.toString()},tags:n.tags.map(a=>({...a,id:a.id.toString()})),thumbnail:tt(n.thumbnail),date:n.published_at||n.created_at}))}:{...r.data,results:r.data.results.map(n=>({...n,id:n.id.toString(),author:typeof n.author=="object"?`${n.author.first_name} ${n.author.last_name}`.trim()||n.author.username||n.author.email:n.author||"نویسنده",category:{...n.category,id:n.category.id.toString()},tags:n.tags.map(a=>({...a,id:a.id.toString()})),thumbnail:tt(n.thumbnail),date:n.published_at||n.created_at}))}},getById:async t=>{const s=await Pe.get(`${le}${pe.VIDEO_DETAIL(parseInt(t))}`);return{...s.data,id:s.data.id.toString(),author:typeof s.data.author=="object"?`${s.data.author.first_name} ${s.data.author.last_name}`.trim()||s.data.author.username||s.data.author.email:s.data.author||"نویسنده",category:{...s.data.category,id:s.data.category.id.toString()},tags:s.data.tags.map(r=>({...r,id:r.id.toString()})),thumbnail:tt(s.data.thumbnail),date:s.data.published_at||s.data.created_at}}},qs={getAll:async()=>{const t=await fetch(`${le}${pe.BOOKMARKS}`,{headers:{Authorization:`Bearer ${mn()}`,"Content-Type":"application/json"}});if(!t.ok)throw new Error("Failed to fetch bookmarks");return t.json()},create:async t=>{var r;const s=await fetch(`${le}${pe.BOOKMARKS}`,{method:"POST",headers:{Authorization:`Bearer ${mn()}`,"Content-Type":"application/json"},body:JSON.stringify({article:parseInt(t)})});if(!s.ok){const n=await s.json();throw new Error(((r=n.non_field_errors)==null?void 0:r[0])||"Failed to create bookmark")}return s.json()},delete:async t=>{if(!(await fetch(`${le}${pe.BOOKMARK_DETAIL(parseInt(t))}`,{method:"DELETE",headers:{Authorization:`Bearer ${mn()}`,"Content-Type":"application/json"}})).ok)throw new Error("Failed to delete bookmark")},isBookmarked:async t=>{try{return(await qs.getAll()).some(r=>r.article.id===t)}catch(s){return console.error("Error checking bookmark status:",s),!1}},findByArticleId:async t=>{try{return(await qs.getAll()).find(r=>r.article.id===t)||null}catch(s){return console.error("Error finding bookmark:",s),null}}},Pr={getAll:async(t=1,s=10)=>{const r=await Pe.get(`${le}${pe.PODCASTS}?page=${t}&page_size=${s}`);return Array.isArray(r.data)?{count:r.data.length,total_pages:1,current_page:1,next:null,previous:null,results:r.data.map(n=>({...n,id:n.id.toString(),author:typeof n.author=="object"?`${n.author.first_name} ${n.author.last_name}`.trim()||n.author.username||n.author.email:n.author||"نویسنده",category:{...n.category,id:n.category.id.toString()},tags:n.tags.map(a=>({...a,id:a.id.toString()})),thumbnail:tt(n.thumbnail),date:n.published_at||n.created_at}))}:{...r.data,results:r.data.results.map(n=>({...n,id:n.id.toString(),author:typeof n.author=="object"?`${n.author.first_name} ${n.author.last_name}`.trim()||n.author.username||n.author.email:n.author||"نویسنده",category:{...n.category,id:n.category.id.toString()},tags:n.tags.map(a=>({...a,id:a.id.toString()})),thumbnail:tt(n.thumbnail),date:n.published_at||n.created_at}))}},getById:async t=>{const s=await Pe.get(`${le}${pe.PODCAST_DETAIL(parseInt(t))}`);return{...s.data,id:s.data.id.toString(),author:typeof s.data.author=="object"?`${s.data.author.first_name} ${s.data.author.last_name}`.trim()||s.data.author.username||s.data.author.email:s.data.author||"نویسنده",category:{...s.data.category,id:s.data.category.id.toString()},tags:s.data.tags.map(r=>({...r,id:r.id.toString()})),thumbnail:tt(s.data.thumbnail),date:s.data.published_at||s.data.created_at}}},un={getAll:async(t=1,s=10)=>{const r=await Pe.get(`${le}${pe.LIVESTREAMS}?page=${t}&page_size=${s}`);return Array.isArray(r.data)?{count:r.data.length,total_pages:1,current_page:1,next:null,previous:null,results:r.data.map(n=>({...n,thumbnail:tt(n.thumbnail)}))}:{...r.data,results:r.data.results.map(n=>({...n,thumbnail:tt(n.thumbnail)}))}},getById:async t=>{const s=await Pe.get(`${le}${pe.LIVESTREAM_DETAIL(parseInt(t))}`);return{...s.data,thumbnail:tt(s.data.thumbnail)}}},Bs={getAll:async(t=1,s=10)=>{const r=await Pe.get(`${le}${pe.COURSES}?page=${t}&page_size=${s}`);return Array.isArray(r.data)?{count:r.data.length,total_pages:1,current_page:1,next:null,previous:null,results:r.data.map(n=>({...n,id:n.id.toString(),thumbnail:tt(n.thumbnail)}))}:{...r.data,results:r.data.results.map(n=>({...n,id:n.id.toString(),thumbnail:tt(n.thumbnail)}))}},getMyCourses:async(t=1,s=10)=>{const r=await Pe.get(`${le}${pe.MY_COURSES}?page=${t}&page_size=${s}`,{headers:{Authorization:`Bearer ${mn()}`,"Content-Type":"application/json"}});return Array.isArray(r.data)?{count:r.data.length,total_pages:1,current_page:1,next:null,previous:null,results:r.data.map(n=>({...n,id:n.id.toString(),thumbnail:tt(n.thumbnail)}))}:{...r.data,results:r.data.results.map(n=>({...n,id:n.id.toString(),thumbnail:tt(n.thumbnail)}))}},getById:async t=>{const s=await Pe.get(`${le}${pe.COURSE_DETAIL(t)}`);return{...s.data,id:s.data.id.toString(),thumbnail:tt(s.data.thumbnail)}}};function mn(){const t=localStorage.getItem("auth_tokens");if(t)try{return JSON.parse(t).access}catch{return null}return null}const ap=(t=!0)=>{console.log("🗑️ Starting cache clearing process..."),localStorage.removeItem(ns),localStorage.removeItem("auth_tokens"),console.log("✅ Auth tokens cleared"),t?console.log("ℹ️ Pending course data preserved"):(localStorage.removeItem("pendingCourseId"),console.log("✅ Pending course data cleared"));const s=[];for(let r=0;r<localStorage.length;r++){const n=localStorage.key(r);n&&(n.startsWith("auth_")||n.startsWith("course_")||n.startsWith("user_")||n.startsWith("wallet_")||n.includes("token")||n.includes("pending")&&!t)&&s.push(n)}s.forEach(r=>{localStorage.removeItem(r),console.log(`✅ Removed cache key: ${r}`)}),console.log("🎉 All cache cleared successfully")},js=()=>{localStorage.removeItem("pendingCourseId"),console.log("✅ Pending course data cleared")},vc=m.createContext(void 0),ip=({children:t})=>{const[s,r]=m.useState(null),[n,a]=m.useState(!0),[i,o]=m.useState(null),[c,l]=m.useState("");m.useEffect(()=>{(async()=>{console.log("AuthContext: Initializing authentication..."),a(!0);try{const p=await Te.testApiConnection();console.log("AuthContext: API connection test result:",p),p||console.warn("AuthContext: API connection failed, but continuing...");const j=Te.getStoredTokens();if(console.log("AuthContext: Stored tokens found:",!!j),j)try{const v=await Te.getProfile(),w=await Te.getAvatar();r({id:String(v.id),phone:v.phone_number,name:`${v.first_name} ${v.last_name}`.trim(),email:v.email,isProfileComplete:!!(v.first_name&&v.last_name),avatar:w.avatar,first_name:v.first_name,last_name:v.last_name,phone_number:v.phone_number}),console.log("AuthContext: User restored from stored tokens")}catch(v){console.error("AuthContext: Error restoring user session:",v),Te.logout()}}catch(p){console.error("AuthContext: Initialization error:",p)}finally{a(!1)}})()},[]);const d=async b=>{console.log("=== AuthContext: requestOTP START ==="),console.log("AuthContext: requestOTP called with phone:",b),console.log("AuthContext: Current phoneNumber state:",c),a(!0),o(null);try{console.log("=== AuthContext: CALLING API ===");const p=await Te.requestOTP(b);return console.log("=== AuthContext: API SUCCESS ==="),console.log("AuthContext: OTP response received:",p),console.log("AuthContext: Setting phoneNumber to:",b),l(b),p}catch(p){console.log("=== AuthContext: API FAILED ==="),console.error("AuthContext: Error in requestOTP:",p);let j="خطا در ارسال کد تایید";throw p instanceof Error&&(j=p.message),console.log("AuthContext: Setting error:",j),o(j),p}finally{console.log("=== AuthContext: requestOTP END ==="),a(!1)}},u=async b=>{if(console.log("=== AuthContext: verifyOTP START ==="),console.log("AuthContext: verifyOTP called with otp:",b,"and phone:",c),a(!0),o(null),!c){console.error("AuthContext: No phone number set");const p="شماره تلفن تعریف نشده است";throw o(p),a(!1),new Error(p)}try{console.log("=== AuthContext: CALLING VERIFY OTP API ===");const p=await Te.verifyOTP(c,b);console.log("=== AuthContext: VERIFY OTP SUCCESS ==="),console.log("AuthContext: verifyOTP response:",p),console.log("=== AuthContext: GETTING AVATAR ===");const j=await Te.getAvatar();console.log("AuthContext: Avatar data:",j);const v=!!(p.user.first_name&&p.user.last_name);console.log("AuthContext: Profile complete check:",{first_name:p.user.first_name,last_name:p.user.last_name,isProfileComplete:v});const w={id:String(p.user.id),phone:p.user.phone_number,name:`${p.user.first_name||""} ${p.user.last_name||""}`.trim(),email:p.user.email,isProfileComplete:v,avatar:j.avatar,first_name:p.user.first_name,last_name:p.user.last_name,phone_number:p.user.phone_number};console.log("=== AuthContext: SETTING USER ==="),console.log("AuthContext: Setting user data:",w),r(w),console.log("AuthContext: OTP verified successfully, isProfileComplete:",v)}catch(p){console.log("=== AuthContext: VERIFY OTP FAILED ==="),console.error("AuthContext: Error in verifyOTP:",p);let j="کد تایید نامعتبر است";throw p instanceof Error&&(j=p.message),console.log("AuthContext: Setting error:",j),o(j),p}finally{console.log("=== AuthContext: verifyOTP END ==="),a(!1)}},h=async(b,p)=>{l(b),await u(p)},f=async(b,p)=>{if(console.log("AuthContext: completeProfile called with:",{name:b,email:p}),a(!0),o(null),!localStorage.getItem("auth_tokens"))throw new Error("کاربر احراز هویت نشده است. لطفاً دوباره وارد شوید");try{const v=b.trim().split(/\s+/).filter(z=>z.length>0),w=v[0]||"",N=v.length>1?v.slice(1).join(" "):"";if(console.log("AuthContext: Name parts:",{originalName:b,nameParts:v,firstName:w,lastName:N}),!w||w.length<2)throw new Error("نام وارد شده نامعتبر است");const k={first_name:w,last_name:N,email:p?p.trim():""};console.log("AuthContext: Sending profile data to API:",k);const S=await Te.updateProfile(k);console.log("AuthContext: Received updated user from API:",S);const E=await Te.getAvatar();console.log("AuthContext: Received avatar data:",E);const A={id:String(S.id),phone:S.phone_number,name:`${S.first_name} ${S.last_name}`.trim(),email:S.email,isProfileComplete:!0,avatar:E.avatar,first_name:S.first_name,last_name:S.last_name,phone_number:S.phone_number};console.log("AuthContext: Setting new user state:",A),r(A)}catch(v){console.error("AuthContext: Error in completeProfile:",v);let w="خطا در تکمیل پروفایل";throw v.message&&v.message.includes("Failed to update profile")?v.message.includes("400")?w="اطلاعات وارد شده نامعتبر است":v.message.includes("401")?w="احراز هویت نامعتبر است. لطفاً دوباره وارد شوید":v.message.includes("422")?w="فرمت اطلاعات وارد شده صحیح نیست":v.message.includes("first_name")?w="نام وارد شده نامعتبر است":v.message.includes("email")&&(w="ایمیل وارد شده نامعتبر است"):v.message&&(w=v.message),o(w),new Error(w)}finally{a(!1)}},x=async b=>{var j,v;if(!s)return;o(null);const p={first_name:b.first_name||(b.name?(j=b.name)==null?void 0:j.split(" ")[0]:void 0),last_name:b.last_name||(b.name?(v=b.name)==null?void 0:v.split(" ").slice(1).join(" "):void 0),email:b.email};console.log("AuthContext: updateProfile called with data:",b),console.log("AuthContext: Converted to API format:",p);try{const w=await Te.updateProfile(p);console.log("AuthContext: Profile updated successfully:",w),r({...s,name:`${w.first_name} ${w.last_name}`.trim(),email:w.email,first_name:w.first_name,last_name:w.last_name})}catch(w){throw console.error("AuthContext: Failed to update profile:",w),o("خطا در بروزرسانی پروفایل"),w}},g=b=>{s&&r({...s,avatar:b})},y=()=>{console.log("AuthContext: Starting logout process"),Te.logout(),r(null),l(""),o(null),ap(),window.dispatchEvent(new CustomEvent("auth:logout")),setTimeout(()=>{window.location.replace("/")},100)};return e.jsx(vc.Provider,{value:{user:s,isLoading:n,error:i,phoneNumber:c,setPhoneNumber:l,requestOTP:d,verifyOTP:u,login:h,completeProfile:f,updateProfile:x,updateAvatar:g,logout:y},children:t})},Oe=()=>{const t=m.useContext(vc);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t},jc=m.createContext(void 0),op=({children:t})=>{const{user:s,isLoading:r}=Oe(),[n,a]=m.useState([]),[i,o]=m.useState([]),[c,l]=m.useState({}),[d,u]=m.useState({courses:!0,myCourses:!1}),[h,f]=m.useState({courses:{currentPage:1,totalPages:1,totalCount:0,hasNext:!1,hasPrevious:!1},myCourses:{currentPage:1,totalPages:1,totalCount:0,hasNext:!1,hasPrevious:!1}}),x=N=>{const k=new Set(N.map(S=>S.id));a(S=>S.map(E=>({...E,is_enrolled:k.has(E.id)})))},g=()=>{a([]),o([]),l({}),u({courses:!0,myCourses:!1}),f({courses:{currentPage:1,totalPages:1,totalCount:0,hasNext:!1,hasPrevious:!1},myCourses:{currentPage:1,totalPages:1,totalCount:0,hasNext:!1,hasPrevious:!1}})};m.useEffect(()=>{const N=()=>{g()};return window.addEventListener("auth:logout",N),()=>{window.removeEventListener("auth:logout",N)}},[]);const y=async(N,k=!1)=>{if(!k&&c[N])return c[N];try{const E=(await Pe.get(`/crs/courses/${N}/?include_comments=true&include_chapters=true`)).data;return l(A=>({...A,[N]:E})),E}catch(S){return console.error("Error fetching course details:",S),null}},b=async N=>y(N,!0);m.useEffect(()=>{(async()=>{try{u(S=>({...S,courses:!0}));const k=await Bs.getAll(1,10);a(k.results),f(S=>({...S,courses:{currentPage:k.current_page,totalPages:k.total_pages,totalCount:k.count,hasNext:!!k.next,hasPrevious:!!k.previous}}))}catch(k){console.error("Error fetching courses:",k),a([])}finally{u(k=>({...k,courses:!1}))}})()},[]),m.useEffect(()=>{n.length>0&&!d.myCourses&&x(i)},[n.length,i.length,d.myCourses]),m.useEffect(()=>{(async()=>{try{if(r)return;if(!s){console.log("CourseContext: User not authenticated, clearing myCourses"),o([]),u(S=>({...S,myCourses:!1}));return}console.log("CourseContext: User authenticated, fetching myCourses"),u(S=>({...S,myCourses:!0}));const k=await Bs.getMyCourses(1,10);console.log("CourseContext: myCourses fetched:",k.results),o(k.results),f(S=>({...S,myCourses:{currentPage:k.current_page,totalPages:k.total_pages,totalCount:k.count,hasNext:!!k.next,hasPrevious:!!k.previous}})),x(k.results)}catch(k){console.error("Error fetching my courses:",k),o([])}finally{u(k=>({...k,myCourses:!1}))}})()},[s,r]);const p=N=>{const k=n.find(S=>S.id===N);if(k&&!i.find(S=>S.id===N)){const S={...k,completedLessons:0,is_enrolled:!0,progress_percentage:0};o(E=>[S,...E]),a(E=>E.map(A=>A.id===N?{...A,is_enrolled:!0}:A)),l(E=>{const A={...E};return Object.keys(A).forEach(z=>{A[z].info.id===N&&delete A[z]}),A}),j()}},j=async()=>{try{if(!s){console.log("CourseContext: User not authenticated, clearing myCourses"),o([]);return}console.log("CourseContext: Refreshing myCourses for user:",s.id);const N=await Bs.getMyCourses(1,10);console.log("CourseContext: myCourses refreshed:",N.results),o(N.results),f(k=>({...k,myCourses:{currentPage:N.current_page,totalPages:N.total_pages,totalCount:N.count,hasNext:!!N.next,hasPrevious:!!N.previous}})),x(N.results)}catch(N){console.error("Error refreshing my courses:",N)}},v=async()=>{if(!(!h.courses.hasNext||d.courses))try{u(k=>({...k,courses:!0}));const N=await Bs.getAll(h.courses.currentPage+1,10);a(k=>[...k,...N.results]),f(k=>({...k,courses:{currentPage:N.current_page,totalPages:N.total_pages,totalCount:N.count,hasNext:!!N.next,hasPrevious:!!N.previous}}))}catch(N){console.error("Error loading more courses:",N)}finally{u(N=>({...N,courses:!1}))}},w=async()=>{if(!(!h.myCourses.hasNext||d.myCourses))try{u(k=>({...k,myCourses:!0}));const N=await Bs.getMyCourses(h.myCourses.currentPage+1,10);o(k=>[...k,...N.results]),f(k=>({...k,myCourses:{currentPage:N.current_page,totalPages:N.total_pages,totalCount:N.count,hasNext:!!N.next,hasPrevious:!!N.previous}}))}catch(N){console.error("Error loading more my courses:",N)}finally{u(N=>({...N,myCourses:!1}))}};return e.jsx(jc.Provider,{value:{courses:n,myCourses:i,enrollCourse:p,fetchCourseDetails:y,loadMoreCourses:v,loadMoreMyCourses:w,refreshMyCourses:j,refreshCourseDetails:b,isLoading:d,pagination:h,clearCourseCache:g},children:t})},Un=()=>{const t=m.useContext(jc);if(t===void 0)throw new Error("useCourse must be used within a CourseProvider");return t},Nc=m.createContext(void 0),lp=({children:t})=>{const{user:s}=Oe(),[r,n]=m.useState([]),[a,i]=m.useState([]),[o,c]=m.useState([]),[l,d]=m.useState([]),[u,h]=m.useState([]),[f,x]=m.useState([]),[g,y]=m.useState([]),[b,p]=m.useState([]),[j,v]=m.useState({articles:!0,videos:!0,podcasts:!0,livestreams:!0,bookmarks:!1}),[w,N]=m.useState({articles:{currentPage:1,totalPages:1,totalCount:0,hasNext:!1,hasPrevious:!1},videos:{currentPage:1,totalPages:1,totalCount:0,hasNext:!1,hasPrevious:!1},podcasts:{currentPage:1,totalPages:1,totalCount:0,hasNext:!1,hasPrevious:!1},livestreams:{currentPage:1,totalPages:1,totalCount:0,hasNext:!1,hasPrevious:!1}}),k=I=>{var P,_,L,q,V,K,se;return{id:I.id.toString(),user:I.user,article:{...I.article,id:((_=(P=I.article)==null?void 0:P.id)==null?void 0:_.toString())||((L=I.article)==null?void 0:L.id)||"unknown"},created_at:I.created_at,itemId:((V=(q=I.article)==null?void 0:q.id)==null?void 0:V.toString())||((K=I.article)==null?void 0:K.id)||"unknown",itemType:"article",userId:((se=I.user)==null?void 0:se.id)||"unknown",date:I.created_at}},S=I=>({id:I.id.toString(),title:I.title,slug:I.slug,description:I.description,thumbnail:I.thumbnail,stream_url:I.stream_url,start_at:I.start_at,stream_status:I.stream_status,max_viewers:I.max_viewers,current_viewers:I.current_viewers,author:I.author,category:I.category,tags:I.tags,status:I.status,featured:I.featured,created_at:I.created_at,updated_at:I.updated_at,published_at:I.published_at,view_count:I.view_count,videoUrl:I.stream_url||"",isLive:I.stream_status==="live",startTime:I.start_at||"",date:I.created_at,duration:"00:00:00"}),E=()=>{console.log("ContentContext: Clearing content cache and resetting state"),n([]),i([]),c([]),d([]),h([]),x([]),y([]),p([]),v({articles:!0,videos:!0,podcasts:!0,livestreams:!0,bookmarks:!1})},A=async()=>{console.log("ContentContext: Reloading all content..."),v({articles:!0,videos:!0,podcasts:!0,livestreams:!0,bookmarks:!1});try{const I=await Tr.getAll(1,10);n(I.results),N(K=>({...K,articles:{currentPage:I.current_page,totalPages:I.total_pages,totalCount:I.count,hasNext:!!I.next,hasPrevious:!!I.previous}}));const P=await dn.getAll(1,10);c(P.results),N(K=>({...K,videos:{currentPage:P.current_page,totalPages:P.total_pages,totalCount:P.count,hasNext:!!P.next,hasPrevious:!!P.previous}}));const _=await Pr.getAll(1,10),L=_.results.map(K=>({id:K.id,title:K.title,description:K.description,thumbnail:K.thumbnail||"",audio_type:K.audio_type,audio_file:K.audio_file,audio_url:K.audio_url,author:K.author,date:K.date,duration:K.duration,tags:K.tags.map(se=>se.name)}));i(L),N(K=>({...K,podcasts:{currentPage:_.current_page,totalPages:_.total_pages,totalCount:_.count,hasNext:!!_.next,hasPrevious:!!_.previous}}));const q=await un.getAll(1,10);h(q.results);const V=q.results.map(S);if(d(V),N(K=>({...K,livestreams:{currentPage:q.current_page,totalPages:q.total_pages,totalCount:q.count,hasNext:!!q.next,hasPrevious:!!q.previous}})),s){const se=(await qs.getAll()).map(k);y(se)}console.log("ContentContext: All content reloaded successfully")}catch(I){console.error("ContentContext: Error reloading content:",I)}finally{v({articles:!1,videos:!1,podcasts:!1,livestreams:!1,bookmarks:!1})}};m.useEffect(()=>{const I=()=>{console.log("ContentContext: Received logout event, clearing cache"),E()},P=()=>{console.log("ContentContext: Received reload event, refreshing content"),A()};return window.addEventListener("auth:logout",I),window.addEventListener("pwa:reload",P),()=>{window.removeEventListener("auth:logout",I),window.removeEventListener("pwa:reload",P)}},[s]),m.useEffect(()=>{(async()=>{try{v(_=>({..._,articles:!0}));const P=await Tr.getAll(1,10);n(P.results),N(_=>({..._,articles:{currentPage:P.current_page,totalPages:P.total_pages,totalCount:P.count,hasNext:!!P.next,hasPrevious:!!P.previous}}))}catch(P){console.error("Error fetching articles:",P),n([])}finally{v(P=>({...P,articles:!1}))}})()},[]),m.useEffect(()=>{(async()=>{try{v(_=>({..._,videos:!0}));const P=await dn.getAll(1,10);c(P.results),N(_=>({..._,videos:{currentPage:P.current_page,totalPages:P.total_pages,totalCount:P.count,hasNext:!!P.next,hasPrevious:!!P.previous}}))}catch(P){console.error("Error fetching videos:",P),c([])}finally{v(P=>({...P,videos:!1}))}})()},[]),m.useEffect(()=>{(async()=>{try{v(L=>({...L,podcasts:!0}));const P=await Pr.getAll(1,10),_=P.results.map(L=>({id:L.id,title:L.title,description:L.description,thumbnail:L.thumbnail||"",audio_type:L.audio_type,audio_file:L.audio_file,audio_url:L.audio_url,author:L.author,date:L.date,duration:L.duration,tags:L.tags.map(q=>q.name)}));i(_),N(L=>({...L,podcasts:{currentPage:P.current_page,totalPages:P.total_pages,totalCount:P.count,hasNext:!!P.next,hasPrevious:!!P.previous}}))}catch(P){console.error("Error fetching podcasts:",P),i([])}finally{v(P=>({...P,podcasts:!1}))}})()},[]),m.useEffect(()=>{(async()=>{try{v(L=>({...L,livestreams:!0}));const P=await un.getAll(1,10);h(P.results);const _=P.results.map(S);d(_),N(L=>({...L,livestreams:{currentPage:P.current_page,totalPages:P.total_pages,totalCount:P.count,hasNext:!!P.next,hasPrevious:!!P.previous}}))}catch(P){console.error("Error fetching livestreams:",P),h([]),d([])}finally{v(P=>({...P,livestreams:!1}))}})()},[]),m.useEffect(()=>{(async()=>{if(!s){y([]);return}try{v(L=>({...L,bookmarks:!0}));const _=(await qs.getAll()).map(k);y(_)}catch(P){console.error("Error fetching bookmarks:",P),y([])}finally{v(P=>({...P,bookmarks:!1}))}})()},[s]);const z=async I=>{if(!s)throw new Error("User must be logged in to bookmark articles");try{const P=await qs.create(I),_=k(P);y(L=>[...L,_])}catch(P){throw console.error("Error adding bookmark:",P),P}},D=async I=>{if(!s)throw new Error("User must be logged in to remove bookmarks");try{const P=g.find(_=>_.article.id===I);if(!P)throw new Error("Bookmark not found");await qs.delete(P.id),y(_=>_.filter(L=>L.article.id!==I))}catch(P){throw console.error("Error removing bookmark:",P),P}},T=I=>g.some(P=>P.article.id===I),R=I=>{const P={...I,id:Math.random().toString(),date:new Date().toISOString()};p([...b,P])},F=async()=>{if(!(!w.articles.hasNext||j.articles))try{v(P=>({...P,articles:!0}));const I=await Tr.getAll(w.articles.currentPage+1,10);n(P=>[...P,...I.results]),N(P=>({...P,articles:{currentPage:I.current_page,totalPages:I.total_pages,totalCount:I.count,hasNext:!!I.next,hasPrevious:!!I.previous}}))}catch(I){console.error("Error loading more articles:",I)}finally{v(I=>({...I,articles:!1}))}},Z=async()=>{if(!(!w.videos.hasNext||j.videos))try{v(P=>({...P,videos:!0}));const I=await dn.getAll(w.videos.currentPage+1,10);c(P=>[...P,...I.results]),N(P=>({...P,videos:{currentPage:I.current_page,totalPages:I.total_pages,totalCount:I.count,hasNext:!!I.next,hasPrevious:!!I.previous}}))}catch(I){console.error("Error loading more videos:",I)}finally{v(I=>({...I,videos:!1}))}},B=async()=>{if(!(!w.podcasts.hasNext||j.podcasts))try{v(_=>({..._,podcasts:!0}));const I=await Pr.getAll(w.podcasts.currentPage+1,10),P=I.results.map(_=>({id:_.id,title:_.title,description:_.description,thumbnail:_.thumbnail||"",audio_type:_.audio_type,audio_file:_.audio_file,audio_url:_.audio_url,author:_.author,date:_.date,duration:_.duration,tags:_.tags.map(L=>L.name)}));i(_=>[..._,...P]),N(_=>({..._,podcasts:{currentPage:I.current_page,totalPages:I.total_pages,totalCount:I.count,hasNext:!!I.next,hasPrevious:!!I.previous}}))}catch(I){console.error("Error loading more podcasts:",I)}finally{v(I=>({...I,podcasts:!1}))}},Y=async()=>{if(!(!w.livestreams.hasNext||j.livestreams))try{v(P=>({...P,livestreams:!0}));const I=await un.getAll(w.livestreams.currentPage+1,10);h(P=>[...P,...I.results]),N(P=>({...P,livestreams:{currentPage:I.current_page,totalPages:I.total_pages,totalCount:I.count,hasNext:!!I.next,hasPrevious:!!I.previous}}))}catch(I){console.error("Error loading more livestreams:",I)}finally{v(I=>({...I,livestreams:!1}))}};return e.jsx(Nc.Provider,{value:{articles:r,podcasts:a,videos:o,webinars:l,livestreams:u,files:f,bookmarks:g,comments:b,addBookmark:z,removeBookmark:D,isBookmarked:T,addComment:R,clearContentCache:E,loadMoreArticles:F,loadMoreVideos:Z,loadMorePodcasts:B,loadMoreLivestreams:Y,isLoading:j,pagination:w},children:t})},Kr=()=>{const t=m.useContext(Nc);if(t===void 0)throw new Error("useContent must be used within a ContentProvider");return t},wc=m.createContext(void 0),cp=({children:t})=>{const[s,r]=m.useState(null),[n,a]=m.useState(!0),[i,o]=m.useState(null),[c,l]=m.useState(0),{user:d}=Oe(),u=async(y=0)=>{try{a(!0),o(null);const b=localStorage.getItem("auth_tokens");if(!b||!d){r(null),a(!1);return}const j={Authorization:`Bearer ${JSON.parse(b).access}`},[v,w]=await Promise.all([Pe.get("/wallet/balance/",{headers:j}),Pe.get("/wallet/transactions/",{headers:j})]);r({balance:parseFloat(v.data.balance),is_active:v.data.is_active,created_at:v.data.created_at,updated_at:v.data.updated_at,transactions:w.data}),l(0)}catch(b){if(console.error("WalletContext: Error fetching wallet data:",b),y<2){const p=Math.pow(2,y)*1e3;setTimeout(()=>{u(y+1)},p),l(y+1);return}o("خطا در بارگذاری اطلاعات کیف پول"),r(null),l(0)}finally{a(!1)}},h=()=>{r(null),o(null),a(!1)},f=()=>{h(),l(0)};m.useEffect(()=>{const y=()=>{f()};return window.addEventListener("auth:logout",y),()=>{window.removeEventListener("auth:logout",y)}},[]),m.useEffect(()=>{d?u():h()},[d==null?void 0:d.id]);const x=async y=>{try{const b=localStorage.getItem("auth_tokens");if(!b||!s||!d)return{success:!1,error:"Not authenticated or wallet not initialized"};const p=JSON.parse(b).access,j=await Pe.post("/wallet/deposit/",{amount:y},{headers:{Authorization:`Bearer ${p}`}});return j.data.message==="Deposit successful"?(r(v=>v?{...v,balance:j.data.new_balance,updated_at:new Date().toISOString()}:null),{success:!0,new_balance:j.data.new_balance}):{success:!1,error:"Deposit failed"}}catch(b){return console.error("Error updating wallet:",b),{success:!1,error:"An error occurred"}}},g=()=>{d&&u()};return e.jsx(wc.Provider,{value:{wallet:s,isLoading:n,error:i,updateWallet:x,refetchWallet:g,clearWalletCache:f},children:t})},Za=()=>{const t=m.useContext(wc);if(t===void 0)throw new Error("useWallet must be used within a WalletProvider");return t},dp=({children:t})=>e.jsx(op,{children:e.jsx(lp,{children:e.jsx(cp,{children:t})})}),as=()=>{const t=Un(),s=Kr(),r=Za(),n=t.isLoading.courses||s.isLoading.articles||s.isLoading.videos||s.isLoading.livestreams||r.isLoading;return{courses:t.courses,myCourses:t.myCourses,enrollCourse:t.enrollCourse,fetchCourseDetails:t.fetchCourseDetails,articles:s.articles,podcasts:s.podcasts,videos:s.videos,webinars:s.webinars,livestreams:s.livestreams,files:s.files,bookmarks:s.bookmarks,comments:s.comments,addBookmark:s.addBookmark,removeBookmark:s.removeBookmark,addComment:s.addComment,wallet:r.wallet,updateWallet:r.updateWallet,refetchWallet:r.refetchWallet,isLoading:n,loadingStates:{courses:t.isLoading.courses,articles:s.isLoading.articles,videos:s.isLoading.videos,livestreams:s.isLoading.livestreams,wallet:r.isLoading},errors:{wallet:r.error}}},up=Wr("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 relative overflow-hidden min-h-[44px] min-w-[44px] touch-manipulation",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 active:bg-primary/80",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90 active:bg-destructive/80",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground active:bg-accent/80",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 active:bg-secondary/70",ghost:"hover:bg-accent hover:text-accent-foreground active:bg-accent/80",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-11 px-4 py-2",sm:"h-10 rounded-md px-3",lg:"h-12 rounded-md px-8",icon:"h-11 w-11"}},defaultVariants:{variant:"default",size:"default"}}),$=m.forwardRef(({className:t,variant:s,size:r,asChild:n=!1,onClick:a,...i},o)=>{const c=n?Fo:"button",l=d=>{const u=d.currentTarget,h=u.getBoundingClientRect(),f=d.clientX-h.left,x=d.clientY-h.top,g=document.createElement("span");g.style.left=`${f}px`,g.style.top=`${x}px`,g.className="absolute rounded-full bg-white/20 w-5 h-5 -translate-x-1/2 -translate-y-1/2 animate-ripple",u.appendChild(g),setTimeout(()=>{u.contains(g)&&u.removeChild(g)},700),a&&a(d)};return e.jsx(c,{className:W(up({variant:s,size:r,className:t})),ref:o,onClick:l,...i})});$.displayName="Button";const mp="BEl62iUYgUivxIkv69yViEuiBIa40HI2BN9QClUOUb20gvWy9o2KPa4DCDX3Cx_VRi4lIXx5B4IYb8fPsUION6Y";function hp(t){const s="=".repeat((4-t.length%4)%4),r=(t+s).replace(/-/g,"+").replace(/_/g,"/"),n=window.atob(r),a=new Uint8Array(n.length);for(let i=0;i<n.length;++i)a[i]=n.charCodeAt(i);return a}const zn=()=>{const[t,s]=m.useState({isSupported:!1,permission:"default",subscription:null,isLoading:!1,error:null});m.useEffect(()=>{(()=>{const d="serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window;s(u=>({...u,isSupported:d,permission:d?Notification.permission:"denied"}))})()},[]),m.useEffect(()=>{const l=async()=>{if(t.isSupported)try{const u=await(await navigator.serviceWorker.ready).pushManager.getSubscription();s(h=>({...h,subscription:u}))}catch(d){console.error("Error getting current subscription:",d),s(u=>({...u,error:"خطا در دریافت اشتراک فعلی"}))}};t.isSupported&&t.permission==="granted"&&l()},[t.isSupported,t.permission]);const r=m.useCallback(async()=>{if(!t.isSupported)return s(l=>({...l,error:"مرورگر شما از اعلان‌ها پشتیبانی نمی‌کند"})),!1;s(l=>({...l,isLoading:!0,error:null}));try{const l=await Notification.requestPermission();return s(d=>({...d,permission:l,isLoading:!1})),l==="granted"?!0:(l==="denied"&&s(d=>({...d,error:"مجوز اعلان‌ها رد شد. لطفاً از تنظیمات مرورگر آن را فعال کنید."})),!1)}catch(l){return console.error("Error requesting permission:",l),s(d=>({...d,error:"خطا در درخواست مجوز اعلان‌ها",isLoading:!1})),!1}},[t.isSupported]),n=m.useCallback(async()=>{if((!t.isSupported||t.permission!=="granted")&&!await r())return!1;s(l=>({...l,isLoading:!0,error:null}));try{const d=await(await navigator.serviceWorker.ready).pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:hp(mp)});return s(u=>({...u,subscription:d,isLoading:!1})),await fp(d),!0}catch(l){return console.error("Error subscribing to push notifications:",l),s(d=>({...d,error:"خطا در ثبت اشتراک اعلان‌ها",isLoading:!1})),!1}},[t.isSupported,t.permission,r]),a=m.useCallback(async()=>{if(!t.subscription)return!0;s(l=>({...l,isLoading:!0,error:null}));try{return await t.subscription.unsubscribe(),await pp(t.subscription),s(l=>({...l,subscription:null,isLoading:!1})),!0}catch(l){return console.error("Error unsubscribing from push notifications:",l),s(d=>({...d,error:"خطا در لغو اشتراک اعلان‌ها",isLoading:!1})),!1}},[t.subscription]),i=m.useCallback(async()=>{if(!t.subscription)return s(l=>({...l,error:"ابتدا باید در اعلان‌ها ثبت‌نام کنید"})),!1;s(l=>({...l,isLoading:!0,error:null}));try{try{const d=await fetch("/api/push/test",{method:"POST",headers:{"Content-Type":"application/json"}});if(d.ok){const u=await d.json();if(u.success)return console.log("Test notification sent via backend:",u.message),s(h=>({...h,isLoading:!1})),!0}}catch(d){console.warn("Backend not available, using local notification:",d)}return await(await navigator.serviceWorker.ready).showNotification("تست اعلان - مسترتریدر آکادمی",{body:"این یک اعلان آزمایشی محلی است (backend متصل نیست)",icon:"/lovable-uploads/970ac420-2fc4-450d-9177-b465e09c7857.png",badge:"/lovable-uploads/970ac420-2fc4-450d-9177-b465e09c7857.png",tag:"test-notification",requireInteraction:!1,data:{url:"/",timestamp:Date.now(),type:"test"}}),s(d=>({...d,isLoading:!1})),!0}catch(l){return console.error("Error sending test notification:",l),s(d=>({...d,error:"خطا در ارسال اعلان آزمایشی",isLoading:!1})),!1}},[t.subscription]),o=m.useCallback(async(l,d)=>{if(!t.subscription)return console.warn("No push subscription available for course purchase notification"),!1;s(u=>({...u,isLoading:!0,error:null}));try{try{const h=await fetch("/api/push/send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:"🎉 خرید موفق - مسترتریدر آکادمی",body:`دوره "${l}" با موفقیت خریداری شد! می‌توانید از همین الان شروع به یادگیری کنید.`,icon:"/lovable-uploads/970ac420-2fc4-450d-9177-b465e09c7857.png",url:`/learn/${d}`,tag:"course-purchase"})});if(h.ok){const f=await h.json();if(f.success)return console.log("Course purchase notification sent via backend:",f.message),s(x=>({...x,isLoading:!1})),!0}}catch(h){console.warn("Backend not available, using local notification:",h)}return await(await navigator.serviceWorker.ready).showNotification("🎉 خرید موفق - مسترتریدر آکادمی",{body:`دوره "${l}" با موفقیت خریداری شد! می‌توانید از همین الان شروع به یادگیری کنید.`,icon:"/lovable-uploads/970ac420-2fc4-450d-9177-b465e09c7857.png",badge:"/lovable-uploads/970ac420-2fc4-450d-9177-b465e09c7857.png",tag:"course-purchase",requireInteraction:!0,actions:[{action:"view-course",title:"شروع یادگیری",icon:"/lovable-uploads/970ac420-2fc4-450d-9177-b465e09c7857.png"}],data:{url:`/learn/${d}`,timestamp:Date.now(),type:"course-purchase",courseId:d,courseTitle:l}}),s(h=>({...h,isLoading:!1})),!0}catch(u){return console.error("Error sending course purchase notification:",u),s(h=>({...h,error:"خطا در ارسال اعلان خرید دوره",isLoading:!1})),!1}},[t.subscription]),c=m.useCallback(()=>{s(l=>({...l,error:null}))},[]);return{...t,requestPermission:r,subscribe:n,unsubscribe:a,sendTestNotification:i,sendCoursePurchaseNotification:o,clearError:c}};async function fp(t){try{const s=await fetch("/api/push/subscribe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subscription:t.toJSON(),timestamp:Date.now(),userAgent:navigator.userAgent})});if(!s.ok){if(s.status===405||s.status===404){console.warn("Push notification backend endpoints are not implemented yet."),console.info("Please implement /api/push/subscribe endpoint according to the documentation.");return}throw new Error(`HTTP error! status: ${s.status}`)}console.log("Subscription sent to server successfully")}catch(s){if(s instanceof TypeError||s.message.includes("405")){console.warn("Push notification backend is not configured. Subscription works locally.");return}console.error("Error sending subscription to server:",s)}}async function pp(t){try{const s=await fetch("/api/push/unsubscribe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subscription:t.toJSON(),timestamp:Date.now()})});if(!s.ok){if(s.status===405||s.status===404){console.warn("Push notification backend endpoints are not implemented yet."),console.info("Please implement /api/push/unsubscribe endpoint according to the documentation.");return}throw new Error(`HTTP error! status: ${s.status}`)}console.log("Subscription removed from server successfully")}catch(s){if(s instanceof TypeError||s.message.includes("405")){console.warn("Push notification backend is not configured. Unsubscription works locally.");return}console.error("Error removing subscription from server:",s)}}const xp=()=>/iPad|iPhone|iPod/.test(navigator.userAgent),Sc=()=>{const[t,s]=m.useState(!1),[r,n]=m.useState(!1),{isSupported:a,permission:i,requestPermission:o,subscribe:c}=zn(),{toast:l}=ot(),d=xp();m.useEffect(()=>{const x=()=>{if(d)return!localStorage.getItem("ios-pwa-guide-seen");if(!a||i!=="default")return!1;const y=localStorage.getItem("push-permission-prompted"),b=localStorage.getItem("push-permission-declined");return!(y||b)},g=setTimeout(()=>{x()&&(d?n(!0):(s(!0),localStorage.setItem("push-permission-prompted","true")))},3e3);return()=>clearTimeout(g)},[a,i,d]);const u=async()=>{try{await o()&&await c()&&l({title:"✅ اعلان‌ها فعال شد",description:"از این پس اعلان‌های مهم را دریافت خواهید کرد."})}catch(x){console.error("خطا در فعال‌سازی اعلان‌ها:",x),l({title:"❌ خطا در فعال‌سازی",description:"لطفاً دوباره تلاش کنید.",variant:"destructive"})}s(!1)},h=()=>{localStorage.setItem("push-permission-declined","true"),s(!1),l({title:"🔕 اعلان‌ها غیرفعال",description:"می‌تونید از تنظیمات دوباره فعالشون کنید."})},f=()=>{localStorage.setItem("ios-pwa-guide-seen","true"),n(!1),l({title:"📱 راهنمای iOS",description:"برای بهترین تجربه، اپ را به Home Screen اضافه کنید."})};return r?e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full mx-auto p-6 relative animate-in slide-in-from-bottom-4 duration-300",children:[e.jsx("button",{onClick:f,className:"absolute top-4 left-4 text-gray-400 hover:text-gray-600 transition-colors","aria-label":"بستن",children:e.jsx(Lr,{className:"h-5 w-5"})}),e.jsx("div",{className:"text-center mb-4",children:e.jsx("div",{className:"bg-blue-100 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4",children:e.jsx(Ir,{className:"h-8 w-8 text-blue-600"})})}),e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"نصب Mr Trader Academy"}),e.jsx("p",{className:"text-gray-600 leading-relaxed",children:"برای بهترین تجربه در iOS، اپ رو به Home Screen اضافه کنید."})]}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 mb-6 text-right",children:e.jsxs("div",{className:"space-y-3 text-sm text-gray-700",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx("span",{className:"text-blue-500 ml-2 mt-1",children:"1️⃣"}),e.jsxs("div",{children:[e.jsx("strong",{children:"دکمه Share را بزنید"}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx(Ks,{className:"h-4 w-4 text-blue-500 ml-2"}),e.jsx("span",{className:"text-xs",children:"در پایین صفحه Safari"})]})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("span",{className:"text-blue-500 ml-2 mt-1",children:"2️⃣"}),e.jsxs("div",{children:[e.jsx("strong",{children:'"Add to Home Screen" را انتخاب کنید'}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx(Ir,{className:"h-4 w-4 text-blue-500 ml-2"}),e.jsx("span",{className:"text-xs",children:"در لیست گزینه‌ها"})]})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("span",{className:"text-blue-500 ml-2 mt-1",children:"3️⃣"}),e.jsxs("div",{children:[e.jsx("strong",{children:'"Add" را بزنید'}),e.jsx("p",{className:"text-xs mt-1",children:"Mr Trader Academy روی Home Screen شما اضافه می‌شود"})]})]})]})}),e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3 mb-4",children:e.jsxs("p",{className:"text-xs text-amber-800",children:[e.jsx("strong",{children:"⚠️ توجه:"})," در iOS، Push Notifications فقط بعد از نصب PWA کار می‌کند."]})}),e.jsx($,{onClick:f,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium",children:"متوجه شدم"}),e.jsx("p",{className:"text-xs text-gray-500 text-center mt-3",children:"بعد از نصب می‌تونید اعلان‌ها رو فعال کنید"})]})}):t?e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full mx-auto p-6 relative animate-in slide-in-from-bottom-4 duration-300",children:[e.jsx("button",{onClick:h,className:"absolute top-4 left-4 text-gray-400 hover:text-gray-600 transition-colors","aria-label":"بستن",children:e.jsx(Lr,{className:"h-5 w-5"})}),e.jsx("div",{className:"text-center mb-4",children:e.jsx("div",{className:"bg-trader-100 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4",children:e.jsx(ir,{className:"h-8 w-8 text-trader-600"})})}),e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"از آخرین اخبار مطلع بشید!"}),e.jsx("p",{className:"text-gray-600 leading-relaxed",children:"اجازه بدید تا اعلان‌های مهم آموزشی، تحلیل‌های بازار و فرصت‌های ترید رو برای شما ارسال کنیم."})]}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 mb-6 text-right",children:e.jsxs("ul",{className:"space-y-2 text-sm text-gray-700",children:[e.jsxs("li",{className:"flex items-center",children:[e.jsx("span",{className:"text-green-500 ml-2",children:"✓"}),"تحلیل‌های فوری بازار"]}),e.jsxs("li",{className:"flex items-center",children:[e.jsx("span",{className:"text-green-500 ml-2",children:"✓"}),"فرصت‌های ترید طلایی"]}),e.jsxs("li",{className:"flex items-center",children:[e.jsx("span",{className:"text-green-500 ml-2",children:"✓"}),"اخبار و رویدادهای مهم"]}),e.jsxs("li",{className:"flex items-center",children:[e.jsx("span",{className:"text-green-500 ml-2",children:"✓"}),"محتوای آموزشی جدید"]})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs($,{onClick:u,className:"flex-1 bg-trader-600 hover:bg-trader-700 text-white font-medium",children:[e.jsx(ir,{className:"h-4 w-4 ml-2"}),"فعال‌سازی اعلان‌ها"]}),e.jsx($,{onClick:h,variant:"outline",className:"flex-1",children:"فعلاً نه"})]}),e.jsx("p",{className:"text-xs text-gray-500 text-center mt-4",children:"هر زمان می‌تونید اعلان‌ها رو از تنظیمات غیرفعال کنید"})]})}):null},gp=()=>{const t=Ch(),s=m.useRef(Date.now()),r=5*60*1e3;return m.useEffect(()=>{const a=()=>{if(document.visibilityState==="visible"){const c=Date.now();c-s.current>r?(console.log("PWA Auto-Reload: App became visible, refreshing data..."),t.invalidateQueries(),s.current=c,window.dispatchEvent(new CustomEvent("pwa:reload"))):console.log("PWA Auto-Reload: Too soon to reload, skipping...")}},i=()=>{const c=Date.now();c-s.current>r&&(console.log("PWA Auto-Reload: App focused, refreshing data..."),t.invalidateQueries(),s.current=c,window.dispatchEvent(new CustomEvent("pwa:reload")))},o=c=>{c.persisted&&(console.log("PWA Auto-Reload: Page restored from cache, refreshing data..."),t.invalidateQueries(),s.current=Date.now(),window.dispatchEvent(new CustomEvent("pwa:reload")))};return document.addEventListener("visibilitychange",a),window.addEventListener("focus",i),window.addEventListener("pageshow",o),()=>{document.removeEventListener("visibilitychange",a),window.removeEventListener("focus",i),window.removeEventListener("pageshow",o)}},[t]),{manualReload:()=>{console.log("PWA Auto-Reload: Manual reload triggered"),t.invalidateQueries(),s.current=Date.now(),window.dispatchEvent(new CustomEvent("pwa:reload"))}}},bp=()=>{const[t,s]=m.useState(!1),[r,n]=m.useState(!1),{isLoading:a}=as();return m.useEffect(()=>{const i=()=>{s(!0),n(!0)},o=()=>{s(!1),setTimeout(()=>n(!1),2e3)};return window.addEventListener("pwa:reload",i),t&&!a&&o(),()=>{window.removeEventListener("pwa:reload",i)}},[t,a]),r?e.jsxs("div",{className:"fixed top-4 right-4 z-50 bg-white border border-gray-200 rounded-lg shadow-lg p-3 flex items-center gap-2 text-sm",children:[e.jsx(Pn,{className:`w-4 h-4 text-blue-500 ${t?"animate-spin":""}`}),e.jsx("span",{className:"text-gray-700",children:t?"در حال بروزرسانی...":"بروزرسانی شد ✓"})]}):null},ma=768;function ei(){const[t,s]=m.useState(void 0);return m.useEffect(()=>{const r=window.matchMedia(`(max-width: ${ma-1}px)`),n=()=>{s(window.innerWidth<ma)};return r.addEventListener("change",n),s(window.innerWidth<ma),()=>r.removeEventListener("change",n)},[]),!!t}const yp=()=>{const[t,s]=m.useState(""),[r,n]=m.useState(null),[a,i]=m.useState(!1),[o,c]=m.useState(null),l=m.useCallback(async u=>{if(!u.trim()){n(null);return}i(!0),c(null);try{const h=await fetch(`https://api.mrtrader.net/search/?q=${encodeURIComponent(u)}`);if(!h.ok)throw new Error("خطا در جستجو");const f=await h.json();n(f)}catch(h){c(h instanceof Error?h.message:"خطا در جستجو"),n(null)}finally{i(!1)}},[]);return m.useEffect(()=>{const u=setTimeout(()=>{l(t)},300);return()=>clearTimeout(u)},[t,l]),{query:t,setQuery:s,results:r,isLoading:a,error:o,clearSearch:()=>{s(""),n(null),c(null)}}},Hn=()=>{const[t,s]=m.useState(null),[r,n]=m.useState(!1),[a,i]=m.useState(!1);let o=!1,c=!1,l=!1;try{if(typeof window<"u"){const h=navigator.userAgent.toLowerCase();o=/iphone|ipad|ipod/.test(h),c=/android/.test(h),l=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0||window.matchMedia("(display-mode: fullscreen)").matches}}catch(h){console.error("Error detecting device type:",h)}const d=(o||c)&&!l&&!a;return m.useEffect(()=>{if(!(typeof window>"u"))try{i(l);const h=x=>{console.log("beforeinstallprompt event detected in hook",{platforms:x.platforms,userAgent:navigator.userAgent,timestamp:new Date().toISOString()}),x.preventDefault(),s(x),n(!0),localStorage.setItem("pwa-debug-event",JSON.stringify({timestamp:new Date().toISOString(),platforms:x.platforms,userAgent:navigator.userAgent.substring(0,100)})),window.dispatchEvent(new CustomEvent("pwa-installable",{detail:{deferredPrompt:x}}))},f=()=>{console.log("PWA was installed successfully"),i(!0),n(!1),s(null),localStorage.removeItem("pwa-debug-event"),window.dispatchEvent(new CustomEvent("pwa-installed"))};return window.addEventListener("beforeinstallprompt",h),window.addEventListener("appinstalled",f),()=>{window.removeEventListener("beforeinstallprompt",h),window.removeEventListener("appinstalled",f)}}catch(h){console.error("Error setting up PWA event listeners:",h)}},[l]),{isInstallable:r,isInstalled:a,isIOS:o,isAndroid:c,isStandalone:l,deferredPrompt:t,installApp:async()=>{if(!t){const h="Install prompt is not available. Make sure the site meets PWA requirements and is accessed through a supported browser.";throw console.warn(h),new Error(h)}try{console.log("Attempting to show install prompt..."),await t.prompt();const{outcome:h}=await t.userChoice;console.log("User choice outcome:",h),console.log(h==="accepted"?"User accepted the install prompt":"User dismissed the install prompt"),s(null),n(!1)}catch(h){throw console.error("Error during app installation:",h),new Error(`Installation failed: ${h instanceof Error?h.message:"Unknown error"}`)}},canShowPrompt:d}},Cc=({variant:t="outline",size:s="sm",className:r="",showText:n=!0})=>{const{isInstallable:a,isInstalled:i,installApp:o,isIOS:c,isAndroid:l}=Hn(),{toast:d}=ot(),u=Ze(),h=async()=>{if(c){u("/install");return}if(l){if(a)try{await o(),d({title:"🎉 نصب موفق!",description:"Mr Trader Academy با موفقیت نصب شد",variant:"default"});return}catch{console.log("Auto install failed, showing manual guide")}d({title:"📱 نصب Shortcut",description:"منوی Chrome (⋮) ← 'افزودن به صفحه اصلی'",duration:6e3}),setTimeout(()=>{u("/install")},2e3)}else u("/install")};return i||!c&&!l?null:e.jsxs($,{variant:t,size:s,onClick:h,className:`flex items-center gap-2 ${r}`,children:[c?e.jsx(kr,{className:"w-4 h-4"}):e.jsx(Ha,{className:"w-4 h-4"}),n&&e.jsx("span",{className:"hidden sm:inline",children:c?"راهنمای نصب":"نصب برنامه"})]})},hn=({variant:t="ghost",size:s="sm",showText:r=!1,className:n})=>{const{isSupported:a,permission:i,subscription:o,isLoading:c,subscribe:l,unsubscribe:d,requestPermission:u}=zn();if(!a)return null;const h=async()=>{if(i==="default"){await u();return}i==="granted"&&(o?await d():await l())},f=()=>c?e.jsxs(e.Fragment,{children:[e.jsx(Kt,{className:"h-4 w-4 animate-spin"}),r&&e.jsx("span",{className:"mr-2",children:"در حال پردازش..."})]}):i==="denied"?e.jsxs(e.Fragment,{children:[e.jsx(va,{className:"h-4 w-4 text-muted-foreground"}),r&&e.jsx("span",{className:"mr-2 text-muted-foreground",children:"غیرفعال"})]}):o?e.jsxs(e.Fragment,{children:[e.jsx(ir,{className:"h-4 w-4 text-green-600"}),r&&e.jsx("span",{className:"mr-2",children:"اعلان‌ها فعال"})]}):e.jsxs(e.Fragment,{children:[e.jsx(ir,{className:"h-4 w-4"}),r&&e.jsx("span",{className:"mr-2",children:"فعال‌سازی اعلان‌ها"})]}),x=()=>i==="denied"?"اعلان‌ها غیرفعال - از تنظیمات مرورگر فعال کنید":o?"غیرفعال‌سازی اعلان‌ها":"فعال‌سازی اعلان‌های فوری";return e.jsx($,{variant:t,size:s,onClick:h,disabled:c||i==="denied",title:x(),className:W("transition-all duration-200",o&&"hover:bg-green-50 hover:border-green-200",n),children:f()})},ao=t=>{const s=Math.floor(t/3600),r=Math.floor(t%3600/60);return s>0?`${s}:${r.toString().padStart(2,"0")}`:`${r} دقیقه`},vp=({results:t,onClose:s})=>Array.isArray(t.courses)&&t.courses.length>0||Array.isArray(t.articles)&&t.articles.length>0||Array.isArray(t.videos)&&t.videos.length>0||Array.isArray(t.podcasts)&&t.podcasts.length>0?e.jsxs("div",{className:"absolute top-full left-0 right-0 bg-white border border-gray-200 rounded-lg shadow-lg mt-1 max-h-96 overflow-y-auto z-50",children:[Array.isArray(t.courses)&&t.courses.length>0&&e.jsxs("div",{className:"p-3 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ur,{className:"h-4 w-4 text-trader-600"}),e.jsx("h3",{className:"font-medium text-sm text-gray-900",children:"دوره‌ها"})]}),t.courses.slice(0,3).map(n=>e.jsx(me,{to:`/courses/${n.slug||n.id}`,onClick:s,className:"block p-2 hover:bg-gray-50 rounded-lg mb-1 last:mb-0",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("img",{src:n.thumbnail,alt:n.title,className:"w-12 h-8 object-cover rounded flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-sm text-gray-900 truncate",children:n.title}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mt-1",children:[e.jsx("span",{children:n.instructor_name}),n.rating_avg>0&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Sl,{className:"h-3 w-3 fill-yellow-400 text-yellow-400"}),e.jsx("span",{children:n.rating_avg.toFixed(1)})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Or,{className:"h-3 w-3"}),e.jsx("span",{children:n.student_count})]})]}),e.jsx("div",{className:"text-xs text-trader-600 font-medium mt-1",children:n.is_free?"رایگان":n.price})]})]})},n.id))]}),Array.isArray(t.articles)&&t.articles.length>0&&e.jsxs("div",{className:"p-3 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(_s,{className:"h-4 w-4 text-blue-600"}),e.jsx("h3",{className:"font-medium text-sm text-gray-900",children:"مقالات"})]}),t.articles.slice(0,3).map(n=>e.jsx(me,{to:`/blog/${n.slug||n.id}`,onClick:s,className:"block p-2 hover:bg-gray-50 rounded-lg mb-1 last:mb-0",children:e.jsxs("div",{className:"flex items-start gap-3",children:[n.thumbnail&&e.jsx("img",{src:n.thumbnail,alt:n.title,className:"w-12 h-8 object-cover rounded flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-sm text-gray-900 truncate",children:n.title}),n.excerpt&&e.jsx("p",{className:"text-xs text-gray-500 mt-1 line-clamp-2",children:n.excerpt})]})]})},n.id))]}),Array.isArray(t.videos)&&t.videos.length>0&&e.jsxs("div",{className:"p-3 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Va,{className:"h-4 w-4 text-red-600"}),e.jsx("h3",{className:"font-medium text-sm text-gray-900",children:"ویدیوها"})]}),t.videos.slice(0,3).map(n=>e.jsx(me,{to:`/videos/${n.slug||n.id}`,onClick:s,className:"block p-2 hover:bg-gray-50 rounded-lg mb-1 last:mb-0",children:e.jsxs("div",{className:"flex items-start gap-3",children:[n.thumbnail&&e.jsx("img",{src:n.thumbnail,alt:n.title,className:"w-12 h-8 object-cover rounded flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-sm text-gray-900 truncate",children:n.title}),n.duration&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500 mt-1",children:[e.jsx(Qt,{className:"h-3 w-3"}),e.jsx("span",{children:ao(n.duration)})]})]})]})},n.id))]}),Array.isArray(t.podcasts)&&t.podcasts.length>0&&e.jsxs("div",{className:"p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(zu,{className:"h-4 w-4 text-purple-600"}),e.jsx("h3",{className:"font-medium text-sm text-gray-900",children:"پادکست‌ها"})]}),t.podcasts.slice(0,3).map(n=>e.jsx(me,{to:`/podcasts/${n.slug||n.id}`,onClick:s,className:"block p-2 hover:bg-gray-50 rounded-lg mb-1 last:mb-0",children:e.jsxs("div",{className:"flex items-start gap-3",children:[n.thumbnail&&e.jsx("img",{src:n.thumbnail,alt:n.title,className:"w-12 h-8 object-cover rounded flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-sm text-gray-900 truncate",children:n.title}),n.duration&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500 mt-1",children:[e.jsx(Qt,{className:"h-3 w-3"}),e.jsx("span",{children:ao(n.duration)})]})]})]})},n.id))]})]}):e.jsx("div",{className:"absolute top-full left-0 right-0 bg-white border border-gray-200 rounded-lg shadow-lg mt-1 p-4 z-50",children:e.jsx("p",{className:"text-gray-500 text-center",children:"نتیجه‌ای یافت نشد"})}),jp=()=>{const{user:t}=Oe(),[s,r]=m.useState(!0),[n,a]=m.useState(!1),i=ei(),o=m.useRef(null),{query:c,setQuery:l,results:d,isLoading:u,error:h,clearSearch:f}=yp();m.useEffect(()=>{const b=p=>{o.current&&!o.current.contains(p.target)&&a(!1)};return document.addEventListener("mousedown",b),()=>{document.removeEventListener("mousedown",b)}},[]),m.useEffect(()=>{a(c.length>0&&(d!==null||u))},[c,d,u]);const x=()=>{c.length>0&&a(!0)},g=()=>{r(!1),f(),a(!1)},y=()=>{a(!1)};return e.jsx("header",{className:"bg-white py-3 px-4 sm:px-6 shadow-sm sticky top-0 z-40",children:e.jsx("div",{className:"trader-container",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(me,{to:"/",className:"flex items-center",children:e.jsx("img",{src:"/lovable-uploads/970ac420-2fc4-450d-9177-b465e09c7857.png",alt:"Mr. Trader Academy",className:"h-8 sm:h-10 w-auto"})}),e.jsxs("div",{className:"flex items-center gap-1 sm:gap-3",children:[s?e.jsxs("div",{ref:o,className:"relative w-full max-w-xs flex items-center",children:[e.jsx("input",{type:"text",placeholder:"جستجو...",value:c,onChange:b=>l(b.target.value),onFocus:x,className:"w-full border border-gray-200 rounded-full py-1.5 px-4 pr-10 pl-8 text-sm focus:outline-none focus:ring-2 focus:ring-trader-500"}),u?e.jsx(Kt,{className:"absolute right-3 top-2 h-4 w-4 text-gray-400 animate-spin"}):e.jsx(Rr,{className:"absolute right-3 top-2 h-4 w-4 text-gray-400"}),c&&e.jsx("button",{onClick:g,className:"absolute left-2 top-1.5 p-0.5 text-gray-400 hover:text-gray-600","aria-label":"پاک کردن جستجو",children:e.jsx(Lr,{className:"h-3 w-3"})}),n&&e.jsx(e.Fragment,{children:h?e.jsx("div",{className:"absolute top-full left-0 right-0 bg-white border border-gray-200 rounded-lg shadow-lg mt-1 p-4 z-50",children:e.jsx("p",{className:"text-red-500 text-center text-sm",children:h})}):u?e.jsx("div",{className:"absolute top-full left-0 right-0 bg-white border border-gray-200 rounded-lg shadow-lg mt-1 p-4 z-50",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(Kt,{className:"h-4 w-4 animate-spin text-trader-600"}),e.jsx("span",{className:"text-sm text-gray-600",children:"در حال جستجو..."})]})}):d?e.jsx(vp,{results:d,onClose:y}):null})]}):e.jsx("button",{onClick:()=>r(!0),className:"text-gray-600 p-1.5 rounded-full hover:bg-gray-100","aria-label":"جستجو",children:e.jsx(Rr,{className:"h-5 w-5"})}),!i&&e.jsx(hn,{variant:"ghost",size:"sm",showText:!1}),e.jsx(Cc,{variant:"ghost",size:"sm",showText:!1}),t?e.jsx("div",{className:"flex items-center gap-1 sm:gap-3",children:e.jsx(me,{to:"/profile",className:"flex items-center",children:e.jsx("div",{className:"relative w-8 h-8 rounded-full overflow-hidden",children:e.jsx("img",{src:t.avatar,alt:t.name,className:"w-full h-full object-cover"})})})}):e.jsx(me,{to:"/login",className:"flex items-center p-1.5 rounded-full hover:bg-gray-100 text-gray-600","aria-label":"ورود",children:e.jsx(vs,{className:"h-5 w-5"})})]})]})})})},Np=()=>{const t=dr(),s=r=>t.pathname===r;return e.jsx("nav",{className:"fixed bottom-0 left-0 right-0 bg-white shadow-[0_-2px_10px_rgba(0,0,0,0.1)] h-16 z-50",children:e.jsxs("div",{className:"grid grid-cols-5 h-full",children:[e.jsxs(me,{to:"/",className:W("flex flex-col items-center justify-center text-xs min-h-[44px]",s("/")?"text-trader-500":"text-gray-500"),children:[e.jsx(Fu,{className:"h-5 w-5 mb-1"}),e.jsx("span",{children:"خانه"})]}),e.jsxs(me,{to:"/content",className:W("flex flex-col items-center justify-center text-xs min-h-[44px]",s("/content")?"text-trader-500":"text-gray-500"),children:[e.jsx(_s,{className:"h-5 w-5 mb-1"}),e.jsx("span",{children:"محتوا"})]}),e.jsxs(me,{to:"/my-courses",className:W("flex flex-col items-center justify-center text-xs min-h-[44px]",s("/my-courses")?"text-trader-500":"text-gray-500"),children:[e.jsx(Va,{className:"h-5 w-5 mb-1"}),e.jsx("span",{children:"دوره‌های من"})]}),e.jsxs(me,{to:"/bookmarks",className:W("flex flex-col items-center justify-center text-xs min-h-[44px]",s("/bookmarks")?"text-trader-500":"text-gray-500"),children:[e.jsx(Ps,{className:"h-5 w-5 mb-1"}),e.jsx("span",{children:"نشان‌ها"})]}),e.jsxs(me,{to:"/profile",className:W("flex flex-col items-center justify-center text-xs min-h-[44px]",s("/profile")?"text-trader-500":"text-gray-500"),children:[e.jsx(vs,{className:"h-5 w-5 mb-1"}),e.jsx("span",{children:"پروفایل"})]})]})})},wp=(t={})=>{const{enabled:s=!0,visitThreshold:r=2,excludePaths:n=["/install","/login","/test/","/debug/"],delay:a=5e3}=t,{isInstalled:i,isStandalone:o,isIOS:c,isAndroid:l,canShowPrompt:d}=Hn(),u=Ze(),h=dr();return m.useEffect(()=>{if(!s||i||o||!c&&!l)return;const g=h.pathname;if(n.some(N=>N.endsWith("/")?g.startsWith(N):g===N))return;const b=localStorage.getItem("app-install-skipped"),p=parseInt(localStorage.getItem("app-visit-count")||"0"),j=localStorage.getItem("last-install-redirect");if(b){const N=parseInt(b);if((Date.now()-N)/(1e3*60*60)<24)return;localStorage.removeItem("app-install-skipped")}if(j){const N=parseInt(j);if((Date.now()-N)/(1e3*60*60)<2)return}const v=p+1;if(localStorage.setItem("app-visit-count",v.toString()),v<r)return;const w=setTimeout(()=>{if(!localStorage.getItem("app-install-skipped")){if(l&&!d){const k=setTimeout(()=>{localStorage.getItem("app-install-skipped")||(localStorage.setItem("last-install-redirect",Date.now().toString()),u("/install"))},3e3);return()=>clearTimeout(k)}localStorage.setItem("last-install-redirect",Date.now().toString()),u("/install")}},a);return()=>clearTimeout(w)},[s,r,n,a,i,o,c,l,h.pathname,u]),{resetCounters:()=>{localStorage.removeItem("app-visit-count"),localStorage.removeItem("app-install-skipped"),localStorage.removeItem("last-install-redirect")},forceRedirect:()=>{u("/install")},visitCount:parseInt(localStorage.getItem("app-visit-count")||"0"),hasSkipped:!!localStorage.getItem("app-install-skipped"),canRedirect:s&&!i&&!o&&(c||l)}},ne=m.forwardRef(({className:t,...s},r)=>e.jsx("div",{ref:r,className:W("rounded-lg border bg-card text-card-foreground shadow-sm",t),...s}));ne.displayName="Card";const Ie=m.forwardRef(({className:t,...s},r)=>e.jsx("div",{ref:r,className:W("flex flex-col space-y-1.5 p-6",t),...s}));Ie.displayName="CardHeader";const Re=m.forwardRef(({className:t,...s},r)=>e.jsx("h3",{ref:r,className:W("text-2xl font-semibold leading-none tracking-tight",t),...s}));Re.displayName="CardTitle";const Ys=m.forwardRef(({className:t,...s},r)=>e.jsx("p",{ref:r,className:W("text-sm text-muted-foreground",t),...s}));Ys.displayName="CardDescription";const ae=m.forwardRef(({className:t,...s},r)=>e.jsx("div",{ref:r,className:W("p-6 pt-0",t),...s}));ae.displayName="CardContent";const Sp=m.forwardRef(({className:t,...s},r)=>e.jsx("div",{ref:r,className:W("flex items-center p-6 pt-0",t),...s}));Sp.displayName="CardFooter";class Qr extends m.Component{constructor(r){super(r);Fs(this,"handleReload",()=>{window.location.reload()});Fs(this,"handleReset",()=>{this.setState({hasError:!1,error:void 0,errorInfo:void 0})});this.state={hasError:!1}}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,n){this.setState({errorInfo:n}),console.error("ErrorBoundary caught an error:",r,n)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4 bg-gray-50",children:e.jsxs(ne,{className:"w-full max-w-md",children:[e.jsxs(Ie,{className:"text-center",children:[e.jsx(Qs,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),e.jsx(Re,{className:"text-lg text-red-600",children:"خطایی رخ داده است"})]}),e.jsxs(ae,{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-600 text-center",children:"متأسفانه مشکلی در نمایش این بخش به وجود آمده است."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx($,{onClick:this.handleReset,variant:"outline",className:"flex-1",children:"تلاش مجدد"}),e.jsxs($,{onClick:this.handleReload,className:"flex-1",children:[e.jsx(Pn,{className:"w-4 h-4 ml-1"}),"بارگیری مجدد"]})]}),!1]})]})}):this.props.children}}const de=({children:t,fullWidth:s=!1,initialLoading:r=!1})=>{const n=ei(),[a,i]=m.useState(r),[o,c]=m.useState(!1);wp({enabled:!0,visitThreshold:1,delay:4e3,excludePaths:["/install","/login","/test/","/debug/","/pwa-test"]});const[l,d]=m.useState({isFirefox:!1,isSafari:!1,isIE:!1,isEdge:!1});return m.useEffect(()=>{c(!0);const u=window.navigator.userAgent.toLowerCase();if(d({isFirefox:u.indexOf("firefox")>-1,isSafari:u.indexOf("safari")>-1&&u.indexOf("chrome")===-1,isIE:u.indexOf("trident")>-1,isEdge:u.indexOf("edge")>-1||u.indexOf("edg/")>-1}),r){const h=setTimeout(()=>{i(!1)},800);return()=>clearTimeout(h)}},[r]),m.useEffect(()=>(n&&(document.documentElement.classList.add("touch-device"),document.querySelectorAll("button, a, input, select, textarea").forEach(h=>{h.classList.add("touch-target"),h.addEventListener("touchstart",()=>{h.classList.add("touch-active")},{passive:!0}),h.addEventListener("touchend",()=>{h.classList.remove("touch-active")},{passive:!0})})),()=>{document.documentElement.classList.remove("touch-device"),document.querySelectorAll(".touch-target").forEach(h=>{h.classList.remove("touch-target","touch-active")})}),[n]),m.useEffect(()=>(l.isFirefox&&document.documentElement.classList.add("firefox"),l.isSafari&&document.documentElement.classList.add("safari"),(l.isIE||l.isEdge)&&document.documentElement.classList.add("ms-browser"),()=>{document.documentElement.classList.remove("firefox","safari","ms-browser")}),[l]),e.jsx(Qr,{children:e.jsxs("div",{className:`flex flex-col min-h-screen bg-gray-50 ${l.isSafari?"safari-flex-fix":""}`,dir:"rtl",children:[e.jsx(jp,{}),e.jsx("main",{className:`flex-1 pb-20 px-4 sm:px-6 ${!s&&"max-w-7xl mx-auto w-full"}`,children:a?e.jsxs("div",{className:"flex flex-col items-center justify-center h-[50vh]",children:[e.jsx(bs,{className:"h-12 w-12 text-trader-500 animate-spin mb-4"}),e.jsx("p",{className:"text-lg font-medium text-gray-600",children:"در حال بارگیری..."})]}):e.jsx("div",{className:o?"page-transition":"",children:t})}),n&&e.jsx(Np,{}),e.jsx(Sc,{})]})})},io=ka.PLACEHOLDER_CONTENT,cs=U.memo(({id:t,title:s,description:r,thumbnail:n,type:a,date:i,author:o,duration:c,fileSize:l,fileType:d,className:u})=>{const h=String(t),f=U.useCallback(()=>{switch(a){case"article":return`/articles/${h}`;case"podcast":return`/podcasts/${h}`;case"video":return`/videos/${h}`;case"webinar":return`/webinars/${h}`;case"livestream":return`/livestreams/${h}`;case"file":return`/files/${h}`;default:return"#"}},[a,h]),x=U.useCallback(()=>{switch(a){case"article":return"مقاله";case"podcast":return"پادکست";case"video":return"ویدیو";case"webinar":return"وبینار";case"livestream":return"لایو";case"file":return"فایل";default:return a}},[a]),g=U.useCallback(()=>{switch(a){case"article":return"bg-blue-500";case"podcast":return"bg-purple-500";case"video":return"bg-trader-500";case"webinar":return"bg-green-500";case"livestream":return"bg-red-500";case"file":return"bg-gray-500";default:return"bg-gray-500"}},[a]),y=U.useCallback(p=>{if(!p)return"";try{return/^\d{4}-\d{2}-\d{2}$/.test(p)?p:p.includes("T")||p.includes(" ")?p.split("T")[0].split(" ")[0]:p}catch{return p}},[]),b=U.useCallback(p=>{const j=p.target;j.src=io},[]);return e.jsx(me,{to:f(),className:W("block",u),children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow duration-300 h-full min-h-[220px] sm:min-h-[280px] flex flex-col",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:n||io,alt:s,className:"w-full h-28 sm:h-36 object-contain rounded-t-lg bg-gray-50",onError:b,loading:"lazy"}),e.jsx("div",{className:W("absolute top-2 left-2 px-2 py-1 text-xs text-white rounded-full",g()),children:x()})]}),e.jsxs("div",{className:"p-3 sm:p-4 flex-1 flex flex-col",children:[e.jsx("h3",{className:"text-sm sm:text-base font-semibold mb-2 line-clamp-2 min-h-[2.5rem] sm:min-h-[3rem]",children:s}),r&&e.jsx("p",{className:"text-gray-600 text-xs sm:text-sm mb-3 sm:mb-4 line-clamp-2 flex-1",children:r}),e.jsx("div",{className:"flex items-center text-xs sm:text-sm text-gray-500 gap-2 sm:gap-4 mt-auto",children:i&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Tn,{className:"w-3 h-3 sm:w-4 sm:h-4"}),e.jsx("span",{className:"text-xs",children:y(i)})]})})]})]})})},(t,s)=>t.id===s.id&&t.title===s.title&&t.thumbnail===s.thumbnail&&t.type===s.type&&t.date===s.date&&t.author===s.author&&t.duration===s.duration);cs.displayName="ContentCard";function Be({className:t,...s}){return e.jsx("div",{className:W("animate-pulse rounded-md bg-muted",t),...s})}const Oa=({className:t})=>e.jsxs("div",{className:W("trader-card flex flex-col h-full overflow-hidden",t),children:[e.jsx(Be,{className:"w-full h-48 min-h-[120px]"}),e.jsxs("div",{className:"w-full p-4 flex flex-col relative flex-grow",children:[e.jsx(Be,{className:"h-6 w-3/4 mb-2"}),e.jsx(Be,{className:"h-4 w-full mb-2"}),e.jsx(Be,{className:"h-4 w-5/6 mb-3"}),e.jsxs("div",{className:"flex items-center justify-between mt-auto pt-2 border-t border-gray-100",children:[e.jsx(Be,{className:"h-3 w-1/4"}),e.jsx(Be,{className:"h-3 w-1/4"})]})]})]});function Cp(t){return Object.prototype.toString.call(t)==="[object Object]"}function oo(t){return Cp(t)||Array.isArray(t)}function Ep(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function ti(t,s){const r=Object.keys(t),n=Object.keys(s);if(r.length!==n.length)return!1;const a=JSON.stringify(Object.keys(t.breakpoints||{})),i=JSON.stringify(Object.keys(s.breakpoints||{}));return a!==i?!1:r.every(o=>{const c=t[o],l=s[o];return typeof c=="function"?`${c}`==`${l}`:!oo(c)||!oo(l)?c===l:ti(c,l)})}function lo(t){return t.concat().sort((s,r)=>s.name>r.name?1:-1).map(s=>s.options)}function kp(t,s){if(t.length!==s.length)return!1;const r=lo(t),n=lo(s);return r.every((a,i)=>{const o=n[i];return ti(a,o)})}function si(t){return typeof t=="number"}function La(t){return typeof t=="string"}function qn(t){return typeof t=="boolean"}function co(t){return Object.prototype.toString.call(t)==="[object Object]"}function De(t){return Math.abs(t)}function ri(t){return Math.sign(t)}function Ar(t,s){return De(t-s)}function Tp(t,s){if(t===0||s===0||De(t)<=De(s))return 0;const r=Ar(De(t),De(s));return De(r/t)}function Pp(t){return Math.round(t*100)/100}function Fr(t){return Br(t).map(Number)}function Dt(t){return t[Yr(t)]}function Yr(t){return Math.max(0,t.length-1)}function ni(t,s){return s===Yr(t)}function uo(t,s=0){return Array.from(Array(t),(r,n)=>s+n)}function Br(t){return Object.keys(t)}function Ec(t,s){return[t,s].reduce((r,n)=>(Br(n).forEach(a=>{const i=r[a],o=n[a],c=co(i)&&co(o);r[a]=c?Ec(i,o):o}),r),{})}function Ma(t,s){return typeof s.MouseEvent<"u"&&t instanceof s.MouseEvent}function Ap(t,s){const r={start:n,center:a,end:i};function n(){return 0}function a(l){return i(l)/2}function i(l){return s-l}function o(l,d){return La(t)?r[t](l):t(s,l,d)}return{measure:o}}function Ur(){let t=[];function s(a,i,o,c={passive:!0}){let l;if("addEventListener"in a)a.addEventListener(i,o,c),l=()=>a.removeEventListener(i,o,c);else{const d=a;d.addListener(o),l=()=>d.removeListener(o)}return t.push(l),n}function r(){t=t.filter(a=>a())}const n={add:s,clear:r};return n}function _p(t,s,r,n){const a=Ur(),i=1e3/60;let o=null,c=0,l=0;function d(){a.add(t,"visibilitychange",()=>{t.hidden&&g()})}function u(){x(),a.clear()}function h(b){if(!l)return;o||(o=b,r(),r());const p=b-o;for(o=b,c+=p;c>=i;)r(),c-=i;const j=c/i;n(j),l&&(l=s.requestAnimationFrame(h))}function f(){l||(l=s.requestAnimationFrame(h))}function x(){s.cancelAnimationFrame(l),o=null,c=0,l=0}function g(){o=null,c=0}return{init:d,destroy:u,start:f,stop:x,update:r,render:n}}function Ip(t,s){const r=s==="rtl",n=t==="y",a=n?"y":"x",i=n?"x":"y",o=!n&&r?-1:1,c=u(),l=h();function d(g){const{height:y,width:b}=g;return n?y:b}function u(){return n?"top":r?"right":"left"}function h(){return n?"bottom":r?"left":"right"}function f(g){return g*o}return{scroll:a,cross:i,startEdge:c,endEdge:l,measureSize:d,direction:f}}function Os(t=0,s=0){const r=De(t-s);function n(d){return d<t}function a(d){return d>s}function i(d){return n(d)||a(d)}function o(d){return i(d)?n(d)?t:s:d}function c(d){return r?d-r*Math.ceil((d-s)/r):d}return{length:r,max:s,min:t,constrain:o,reachedAny:i,reachedMax:a,reachedMin:n,removeOffset:c}}function kc(t,s,r){const{constrain:n}=Os(0,t),a=t+1;let i=o(s);function o(f){return r?De((a+f)%a):n(f)}function c(){return i}function l(f){return i=o(f),h}function d(f){return u().set(c()+f)}function u(){return kc(t,c(),r)}const h={get:c,set:l,add:d,clone:u};return h}function Rp(t,s,r,n,a,i,o,c,l,d,u,h,f,x,g,y,b,p,j){const{cross:v,direction:w}=t,N=["INPUT","SELECT","TEXTAREA"],k={passive:!1},S=Ur(),E=Ur(),A=Os(50,225).constrain(x.measure(20)),z={mouse:300,touch:400},D={mouse:500,touch:600},T=g?43:25;let R=!1,F=0,Z=0,B=!1,Y=!1,I=!1,P=!1;function _(Q){if(!j)return;function xe(ee){(qn(j)||j(Q,ee))&&ze(ee)}const G=s;S.add(G,"dragstart",ee=>ee.preventDefault(),k).add(G,"touchmove",()=>{},k).add(G,"touchend",()=>{}).add(G,"touchstart",xe).add(G,"mousedown",xe).add(G,"touchcancel",Ae).add(G,"contextmenu",Ae).add(G,"click",He,!0)}function L(){S.clear(),E.clear()}function q(){const Q=P?r:s;E.add(Q,"touchmove",ie,k).add(Q,"touchend",Ae).add(Q,"mousemove",ie,k).add(Q,"mouseup",Ae)}function V(Q){const xe=Q.nodeName||"";return N.includes(xe)}function K(){return(g?D:z)[P?"mouse":"touch"]}function se(Q,xe){const G=h.add(ri(Q)*-1),ee=u.byDistance(Q,!g).distance;return g||De(Q)<A?ee:b&&xe?ee*.5:u.byIndex(G.get(),0).distance}function ze(Q){const xe=Ma(Q,n);P=xe,I=g&&xe&&!Q.buttons&&R,R=Ar(a.get(),o.get())>=2,!(xe&&Q.button!==0)&&(V(Q.target)||(B=!0,i.pointerDown(Q),d.useFriction(0).useDuration(0),a.set(o),q(),F=i.readPoint(Q),Z=i.readPoint(Q,v),f.emit("pointerDown")))}function ie(Q){if(!Ma(Q,n)&&Q.touches.length>=2)return Ae(Q);const G=i.readPoint(Q),ee=i.readPoint(Q,v),ye=Ar(G,F),Ne=Ar(ee,Z);if(!Y&&!P&&(!Q.cancelable||(Y=ye>Ne,!Y)))return Ae(Q);const Se=i.pointerMove(Q);ye>y&&(I=!0),d.useFriction(.3).useDuration(.75),c.start(),a.add(w(Se)),Q.preventDefault()}function Ae(Q){const G=u.byDistance(0,!1).index!==h.get(),ee=i.pointerUp(Q)*K(),ye=se(w(ee),G),Ne=Tp(ee,ye),Se=T-10*Ne,ue=p+Ne/50;Y=!1,B=!1,E.clear(),d.useDuration(Se).useFriction(ue),l.distance(ye,!g),P=!1,f.emit("pointerUp")}function He(Q){I&&(Q.stopPropagation(),Q.preventDefault(),I=!1)}function Le(){return B}return{init:_,destroy:L,pointerDown:Le}}function Op(t,s){let n,a;function i(h){return h.timeStamp}function o(h,f){const g=`client${(f||t.scroll)==="x"?"X":"Y"}`;return(Ma(h,s)?h:h.touches[0])[g]}function c(h){return n=h,a=h,o(h)}function l(h){const f=o(h)-o(a),x=i(h)-i(n)>170;return a=h,x&&(n=h),f}function d(h){if(!n||!a)return 0;const f=o(a)-o(n),x=i(h)-i(n),g=i(h)-i(a)>170,y=f/x;return x&&!g&&De(y)>.1?y:0}return{pointerDown:c,pointerMove:l,pointerUp:d,readPoint:o}}function Lp(){function t(r){const{offsetTop:n,offsetLeft:a,offsetWidth:i,offsetHeight:o}=r;return{top:n,right:a+i,bottom:n+o,left:a,width:i,height:o}}return{measure:t}}function Mp(t){function s(n){return t*(n/100)}return{measure:s}}function Dp(t,s,r,n,a,i,o){const c=[t].concat(n);let l,d,u=[],h=!1;function f(b){return a.measureSize(o.measure(b))}function x(b){if(!i)return;d=f(t),u=n.map(f);function p(j){for(const v of j){if(h)return;const w=v.target===t,N=n.indexOf(v.target),k=w?d:u[N],S=f(w?t:n[N]);if(De(S-k)>=.5){b.reInit(),s.emit("resize");break}}}l=new ResizeObserver(j=>{(qn(i)||i(b,j))&&p(j)}),r.requestAnimationFrame(()=>{c.forEach(j=>l.observe(j))})}function g(){h=!0,l&&l.disconnect()}return{init:x,destroy:g}}function $p(t,s,r,n,a,i){let o=0,c=0,l=a,d=i,u=t.get(),h=0;function f(){const k=n.get()-t.get(),S=!l;let E=0;return S?(o=0,r.set(n),t.set(n),E=k):(r.set(t),o+=k/l,o*=d,u+=o,t.add(o),E=u-h),c=ri(E),h=u,N}function x(){const k=n.get()-s.get();return De(k)<.001}function g(){return l}function y(){return c}function b(){return o}function p(){return v(a)}function j(){return w(i)}function v(k){return l=k,N}function w(k){return d=k,N}const N={direction:y,duration:g,velocity:b,seek:f,settled:x,useBaseFriction:j,useBaseDuration:p,useFriction:w,useDuration:v};return N}function Fp(t,s,r,n,a){const i=a.measure(10),o=a.measure(50),c=Os(.1,.99);let l=!1;function d(){return!(l||!t.reachedAny(r.get())||!t.reachedAny(s.get()))}function u(x){if(!d())return;const g=t.reachedMin(s.get())?"min":"max",y=De(t[g]-s.get()),b=r.get()-s.get(),p=c.constrain(y/o);r.subtract(b*p),!x&&De(b)<i&&(r.set(t.constrain(r.get())),n.useDuration(25).useBaseFriction())}function h(x){l=!x}return{shouldConstrain:d,constrain:u,toggleActive:h}}function Bp(t,s,r,n,a){const i=Os(-s+t,0),o=h(),c=u(),l=f();function d(g,y){return Ar(g,y)<=1}function u(){const g=o[0],y=Dt(o),b=o.lastIndexOf(g),p=o.indexOf(y)+1;return Os(b,p)}function h(){return r.map((g,y)=>{const{min:b,max:p}=i,j=i.constrain(g),v=!y,w=ni(r,y);return v?p:w||d(b,j)?b:d(p,j)?p:j}).map(g=>parseFloat(g.toFixed(3)))}function f(){if(s<=t+a)return[i.max];if(n==="keepSnaps")return o;const{min:g,max:y}=c;return o.slice(g,y)}return{snapsContained:l,scrollContainLimit:c}}function Up(t,s,r){const n=s[0],a=r?n-t:Dt(s);return{limit:Os(a,n)}}function zp(t,s,r,n){const i=s.min+.1,o=s.max+.1,{reachedMin:c,reachedMax:l}=Os(i,o);function d(f){return f===1?l(r.get()):f===-1?c(r.get()):!1}function u(f){if(!d(f))return;const x=t*(f*-1);n.forEach(g=>g.add(x))}return{loop:u}}function Hp(t){const{max:s,length:r}=t;function n(i){const o=i-s;return r?o/-r:0}return{get:n}}function qp(t,s,r,n,a){const{startEdge:i,endEdge:o}=t,{groupSlides:c}=a,l=h().map(s.measure),d=f(),u=x();function h(){return c(n).map(y=>Dt(y)[o]-y[0][i]).map(De)}function f(){return n.map(y=>r[i]-y[i]).map(y=>-De(y))}function x(){return c(d).map(y=>y[0]).map((y,b)=>y+l[b])}return{snaps:d,snapsAligned:u}}function Wp(t,s,r,n,a,i){const{groupSlides:o}=a,{min:c,max:l}=n,d=u();function u(){const f=o(i),x=!t||s==="keepSnaps";return r.length===1?[i]:x?f:f.slice(c,l).map((g,y,b)=>{const p=!y,j=ni(b,y);if(p){const v=Dt(b[0])+1;return uo(v)}if(j){const v=Yr(i)-Dt(b)[0]+1;return uo(v,Dt(b)[0])}return g})}return{slideRegistry:d}}function Vp(t,s,r,n,a){const{reachedAny:i,removeOffset:o,constrain:c}=n;function l(g){return g.concat().sort((y,b)=>De(y)-De(b))[0]}function d(g){const y=t?o(g):c(g),b=s.map((j,v)=>({diff:u(j-y,0),index:v})).sort((j,v)=>De(j.diff)-De(v.diff)),{index:p}=b[0];return{index:p,distance:y}}function u(g,y){const b=[g,g+r,g-r];if(!t)return g;if(!y)return l(b);const p=b.filter(j=>ri(j)===y);return p.length?l(p):Dt(b)-r}function h(g,y){const b=s[g]-a.get(),p=u(b,y);return{index:g,distance:p}}function f(g,y){const b=a.get()+g,{index:p,distance:j}=d(b),v=!t&&i(b);if(!y||v)return{index:p,distance:g};const w=s[p]-j,N=g+u(w,0);return{index:p,distance:N}}return{byDistance:f,byIndex:h,shortcut:u}}function Gp(t,s,r,n,a,i,o){function c(h){const f=h.distance,x=h.index!==s.get();i.add(f),f&&(n.duration()?t.start():(t.update(),t.render(1),t.update())),x&&(r.set(s.get()),s.set(h.index),o.emit("select"))}function l(h,f){const x=a.byDistance(h,f);c(x)}function d(h,f){const x=s.clone().set(h),g=a.byIndex(x.get(),f);c(g)}return{distance:l,index:d}}function Kp(t,s,r,n,a,i,o,c){const l={passive:!0,capture:!0};let d=0;function u(x){if(!c)return;function g(y){if(new Date().getTime()-d>10)return;o.emit("slideFocusStart"),t.scrollLeft=0;const j=r.findIndex(v=>v.includes(y));si(j)&&(a.useDuration(0),n.index(j,0),o.emit("slideFocus"))}i.add(document,"keydown",h,!1),s.forEach((y,b)=>{i.add(y,"focus",p=>{(qn(c)||c(x,p))&&g(b)},l)})}function h(x){x.code==="Tab"&&(d=new Date().getTime())}return{init:u}}function Sr(t){let s=t;function r(){return s}function n(l){s=o(l)}function a(l){s+=o(l)}function i(l){s-=o(l)}function o(l){return si(l)?l:l.get()}return{get:r,set:n,add:a,subtract:i}}function Tc(t,s){const r=t.scroll==="x"?o:c,n=s.style;let a=null,i=!1;function o(f){return`translate3d(${f}px,0px,0px)`}function c(f){return`translate3d(0px,${f}px,0px)`}function l(f){if(i)return;const x=Pp(t.direction(f));x!==a&&(n.transform=r(x),a=x)}function d(f){i=!f}function u(){i||(n.transform="",s.getAttribute("style")||s.removeAttribute("style"))}return{clear:u,to:l,toggleActive:d}}function Qp(t,s,r,n,a,i,o,c,l){const u=Fr(a),h=Fr(a).reverse(),f=p().concat(j());function x(S,E){return S.reduce((A,z)=>A-a[z],E)}function g(S,E){return S.reduce((A,z)=>x(A,E)>0?A.concat([z]):A,[])}function y(S){return i.map((E,A)=>({start:E-n[A]+.5+S,end:E+s-.5+S}))}function b(S,E,A){const z=y(E);return S.map(D=>{const T=A?0:-r,R=A?r:0,F=A?"end":"start",Z=z[D][F];return{index:D,loopPoint:Z,slideLocation:Sr(-1),translate:Tc(t,l[D]),target:()=>c.get()>Z?T:R}})}function p(){const S=o[0],E=g(h,S);return b(E,r,!1)}function j(){const S=s-o[0]-1,E=g(u,S);return b(E,-r,!0)}function v(){return f.every(({index:S})=>{const E=u.filter(A=>A!==S);return x(E,s)<=.1})}function w(){f.forEach(S=>{const{target:E,translate:A,slideLocation:z}=S,D=E();D!==z.get()&&(A.to(D),z.set(D))})}function N(){f.forEach(S=>S.translate.clear())}return{canLoop:v,clear:N,loop:w,loopPoints:f}}function Yp(t,s,r){let n,a=!1;function i(l){if(!r)return;function d(u){for(const h of u)if(h.type==="childList"){l.reInit(),s.emit("slidesChanged");break}}n=new MutationObserver(u=>{a||(qn(r)||r(l,u))&&d(u)}),n.observe(t,{childList:!0})}function o(){n&&n.disconnect(),a=!0}return{init:i,destroy:o}}function Jp(t,s,r,n){const a={};let i=null,o=null,c,l=!1;function d(){c=new IntersectionObserver(g=>{l||(g.forEach(y=>{const b=s.indexOf(y.target);a[b]=y}),i=null,o=null,r.emit("slidesInView"))},{root:t.parentElement,threshold:n}),s.forEach(g=>c.observe(g))}function u(){c&&c.disconnect(),l=!0}function h(g){return Br(a).reduce((y,b)=>{const p=parseInt(b),{isIntersecting:j}=a[p];return(g&&j||!g&&!j)&&y.push(p),y},[])}function f(g=!0){if(g&&i)return i;if(!g&&o)return o;const y=h(g);return g&&(i=y),g||(o=y),y}return{init:d,destroy:u,get:f}}function Xp(t,s,r,n,a,i){const{measureSize:o,startEdge:c,endEdge:l}=t,d=r[0]&&a,u=g(),h=y(),f=r.map(o),x=b();function g(){if(!d)return 0;const j=r[0];return De(s[c]-j[c])}function y(){if(!d)return 0;const j=i.getComputedStyle(Dt(n));return parseFloat(j.getPropertyValue(`margin-${l}`))}function b(){return r.map((j,v,w)=>{const N=!v,k=ni(w,v);return N?f[v]+u:k?f[v]+h:w[v+1][c]-j[c]}).map(De)}return{slideSizes:f,slideSizesWithGaps:x,startGap:u,endGap:h}}function Zp(t,s,r,n,a,i,o,c,l){const{startEdge:d,endEdge:u,direction:h}=t,f=si(r);function x(p,j){return Fr(p).filter(v=>v%j===0).map(v=>p.slice(v,v+j))}function g(p){return p.length?Fr(p).reduce((j,v,w)=>{const N=Dt(j)||0,k=N===0,S=v===Yr(p),E=a[d]-i[N][d],A=a[d]-i[v][u],z=!n&&k?h(o):0,D=!n&&S?h(c):0,T=De(A-D-(E+z));return w&&T>s+l&&j.push(v),S&&j.push(p.length),j},[]).map((j,v,w)=>{const N=Math.max(w[v-1]||0);return p.slice(N,j)}):[]}function y(p){return f?x(p,r):g(p)}return{groupSlides:y}}function ex(t,s,r,n,a,i,o){const{align:c,axis:l,direction:d,startIndex:u,loop:h,duration:f,dragFree:x,dragThreshold:g,inViewThreshold:y,slidesToScroll:b,skipSnaps:p,containScroll:j,watchResize:v,watchSlides:w,watchDrag:N,watchFocus:k}=i,S=2,E=Lp(),A=E.measure(s),z=r.map(E.measure),D=Ip(l,d),T=D.measureSize(A),R=Mp(T),F=Ap(c,T),Z=!h&&!!j,B=h||!!j,{slideSizes:Y,slideSizesWithGaps:I,startGap:P,endGap:_}=Xp(D,A,z,r,B,a),L=Zp(D,T,b,h,A,z,P,_,S),{snaps:q,snapsAligned:V}=qp(D,F,A,z,L),K=-Dt(q)+Dt(I),{snapsContained:se,scrollContainLimit:ze}=Bp(T,K,V,j,S),ie=Z?se:V,{limit:Ae}=Up(K,ie,h),He=kc(Yr(ie),u,h),Le=He.clone(),ge=Fr(r),Q=({dragHandler:et,scrollBody:Bt,scrollBounds:vt,options:{loop:qe}})=>{qe||vt.constrain(et.pointerDown()),Bt.seek()},xe=({scrollBody:et,translate:Bt,location:vt,offsetLocation:qe,previousLocation:$e,scrollLooper:jt,slideLooper:Ct,dragHandler:Ns,animation:fr,eventHandler:Ut,scrollBounds:Xt,options:{loop:Ds}},Et)=>{const Nt=et.settled(),pr=!Xt.shouldConstrain(),X=Ds?Nt:Nt&&pr,he=X&&!Ns.pointerDown();he&&fr.stop();const Ce=vt.get()*Et+$e.get()*(1-Et);qe.set(Ce),Ds&&(jt.loop(et.direction()),Ct.loop()),Bt.to(qe.get()),he&&Ut.emit("settle"),X||Ut.emit("scroll")},G=_p(n,a,()=>Q(Pt),et=>xe(Pt,et)),ee=.68,ye=ie[He.get()],Ne=Sr(ye),Se=Sr(ye),ue=Sr(ye),ke=Sr(ye),Qe=$p(Ne,ue,Se,ke,f,ee),We=Vp(h,ie,K,Ae,ke),Me=Gp(G,He,Le,Qe,We,ke,o),Ve=Hp(Ae),Ge=Ur(),we=Jp(s,r,o,y),{slideRegistry:Ke}=Wp(Z,j,ie,ze,L,ge),Jt=Kp(t,r,Ke,Me,Qe,Ge,o,k),Pt={ownerDocument:n,ownerWindow:a,eventHandler:o,containerRect:A,slideRects:z,animation:G,axis:D,dragHandler:Rp(D,t,n,a,ke,Op(D,a),Ne,G,Me,Qe,We,He,o,R,x,g,p,ee,N),eventStore:Ge,percentOfView:R,index:He,indexPrevious:Le,limit:Ae,location:Ne,offsetLocation:ue,previousLocation:Se,options:i,resizeHandler:Dp(s,o,a,r,D,v,E),scrollBody:Qe,scrollBounds:Fp(Ae,ue,ke,Qe,R),scrollLooper:zp(K,Ae,ue,[Ne,ue,Se,ke]),scrollProgress:Ve,scrollSnapList:ie.map(Ve.get),scrollSnaps:ie,scrollTarget:We,scrollTo:Me,slideLooper:Qp(D,T,K,Y,I,q,ie,ue,r),slideFocus:Jt,slidesHandler:Yp(s,o,w),slidesInView:we,slideIndexes:ge,slideRegistry:Ke,slidesToScroll:L,target:ke,translate:Tc(D,s)};return Pt}function tx(){let t={},s;function r(d){s=d}function n(d){return t[d]||[]}function a(d){return n(d).forEach(u=>u(s,d)),l}function i(d,u){return t[d]=n(d).concat([u]),l}function o(d,u){return t[d]=n(d).filter(h=>h!==u),l}function c(){t={}}const l={init:r,emit:a,off:o,on:i,clear:c};return l}const sx={align:"center",axis:"x",container:null,slides:null,containScroll:"trimSnaps",direction:"ltr",slidesToScroll:1,inViewThreshold:0,breakpoints:{},dragFree:!1,dragThreshold:10,loop:!1,skipSnaps:!1,duration:25,startIndex:0,active:!0,watchDrag:!0,watchResize:!0,watchSlides:!0,watchFocus:!0};function rx(t){function s(i,o){return Ec(i,o||{})}function r(i){const o=i.breakpoints||{},c=Br(o).filter(l=>t.matchMedia(l).matches).map(l=>o[l]).reduce((l,d)=>s(l,d),{});return s(i,c)}function n(i){return i.map(o=>Br(o.breakpoints||{})).reduce((o,c)=>o.concat(c),[]).map(t.matchMedia)}return{mergeOptions:s,optionsAtMedia:r,optionsMediaQueries:n}}function nx(t){let s=[];function r(i,o){return s=o.filter(({options:c})=>t.optionsAtMedia(c).active!==!1),s.forEach(c=>c.init(i,t)),o.reduce((c,l)=>Object.assign(c,{[l.name]:l}),{})}function n(){s=s.filter(i=>i.destroy())}return{init:r,destroy:n}}function Nn(t,s,r){const n=t.ownerDocument,a=n.defaultView,i=rx(a),o=nx(i),c=Ur(),l=tx(),{mergeOptions:d,optionsAtMedia:u,optionsMediaQueries:h}=i,{on:f,off:x,emit:g}=l,y=D;let b=!1,p,j=d(sx,Nn.globalOptions),v=d(j),w=[],N,k,S;function E(){const{container:ge,slides:Q}=v;k=(La(ge)?t.querySelector(ge):ge)||t.children[0];const G=La(Q)?k.querySelectorAll(Q):Q;S=[].slice.call(G||k.children)}function A(ge){const Q=ex(t,k,S,n,a,ge,l);if(ge.loop&&!Q.slideLooper.canLoop()){const xe=Object.assign({},ge,{loop:!1});return A(xe)}return Q}function z(ge,Q){b||(j=d(j,ge),v=u(j),w=Q||w,E(),p=A(v),h([j,...w.map(({options:xe})=>xe)]).forEach(xe=>c.add(xe,"change",D)),v.active&&(p.translate.to(p.location.get()),p.animation.init(),p.slidesInView.init(),p.slideFocus.init(Le),p.eventHandler.init(Le),p.resizeHandler.init(Le),p.slidesHandler.init(Le),p.options.loop&&p.slideLooper.loop(),k.offsetParent&&S.length&&p.dragHandler.init(Le),N=o.init(Le,w)))}function D(ge,Q){const xe=L();T(),z(d({startIndex:xe},ge),Q),l.emit("reInit")}function T(){p.dragHandler.destroy(),p.eventStore.clear(),p.translate.clear(),p.slideLooper.clear(),p.resizeHandler.destroy(),p.slidesHandler.destroy(),p.slidesInView.destroy(),p.animation.destroy(),o.destroy(),c.clear()}function R(){b||(b=!0,c.clear(),T(),l.emit("destroy"),l.clear())}function F(ge,Q,xe){!v.active||b||(p.scrollBody.useBaseFriction().useDuration(Q===!0?0:v.duration),p.scrollTo.index(ge,xe||0))}function Z(ge){const Q=p.index.add(1).get();F(Q,ge,-1)}function B(ge){const Q=p.index.add(-1).get();F(Q,ge,1)}function Y(){return p.index.add(1).get()!==L()}function I(){return p.index.add(-1).get()!==L()}function P(){return p.scrollSnapList}function _(){return p.scrollProgress.get(p.offsetLocation.get())}function L(){return p.index.get()}function q(){return p.indexPrevious.get()}function V(){return p.slidesInView.get()}function K(){return p.slidesInView.get(!1)}function se(){return N}function ze(){return p}function ie(){return t}function Ae(){return k}function He(){return S}const Le={canScrollNext:Y,canScrollPrev:I,containerNode:Ae,internalEngine:ze,destroy:R,off:x,on:f,emit:g,plugins:se,previousScrollSnap:q,reInit:y,rootNode:ie,scrollNext:Z,scrollPrev:B,scrollProgress:_,scrollSnapList:P,scrollTo:F,selectedScrollSnap:L,slideNodes:He,slidesInView:V,slidesNotInView:K};return z(s,r),setTimeout(()=>l.emit("init"),0),Le}Nn.globalOptions=void 0;function ai(t={},s=[]){const r=m.useRef(t),n=m.useRef(s),[a,i]=m.useState(),[o,c]=m.useState(),l=m.useCallback(()=>{a&&a.reInit(r.current,n.current)},[a]);return m.useEffect(()=>{ti(r.current,t)||(r.current=t,l())},[t,l]),m.useEffect(()=>{kp(n.current,s)||(n.current=s,l())},[s,l]),m.useEffect(()=>{if(Ep()&&o){Nn.globalOptions=ai.globalOptions;const d=Nn(o,r.current,n.current);return i(d),()=>d.destroy()}else i(void 0)},[o,i]),[c,a]}ai.globalOptions=void 0;const Pc=m.createContext(null);function Wn(){const t=m.useContext(Pc);if(!t)throw new Error("useCarousel must be used within a <Carousel />");return t}const Ac=m.forwardRef(({orientation:t="horizontal",opts:s,setApi:r,plugins:n,className:a,children:i,...o},c)=>{const l=document.documentElement.dir==="rtl",[d,u]=ai({...s,axis:t==="horizontal"?"x":"y",direction:l?"rtl":"ltr"},n),[h,f]=m.useState(!1),[x,g]=m.useState(!1),y=m.useCallback(v=>{v&&(f(v.canScrollPrev()),g(v.canScrollNext()))},[]),b=m.useCallback(()=>{u==null||u.scrollPrev()},[u]),p=m.useCallback(()=>{u==null||u.scrollNext()},[u]),j=m.useCallback(v=>{v.key==="ArrowLeft"?(v.preventDefault(),b()):v.key==="ArrowRight"&&(v.preventDefault(),p())},[b,p]);return m.useEffect(()=>{!u||!r||r(u)},[u,r]),m.useEffect(()=>{if(u)return y(u),u.on("reInit",y),u.on("select",y),()=>{u==null||u.off("select",y)}},[u,y]),e.jsx(Pc.Provider,{value:{carouselRef:d,api:u,opts:s,orientation:t||((s==null?void 0:s.axis)==="y"?"vertical":"horizontal"),scrollPrev:b,scrollNext:p,canScrollPrev:h,canScrollNext:x},children:e.jsx("div",{ref:c,onKeyDownCapture:j,className:W("relative carousel-rtl-fix",a),role:"region","aria-roledescription":"carousel",dir:l?"rtl":"ltr",...o,children:i})})});Ac.displayName="Carousel";const _c=m.forwardRef(({className:t,...s},r)=>{const{carouselRef:n,orientation:a}=Wn();return e.jsx("div",{ref:n,className:"overflow-hidden",children:e.jsx("div",{ref:r,className:W("flex",a==="horizontal"?"-ml-4":"-mt-4 flex-col",t),...s})})});_c.displayName="CarouselContent";const Ic=m.forwardRef(({className:t,...s},r)=>{const{orientation:n}=Wn();return e.jsx("div",{ref:r,role:"group","aria-roledescription":"slide",className:W("min-w-0 shrink-0 grow-0 basis-full",n==="horizontal"?"pl-4":"pt-4",t),...s})});Ic.displayName="CarouselItem";const Rc=m.forwardRef(({className:t,variant:s="outline",size:r="icon",...n},a)=>{const{orientation:i,scrollPrev:o,canScrollPrev:c}=Wn(),l=document.documentElement.dir==="rtl";return e.jsxs($,{ref:a,variant:s,size:r,className:W("absolute h-8 w-8 rounded-full",i==="horizontal"?`${l?"-right-12":"-left-12"} top-1/2 -translate-y-1/2`:"-top-12 left-1/2 -translate-x-1/2 rotate-90",t),disabled:!c,onClick:o,...n,children:[l?e.jsx(Yt,{className:"h-4 w-4"}):e.jsx(Ua,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Previous slide"})]})});Rc.displayName="CarouselPrevious";const Oc=m.forwardRef(({className:t,variant:s="outline",size:r="icon",...n},a)=>{const{orientation:i,scrollNext:o,canScrollNext:c}=Wn(),l=document.documentElement.dir==="rtl";return e.jsxs($,{ref:a,variant:s,size:r,className:W("absolute h-8 w-8 rounded-full",i==="horizontal"?`${l?"-left-12":"-right-12"} top-1/2 -translate-y-1/2`:"-bottom-12 left-1/2 -translate-x-1/2 rotate-90",t),disabled:!c,onClick:o,...n,children:[l?e.jsx(Ua,{className:"h-4 w-4"}):e.jsx(Yt,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Next slide"})]})});Oc.displayName="CarouselNext";const ii=({children:t,className:s,controlsClassName:r,showControls:n=!0,itemClassName:a="basis-1/2 sm:basis-1/3 lg:basis-1/4",setApi:i})=>{const[o,c]=m.useState(!1);return m.useEffect(()=>{c(document.documentElement.dir==="rtl")},[]),e.jsxs(Ac,{className:W("w-full",s),opts:{dragFree:!0,loop:!0,align:"start",direction:o?"rtl":"ltr",slidesToScroll:1},setApi:i,children:[e.jsx(_c,{className:"-ml-2 -mr-2",children:U.Children.map(t,(l,d)=>e.jsx(Ic,{className:W("pl-2 pr-2 transition-opacity hover:opacity-100 focus:opacity-100",a),children:l},d))}),n&&e.jsxs(e.Fragment,{children:[e.jsx(Rc,{className:W(`${o?"-right-2 md:-right-3":"-left-2 md:-left-3"} min-w-[36px] min-h-[36px] flex items-center justify-center`,r)}),e.jsx(Oc,{className:W(`${o?"-left-2 md:-left-3":"-right-2 md:-right-3"} min-w-[36px] min-h-[36px] flex items-center justify-center`,r)})]})]})},mo=({items:t,type:s,title:r,viewAllLink:n,showCarousel:a=!1,isLoading:i=!1,skeletonCount:o=4})=>{const c=(l,d,u)=>{if(d==="podcast"){const f=l;return e.jsx(cs,{id:f.id,title:f.title,description:f.description,thumbnail:f.thumbnail,type:d,date:f.date,author:Gt(f.author),duration:f.duration,className:"h-full"},`${u}-${f.id}`)}if(d==="video"){const f=l;return e.jsx(cs,{id:f.id,title:f.title,description:f.description,thumbnail:f.thumbnail,type:d,date:f.date,author:Gt(f.author),duration:f.duration,className:"h-full"},`${u}-${f.id}`)}if(d==="webinar"){const f=l;return e.jsx(cs,{id:f.id,title:f.title,description:f.description,thumbnail:f.thumbnail,type:d,date:f.date,author:Gt(f.author),duration:f.duration,className:"h-full"},`${u}-${f.id}`)}if(d==="livestream"){const f=l;return e.jsx(cs,{id:f.id,title:f.title,description:f.description,thumbnail:f.thumbnail,type:d,date:f.created_at,author:Gt(f.author),className:"h-full"},`${u}-${f.id}`)}if(d==="file"){const f=l;return e.jsx(cs,{id:f.id,title:f.title,description:f.description,thumbnail:f.thumbnail,type:d,date:f.date,author:Gt(f.author),fileSize:f.fileSize,fileType:f.fileType,className:"h-full"},`${u}-${f.id}`)}const h=l;return e.jsx(cs,{id:h.id,title:h.title,description:h.description,thumbnail:h.thumbnail,type:d,date:h.date,author:Gt(h.author),className:"h-full"},`${u}-${h.id}`)};return a?e.jsxs("div",{className:"my-4",children:[r&&e.jsxs("div",{className:"flex justify-between items-center mb-4 px-2 sm:px-0",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"w-1 h-6 bg-trader-500 rounded-sm ml-2"}),e.jsx("h2",{className:"text-xl font-bold",children:r})]}),t.length>3&&n&&!i&&e.jsxs(me,{to:n,className:"text-trader-500 text-sm flex items-center",children:[e.jsx("span",{children:"مشاهده همه"}),e.jsx(ja,{className:"h-4 w-4 mr-1"})]})]}),e.jsx(ii,{controlsClassName:"bg-white shadow-md",children:i?Array.from({length:o}).map((l,d)=>e.jsx(Oa,{className:"px-1"},`carousel-skeleton-${d}`)):t.map((l,d)=>c(l,s,`carousel-${d}`))})]}):e.jsxs("div",{className:"my-4",children:[r&&e.jsxs("div",{className:"flex justify-between items-center mb-4 px-2 sm:px-0",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"w-1 h-6 bg-trader-500 rounded-sm ml-2"}),e.jsx("h2",{className:"text-xl font-bold",children:r})]}),t.length>3&&n&&!i&&e.jsxs(me,{to:n,className:"text-trader-500 text-sm flex items-center",children:[e.jsx("span",{children:"مشاهده همه"}),e.jsx(ja,{className:"h-4 w-4 mr-1"})]})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2 sm:gap-3 md:gap-4",children:i?Array.from({length:o}).map((l,d)=>e.jsx(Oa,{},`skeleton-${d}`)):t.map((l,d)=>c(l,s,d.toString()))})]})},ax=()=>{const[t,s]=m.useState(!1),[r,n]=m.useState(0),[a,i]=m.useState(),o=ei(),{courses:c}=as();m.useEffect(()=>{s(document.documentElement.dir==="rtl")},[]);const l=c.slice(0,3);m.useEffect(()=>{if(!a)return;const u=()=>{n(a.selectedScrollSnap())};return a.on("select",u),u(),()=>{a==null||a.off("select",u)}},[a]);const d=u=>{a&&a.scrollTo(u)};return l.length===0?e.jsx("div",{className:"relative w-full",children:e.jsx("div",{className:"w-full rounded-2xl overflow-hidden bg-gray-200 animate-pulse",children:e.jsx("div",{className:"h-[180px] md:h-[240px] lg:h-[300px] w-full bg-gray-300"})})}):e.jsxs("div",{className:"relative w-full",children:[e.jsx(ii,{className:"w-full",controlsClassName:"bg-white/50 text-trader-500 hover:bg-white",itemClassName:o?"basis-full":"basis-1/2",setApi:i,children:l.map((u,h)=>e.jsx(me,{to:`/courses/${u.id}`,className:"relative w-full rounded-2xl overflow-hidden block",children:e.jsx("div",{className:"relative h-[180px] md:h-[240px] lg:h-[300px] w-full",children:e.jsx("img",{src:u.thumbnail||ka.PLACEHOLDER_CONTENT,alt:u.title,className:"w-full h-full object-cover ",onError:f=>{const x=f.target;x.src=ka.PLACEHOLDER_CONTENT}})})},u.id))}),e.jsx("div",{className:"flex justify-center gap-3 mt-4",children:l.map((u,h)=>e.jsx("div",{className:W("w-4 h-4 rounded-full transition-all duration-300 cursor-pointer hover:scale-110",h===r?"bg-trader-500 scale-110":"bg-gray-300 hover:bg-gray-400"),onClick:()=>d(h)},u.id))})]})},ix=[{id:"videos",title:"ویدیوها",icon:e.jsx(Va,{className:"w-5 h-5 md:w-6 md:h-6"}),link:"/content?type=videos"},{id:"podcasts",title:"پادکست‌ها",icon:e.jsx(jl,{className:"w-5 h-5 md:w-6 md:h-6"}),link:"/content?type=podcasts"},{id:"articles",title:"مقالات",icon:e.jsx(_s,{className:"w-5 h-5 md:w-6 md:h-6"}),link:"/content?type=articles"},{id:"webinars",title:"وبینارها",icon:e.jsx(Tn,{className:"w-5 h-5 md:w-6 md:h-6"}),link:"/content?type=webinars"},{id:"files",title:"فایل‌ها",icon:e.jsx(Lu,{className:"w-5 h-5 md:w-6 md:h-6"}),link:"/content?type=files"}],ox=()=>e.jsx("div",{className:"flex justify-between my-6 overflow-x-auto pb-2 gap-2 md:gap-3",children:ix.map(t=>e.jsxs(me,{to:t.link,className:"flex flex-col items-center min-w-[60px] md:min-w-[75px]",children:[e.jsx("div",{className:"w-12 h-12 md:w-16 md:h-16 rounded-full bg-white shadow-md flex items-center justify-center mb-2 text-trader-500 hover:scale-105 transition-transform duration-200",children:t.icon}),e.jsx("span",{className:"text-xs text-center text-gray-600",children:t.title})]},t.id))}),ha=({title:t,viewAllLink:s,viewAllText:r="مشاهده همه",className:n,icon:a})=>e.jsxs("div",{className:W("flex items-center justify-between mb-4",n),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[a&&a,e.jsx("h2",{className:"text-xl font-bold flex items-center gap-2",children:t})]}),s&&e.jsx("a",{href:s,className:"text-trader-500 text-sm flex items-center",children:r})]}),oi=eu,lx=Xd,Lc=m.forwardRef(({className:t,...s},r)=>e.jsx(Ko,{ref:r,className:W("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...s}));Lc.displayName=Ko.displayName;const Vn=m.forwardRef(({className:t,children:s,...r},n)=>e.jsxs(lx,{children:[e.jsx(Lc,{}),e.jsxs(Qo,{ref:n,className:W("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...r,children:[s,e.jsxs(Zd,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(Lr,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Vn.displayName=Qo.displayName;const Gn=({className:t,...s})=>e.jsx("div",{className:W("flex flex-col space-y-1.5 text-center sm:text-left",t),...s});Gn.displayName="DialogHeader";const Kn=({className:t,...s})=>e.jsx("div",{className:W("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s});Kn.displayName="DialogFooter";const Qn=m.forwardRef(({className:t,...s},r)=>e.jsx(Yo,{ref:r,className:W("text-lg font-semibold leading-none tracking-tight",t),...s}));Qn.displayName=Yo.displayName;const cx=m.forwardRef(({className:t,...s},r)=>e.jsx(Jo,{ref:r,className:W("text-sm text-muted-foreground",t),...s}));cx.displayName=Jo.displayName;const dx=({percentage:t,height:s="sm",color:r="bg-trader-500",backgroundColor:n="bg-gray-200",className:a,showText:i=!1,animated:o=!0})=>{const c={sm:"h-1",md:"h-2",lg:"h-3"};return e.jsxs("div",{className:W("w-full",a),children:[e.jsx("div",{className:W("w-full rounded-full overflow-hidden",n,c[s]),children:e.jsx("div",{className:W("h-full rounded-full",r,o&&"transition-all duration-300 ease-out"),style:{width:`${Math.min(t,100)}%`}})}),i&&e.jsx("div",{className:"flex justify-between items-center mt-1",children:e.jsxs("span",{className:"text-xs text-gray-600",children:[Math.round(t),"%"]})})]})},fn=t=>new Intl.NumberFormat("fa-IR").format(t),Xe=t=>`${fn(t)} تومان`,Mc=(t,s=!1)=>{const r=typeof t=="string"?parseFloat(t):t;if(console.log("formatPrice called:",{amount:t,isFree:s,numAmount:r,type:typeof t}),s||r===0||r===null||r===void 0||isNaN(r))return console.log('Returning "دوره رایگان"'),"دوره رایگان";const n=Xe(r);return console.log("Returning formatCurrency result:",n),n};class ux{constructor(){Fs(this,"defaultIcon","/lovable-uploads/970ac420-2fc4-450d-9177-b465e09c7857.png");Fs(this,"baseUrl","/api/push")}isSupported(){return"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window}async sendNotification(s){try{return await this.sendViaBackend(s)?!0:await this.sendViaServiceWorker(s)}catch(r){return console.error("Error sending notification:",r),!1}}async sendViaBackend(s){try{const r=await fetch(`${this.baseUrl}/send`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:s.title,body:s.body,icon:s.icon||this.defaultIcon,url:s.url||"/",tag:s.tag||"master-trader-notification"})});if(r.ok){const n=await r.json();if(n.success)return console.log("Notification sent via backend:",n.message),!0}return!1}catch(r){return console.warn("Backend notification service not available:",r),!1}}async sendViaServiceWorker(s){try{return await(await navigator.serviceWorker.ready).showNotification(s.title,{body:s.body,icon:s.icon||this.defaultIcon,badge:this.defaultIcon,tag:s.tag||"master-trader-notification",requireInteraction:s.requireInteraction||!1,actions:s.actions||[],data:{url:s.url||"/",timestamp:Date.now(),...s.data}}),console.log("Notification sent via service worker"),!0}catch(r){return console.error("Error sending notification via service worker:",r),!1}}async sendCoursePurchaseNotification(s,r){return await this.sendNotification({title:"🎉 خرید موفق - مسترتریدر آکادمی",body:`دوره "${s}" با موفقیت خریداری شد! می‌توانید از همین الان شروع به یادگیری کنید.`,icon:this.defaultIcon,url:`/learn/${r}`,tag:"course-purchase",requireInteraction:!0,actions:[{action:"view-course",title:"شروع یادگیری",icon:this.defaultIcon}],data:{type:"course-purchase",courseId:r,courseTitle:s}})}async sendCourseEnrollmentNotification(s,r){return await this.sendNotification({title:"✅ ثبت‌نام موفق - مسترتریدر آکادمی",body:`شما با موفقیت در دوره "${s}" ثبت‌نام شدید. شروع یادگیری کنید!`,icon:this.defaultIcon,url:`/learn/${r}`,tag:"course-enrollment",requireInteraction:!0,actions:[{action:"view-course",title:"شروع یادگیری",icon:this.defaultIcon}],data:{type:"course-enrollment",courseId:r,courseTitle:s}})}async sendCourseCompletionNotification(s,r){return await this.sendNotification({title:"🏆 تبریک! دوره تکمیل شد",body:`شما دوره "${s}" را با موفقیت تکمیل کردید. گواهی خود را دریافت کنید!`,icon:this.defaultIcon,url:`/learn/${r}/certificate`,tag:"course-completion",requireInteraction:!0,actions:[{action:"view-certificate",title:"مشاهده گواهی",icon:this.defaultIcon}],data:{type:"course-completion",courseId:r,courseTitle:s}})}async sendWalletChargeNotification(s,r){return await this.sendNotification({title:"💰 کیف پول شارژ شد",body:`مبلغ ${s.toLocaleString()} تومان به کیف پول شما اضافه شد. موجودی جدید: ${r.toLocaleString()} تومان`,icon:this.defaultIcon,url:"/wallet",tag:"wallet-charge",requireInteraction:!1,data:{type:"wallet-charge",amount:s,newBalance:r}})}async sendSystemNotification(s,r,n){return await this.sendNotification({title:s,body:r,icon:this.defaultIcon,url:n||"/",tag:"system-notification",requireInteraction:!1,data:{type:"system-notification"}})}async sendTestNotification(){return await this.sendNotification({title:"تست اعلان - مسترتریدر آکادمی",body:"این یک اعلان آزمایشی است که به درستی کار می‌کند!",icon:this.defaultIcon,url:"/test/notifications",tag:"test-notification",requireInteraction:!1,data:{type:"test"}})}}const Ls=new ux,li=U.memo(({id:t,title:s,instructor:r,thumbnail:n,price:a,progress:i,isFree:o=!1,is_enrolled:c})=>{const l=Ze(),{user:d}=Oe(),{wallet:u,enrollCourse:h}=as(),{refetchWallet:f}=Za(),[x,g]=m.useState(!1),[y,b]=m.useState(!1),p=c||!1,j=async()=>{var N,k,S,E,A;b(!1),g(!0);try{if((await Pe.post(`/crs/courses/${t}/enroll/`,{course_id:parseInt(t)})).status===201){js(),h(t),be({title:"خرید موفق",description:`دوره ${s} با موفقیت خریداری شد`});try{await Ls.sendCoursePurchaseNotification(s,t),console.log("Course purchase notification sent successfully")}catch(D){console.warn("Failed to send course purchase notification:",D)}f(),l(`/learn/${t}`)}}catch(z){if(console.error("Error processing purchase:",z),((N=z.response)==null?void 0:N.status)===400){const D=z.response.data;let T="خطا در پردازش خرید";(k=D==null?void 0:D.course_id)!=null&&k[0]?T=D.course_id[0]:(S=D==null?void 0:D.non_field_errors)!=null&&S[0]?T=D.non_field_errors[0]:D!=null&&D.detail&&(T=D.detail),be({title:"خطا در خرید",description:T,variant:"destructive"})}else((E=z.response)==null?void 0:E.status)===402?(be({title:"موجودی ناکافی",description:"موجودی کیف پول شما برای خرید این دوره کافی نیست",variant:"destructive"}),localStorage.setItem("pendingCourseId",t),l("/wallet")):((A=z.response)==null?void 0:A.status)===409?be({title:"خطا",description:"شما قبلاً در این دوره ثبت‌نام کرده‌اید",variant:"destructive"}):be({title:"خطا",description:"خطا در پردازش خرید. لطفاً دوباره تلاش کنید.",variant:"destructive"})}finally{g(!1)}},v=U.useCallback(async N=>{var k,S;N.preventDefault(),g(!0);try{if(!d){l("/login");return}if(p){l(`/learn/${t}`);return}if(o||a===0){try{if((await Pe.post(`/crs/courses/${t}/enroll/`,{course_id:parseInt(t)})).status===201){js(),h(t),be({title:"ثبت‌نام موفق",description:`شما با موفقیت در دوره ${s} ثبت‌نام شدید`});try{await Ls.sendCourseEnrollmentNotification(s,t),console.log("Course enrollment notification sent successfully")}catch(A){console.warn("Failed to send course enrollment notification:",A)}l(`/learn/${t}`)}}catch(E){console.error("Error processing free enrollment:",E),((k=E.response)==null?void 0:k.status)===400||((S=E.response)==null?void 0:S.status)===409?be({title:"خطا",description:"شما قبلاً در این دوره ثبت‌نام کرده‌اید",variant:"destructive"}):be({title:"خطا",description:"خطا در پردازش ثبت‌نام. لطفاً دوباره تلاش کنید.",variant:"destructive"})}finally{g(!1)}return}if(!u||u.balance<a){const E=a-((u==null?void 0:u.balance)||0);be({title:"موجودی ناکافی",description:`برای خرید این دوره نیاز به ${Xe(E)} شارژ اضافی دارید`,variant:"destructive"}),localStorage.setItem("pendingCourseId",t),l("/wallet");return}g(!1),b(!0)}catch(E){console.error("Error in handleQuickBuy:",E),be({title:"خطا",description:"خطا در پردازش درخواست. لطفاً دوباره تلاش کنید.",variant:"destructive"}),g(!1)}},[d,o,p,u,a,t,s,l,h]),w=U.useCallback(N=>{const k=N.target;k.src="/placeholder-course.jpg"},[]);return console.log("CourseCard Debug:",{id:t,title:s,price:a,isFree:o,is_enrolled:c}),e.jsxs("div",{className:"trader-card h-full flex flex-col min-h-[240px]",children:[e.jsx(me,{to:p?`/learn/${t}`:`/courses/${t}`,className:"block",children:e.jsxs("div",{className:"relative h-32 w-full",children:[e.jsx("img",{src:n||"/placeholder-course.jpg",alt:s,className:"w-full h-full object-contain rounded-t-xl bg-gray-50",onError:w,loading:"lazy"}),p&&i!==void 0&&e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/70 to-transparent py-2 px-3",children:[e.jsx(dx,{percentage:i,height:"sm",color:"bg-trader-500",backgroundColor:"bg-white/30",className:"mb-1"}),e.jsxs("p",{className:"text-white text-xs text-center font-medium",children:[i,"% تکمیل شده"]})]})]})}),e.jsxs("div",{className:"p-3 flex-1 flex flex-col",children:[e.jsxs(me,{to:p?`/learn/${t}`:`/courses/${t}`,className:"block",children:[e.jsx("h3",{className:"font-bold text-sm line-clamp-2 mb-1 min-h-[2.5rem]",children:s}),e.jsxs("p",{className:"text-gray-600 text-xs mb-2",children:["مدرس: ",r]})]}),e.jsxs("div",{className:"mt-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[!p&&e.jsx("p",{className:`font-bold ${o?"text-green-600":"text-trader-500"} text-sm`,children:Mc(a,o)}),p&&e.jsx("p",{className:"font-bold text-green-600 text-sm",children:"ادامه یادگیری"})]}),e.jsx($,{variant:p?"outline":"default",className:`w-full text-xs py-2 h-8 ${p?"border-green-500 text-green-600 hover:bg-green-50":o?"bg-green-600 hover:bg-green-700 text-white":"bg-trader-600 hover:bg-trader-700 text-white"}`,onClick:v,disabled:x,children:x?e.jsx(bs,{className:"h-4 w-4 animate-spin mx-auto"}):e.jsxs(e.Fragment,{children:[!p&&e.jsx(ys,{className:"h-4 w-4 ml-1"}),p?"ادامه یادگیری":o?"ثبت‌نام در دوره رایگان":"خرید سریع"]})})]})]}),e.jsx(oi,{open:y,onOpenChange:b,children:e.jsxs(Vn,{className:"sm:max-w-[450px]",children:[e.jsx(Gn,{children:e.jsx(Qn,{className:"text-center",children:"تأیید خرید دوره"})}),e.jsxs("div",{className:"py-4",children:[e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("img",{src:n||"/placeholder-course.jpg",alt:s,className:"w-16 h-16 object-cover rounded-lg ml-4"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg",children:s}),e.jsxs("p",{className:"text-gray-600 text-sm",children:["مدرس: ",r]})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ys,{className:"h-5 w-5 text-blue-600 ml-2"}),e.jsx("span",{className:"text-blue-800",children:"مبلغ دوره:"})]}),e.jsx("span",{className:"font-bold text-blue-600",children:Xe(a)})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Cl,{className:"h-5 w-5 text-green-600 ml-2"}),e.jsx("span",{className:"text-green-800",children:"موجودی فعلی شما:"})]}),e.jsx("span",{className:"font-bold text-green-600",children:Xe((u==null?void 0:u.balance)||0)})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-trader-50 border border-trader-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(mt,{className:"h-5 w-5 text-trader-600 ml-2"}),e.jsx("span",{className:"text-trader-800",children:"موجودی پس از خرید:"})]}),e.jsx("span",{className:"font-bold text-trader-600",children:Xe(((u==null?void 0:u.balance)||0)-a)})]})]}),e.jsx("div",{className:"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("p",{className:"text-yellow-800 text-center",children:["مبلغ ",e.jsx("span",{className:"font-bold",children:Xe(a)})," از کیف پول شما برای خرید دوره ",e.jsxs("span",{className:"font-bold",children:['"',s,'"']})," کم می‌شود."]})})]}),e.jsxs(Kn,{className:"flex justify-between sm:justify-between gap-2",children:[e.jsx($,{type:"button",variant:"outline",onClick:()=>b(!1),children:"انصراف"}),e.jsx($,{type:"submit",onClick:j,disabled:x,className:"bg-trader-600 hover:bg-trader-700",children:x?"در حال پردازش...":"تأیید و خرید"})]})]})})]})},(t,s)=>t.id===s.id&&t.title===s.title&&t.instructor===s.instructor&&t.thumbnail===s.thumbnail&&t.price===s.price&&t.progress===s.progress&&t.isFree===s.isFree&&t.is_enrolled===s.is_enrolled);li.displayName="CourseCard";const Dc=()=>e.jsxs("div",{className:"trader-card h-full flex flex-col",children:[e.jsx(Be,{className:"h-44 w-full rounded-t-xl"}),e.jsxs("div",{className:"p-3 flex-1 flex flex-col",children:[e.jsx(Be,{className:"h-5 w-3/4 mb-2"}),e.jsx(Be,{className:"h-4 w-1/2 mb-3"}),e.jsxs("div",{className:"mt-auto",children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx(Be,{className:"h-3 w-1/4"}),e.jsx(Be,{className:"h-3 w-1/3"})]}),e.jsx(Be,{className:"h-8 w-full rounded-md"})]})]})]}),mx=()=>{const{courses:t,articles:s,podcasts:r}=as(),[n,a]=m.useState(!0);return m.useEffect(()=>{const i=setTimeout(()=>{a(!1)},1500);return()=>clearTimeout(i)},[]),e.jsx(de,{children:e.jsxs("div",{className:"py-2",children:[e.jsx("section",{className:"mb-4",children:e.jsx(ax,{})}),e.jsx("section",{className:"mb-6 px-2 sm:px-0",children:e.jsx(ox,{})}),e.jsxs("section",{className:"mb-6 px-2 sm:px-0",children:[e.jsx(ha,{title:"دوره‌های آموزشی",viewAllLink:"/courses",icon:e.jsx(ur,{className:"text-trader-500 h-5 w-5"})}),e.jsx(ii,{controlsClassName:"bg-white shadow-md",children:n?Array.from({length:5}).map((i,o)=>e.jsx(Dc,{},`skeleton-${o}`)):t.slice(0,8).map(i=>e.jsx(li,{id:i.id,title:i.title,instructor:i.instructor,thumbnail:i.thumbnail,price:i.price,isFree:i.price===0,is_enrolled:i.is_enrolled},i.id))})]}),e.jsx("section",{className:"mb-6 bg-gray-50 py-4 -mx-4 sm:-mx-6 lg:-mx-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6",children:[e.jsx(ha,{title:"مقالات آموزشی",viewAllLink:"/content?type=articles",icon:e.jsx(_s,{className:"text-trader-500 h-5 w-5"}),className:"mb-4"}),e.jsx(mo,{items:s.slice(0,5),type:"article",showCarousel:!0,isLoading:n,skeletonCount:5})]})}),e.jsx("section",{className:"mb-6 bg-gray-50 py-4 -mx-4 sm:-mx-6 lg:-mx-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6",children:[e.jsx(ha,{title:"پادکست‌های آموزشی",viewAllLink:"/content?type=podcasts",icon:e.jsx(jl,{className:"text-trader-500 h-5 w-5"}),className:"mb-4"}),e.jsx(mo,{items:r.slice(0,8),type:"podcast",showCarousel:!0,isLoading:n,skeletonCount:8})]})})]})})},hx={article:"articles",podcast:"podcasts",video:"videos",webinar:"webinars",livestream:"livestreams",file:"files",course:"courses"},fx=({items:t,type:s})=>{if(!t||t.length===0)return e.jsx("div",{className:"text-center p-8",children:e.jsx("p",{className:"text-gray-500",children:"موردی یافت نشد"})});const r=hx[s];return e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-2 sm:gap-3 md:gap-4",children:t.map(n=>e.jsx(me,{to:`/${r}/${n.id}`,children:e.jsx(ne,{className:"h-full hover:shadow-md transition-shadow duration-300",children:e.jsxs(ae,{className:"p-0",children:[e.jsx("div",{className:"relative",children:e.jsx("img",{src:n.thumbnail,alt:n.title,className:"w-full h-32 object-contain rounded-t-lg bg-gray-50"})}),e.jsxs("div",{className:"p-2 text-right rtl-card-content",children:[e.jsx("h3",{className:"font-semibold text-xs mb-1 line-clamp-1",children:n.title}),e.jsx("p",{className:"text-gray-500 text-[10px] line-clamp-1 mb-2",children:n.description}),e.jsxs("div",{className:"flex justify-between text-[8px] text-gray-500",children:[e.jsx("span",{children:n.date}),e.jsx("span",{children:Gt(n.author)})]})]})]})})},n.id))})},zr=({icon:t,title:s,description:r,action:n,className:a})=>e.jsxs("div",{className:W("flex flex-col items-center justify-center py-12 px-4 text-center bg-white rounded-xl shadow-sm hover:shadow-md transition-all duration-300",a),children:[e.jsx("div",{className:"text-gray-300 mb-4 animate-pulse-once transition-transform hover:scale-110 duration-300",children:t}),e.jsx("h3",{className:"text-lg font-semibold mb-2 scale-in",children:s}),r&&e.jsx("p",{className:"text-sm text-gray-500 mb-4 max-w-md fade-in",children:r}),e.jsx("div",{className:"scale-in touch-manipulation",style:{animationDelay:"200ms"},children:n})]});var Yn="Tabs",[px,J0]=kn(Yn,[Xo]),$c=Xo(),[xx,ci]=px(Yn),Fc=m.forwardRef((t,s)=>{const{__scopeTabs:r,value:n,onValueChange:a,defaultValue:i,orientation:o="horizontal",dir:c,activationMode:l="automatic",...d}=t,u=ru(c),[h,f]=Zo({prop:n,onChange:a,defaultProp:i??"",caller:Yn});return e.jsx(xx,{scope:r,baseId:nu(),value:h,onValueChange:f,orientation:o,dir:u,activationMode:l,children:e.jsx($t.div,{dir:u,"data-orientation":o,...d,ref:s})})});Fc.displayName=Yn;var Bc="TabsList",Uc=m.forwardRef((t,s)=>{const{__scopeTabs:r,loop:n=!0,...a}=t,i=ci(Bc,r),o=$c(r);return e.jsx(tu,{asChild:!0,...o,orientation:i.orientation,dir:i.dir,loop:n,children:e.jsx($t.div,{role:"tablist","aria-orientation":i.orientation,...a,ref:s})})});Uc.displayName=Bc;var zc="TabsTrigger",Hc=m.forwardRef((t,s)=>{const{__scopeTabs:r,value:n,disabled:a=!1,...i}=t,o=ci(zc,r),c=$c(r),l=Vc(o.baseId,n),d=Gc(o.baseId,n),u=n===o.value;return e.jsx(su,{asChild:!0,...c,focusable:!a,active:u,children:e.jsx($t.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":d,"data-state":u?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:l,...i,ref:s,onMouseDown:Mt(t.onMouseDown,h=>{!a&&h.button===0&&h.ctrlKey===!1?o.onValueChange(n):h.preventDefault()}),onKeyDown:Mt(t.onKeyDown,h=>{[" ","Enter"].includes(h.key)&&o.onValueChange(n)}),onFocus:Mt(t.onFocus,()=>{const h=o.activationMode!=="manual";!u&&!a&&h&&o.onValueChange(n)})})})});Hc.displayName=zc;var qc="TabsContent",Wc=m.forwardRef((t,s)=>{const{__scopeTabs:r,value:n,forceMount:a,children:i,...o}=t,c=ci(qc,r),l=Vc(c.baseId,n),d=Gc(c.baseId,n),u=n===c.value,h=m.useRef(u);return m.useEffect(()=>{const f=requestAnimationFrame(()=>h.current=!1);return()=>cancelAnimationFrame(f)},[]),e.jsx(Ba,{present:a||u,children:({present:f})=>e.jsx($t.div,{"data-state":u?"active":"inactive","data-orientation":c.orientation,role:"tabpanel","aria-labelledby":l,hidden:!f,id:d,tabIndex:0,...o,ref:s,style:{...t.style,animationDuration:h.current?"0s":void 0},children:f&&i})})});Wc.displayName=qc;function Vc(t,s){return`${t}-trigger-${s}`}function Gc(t,s){return`${t}-content-${s}`}var gx=Fc,Kc=Uc,Qc=Hc,Yc=Wc;const Jc=gx,di=m.forwardRef(({className:t,...s},r)=>e.jsx(Kc,{ref:r,className:W("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...s}));di.displayName=Kc.displayName;const _r=m.forwardRef(({className:t,...s},r)=>e.jsx(Qc,{ref:r,className:W("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...s}));_r.displayName=Qc.displayName;const pn=m.forwardRef(({className:t,...s},r)=>e.jsx(Yc,{ref:r,className:W("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...s}));pn.displayName=Yc.displayName;const bx=()=>{const t=dr(),s=Ze(),n=new URLSearchParams(t.search).get("type"),a=()=>{if(!n)return"articles";const w=n.endsWith("s")?n:`${n}s`;return["articles","podcasts","videos","webinars","files"].includes(w)?w:"articles"},[i,o]=m.useState(a()),{articles:c,podcasts:l,videos:d,webinars:u,files:h,isLoading:f}=as(),[x,g]=m.useState(0);m.useEffect(()=>{const w=a();w!==i&&(o(w),g(N=>N+1))},[t.search]);const b=(()=>{switch(i){case"articles":return c;case"podcasts":return l;case"videos":return d;case"webinars":return u;case"files":return h;default:return[]}})(),p={articles:"مقالات",podcasts:"پادکست‌ها",videos:"ویدیوها",webinars:"وبینارها",files:"فایل‌ها"},j=w=>{const N=w;o(N),s(`/content?type=${N}`,{replace:!0})},v=()=>{switch(i){case"articles":return f.articles;case"videos":return f.videos;default:return!1}};return e.jsx(de,{children:e.jsxs("div",{className:"trader-container py-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6 text-right",children:"کتابخانه محتوا"}),e.jsxs(Jc,{defaultValue:"articles",value:i,onValueChange:j,dir:"rtl",className:"rtl-card-content",children:[e.jsx(di,{className:"w-full overflow-x-auto bg-white border-b border-gray-200 p-0 h-auto mb-6",children:Object.keys(p).map(w=>e.jsx(_r,{value:w,className:"py-2 px-4 text-sm font-medium data-[state=active]:text-trader-500 data-[state=active]:border-b-2 data-[state=active]:border-trader-500 data-[state=active]:shadow-none rounded-none tab-transition",children:p[w]},w))}),e.jsx("div",{className:"mt-6 rtl-card-content",children:v()?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:Array.from({length:6}).map((w,N)=>e.jsx(Oa,{},`skeleton-${N}`))}):e.jsx("div",{className:"fade-in",children:b.length>0?e.jsx(fx,{items:b,type:i.slice(0,-1)}):e.jsx(zr,{icon:e.jsx(_s,{className:"h-16 w-16"}),title:`هنوز محتوایی در بخش ${p[i]} وجود ندارد`,description:"به‌زودی محتوای جدیدی در این بخش منتشر خواهد شد",action:e.jsx($,{onClick:()=>j("articles"),className:"mt-4 bg-trader-500 hover:bg-trader-600 btn-click",variant:"default",children:"مشاهده سایر محتوا"})})},x)})]})]})})};/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:Xc,setPrototypeOf:ho,isFrozen:yx,getPrototypeOf:vx,getOwnPropertyDescriptor:jx}=Object;let{freeze:ht,seal:Tt,create:Zc}=Object,{apply:Da,construct:$a}=typeof Reflect<"u"&&Reflect;ht||(ht=function(s){return s});Tt||(Tt=function(s){return s});Da||(Da=function(s,r,n){return s.apply(r,n)});$a||($a=function(s,r){return new s(...r)});const sn=ft(Array.prototype.forEach),Nx=ft(Array.prototype.lastIndexOf),fo=ft(Array.prototype.pop),br=ft(Array.prototype.push),wx=ft(Array.prototype.splice),xn=ft(String.prototype.toLowerCase),fa=ft(String.prototype.toString),po=ft(String.prototype.match),yr=ft(String.prototype.replace),Sx=ft(String.prototype.indexOf),Cx=ft(String.prototype.trim),It=ft(Object.prototype.hasOwnProperty),ct=ft(RegExp.prototype.test),vr=Ex(TypeError);function ft(t){return function(s){s instanceof RegExp&&(s.lastIndex=0);for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return Da(t,s,n)}}function Ex(t){return function(){for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return $a(t,r)}}function fe(t,s){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:xn;ho&&ho(t,null);let n=s.length;for(;n--;){let a=s[n];if(typeof a=="string"){const i=r(a);i!==a&&(yx(s)||(s[n]=i),a=i)}t[a]=!0}return t}function kx(t){for(let s=0;s<t.length;s++)It(t,s)||(t[s]=null);return t}function ss(t){const s=Zc(null);for(const[r,n]of Xc(t))It(t,r)&&(Array.isArray(n)?s[r]=kx(n):n&&typeof n=="object"&&n.constructor===Object?s[r]=ss(n):s[r]=n);return s}function jr(t,s){for(;t!==null;){const n=jx(t,s);if(n){if(n.get)return ft(n.get);if(typeof n.value=="function")return ft(n.value)}t=vx(t)}function r(){return null}return r}const xo=ht(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),pa=ht(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),xa=ht(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Tx=ht(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),ga=ht(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Px=ht(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),go=ht(["#text"]),bo=ht(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),ba=ht(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),yo=ht(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),rn=ht(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Ax=Tt(/\{\{[\w\W]*|[\w\W]*\}\}/gm),_x=Tt(/<%[\w\W]*|[\w\W]*%>/gm),Ix=Tt(/\$\{[\w\W]*/gm),Rx=Tt(/^data-[\-\w.\u00B7-\uFFFF]+$/),Ox=Tt(/^aria-[\-\w]+$/),ed=Tt(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Lx=Tt(/^(?:\w+script|data):/i),Mx=Tt(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),td=Tt(/^html$/i),Dx=Tt(/^[a-z][.\w]*(-[.\w]+)+$/i);var vo=Object.freeze({__proto__:null,ARIA_ATTR:Ox,ATTR_WHITESPACE:Mx,CUSTOM_ELEMENT:Dx,DATA_ATTR:Rx,DOCTYPE_NAME:td,ERB_EXPR:_x,IS_ALLOWED_URI:ed,IS_SCRIPT_OR_DATA:Lx,MUSTACHE_EXPR:Ax,TMPLIT_EXPR:Ix});const Nr={element:1,text:3,progressingInstruction:7,comment:8,document:9},$x=function(){return typeof window>"u"?null:window},Fx=function(s,r){if(typeof s!="object"||typeof s.createPolicy!="function")return null;let n=null;const a="data-tt-policy-suffix";r&&r.hasAttribute(a)&&(n=r.getAttribute(a));const i="dompurify"+(n?"#"+n:"");try{return s.createPolicy(i,{createHTML(o){return o},createScriptURL(o){return o}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}},jo=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function sd(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:$x();const s=re=>sd(re);if(s.version="3.2.6",s.removed=[],!t||!t.document||t.document.nodeType!==Nr.document||!t.Element)return s.isSupported=!1,s;let{document:r}=t;const n=r,a=n.currentScript,{DocumentFragment:i,HTMLTemplateElement:o,Node:c,Element:l,NodeFilter:d,NamedNodeMap:u=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:f,trustedTypes:x}=t,g=l.prototype,y=jr(g,"cloneNode"),b=jr(g,"remove"),p=jr(g,"nextSibling"),j=jr(g,"childNodes"),v=jr(g,"parentNode");if(typeof o=="function"){const re=r.createElement("template");re.content&&re.content.ownerDocument&&(r=re.content.ownerDocument)}let w,N="";const{implementation:k,createNodeIterator:S,createDocumentFragment:E,getElementsByTagName:A}=r,{importNode:z}=n;let D=jo();s.isSupported=typeof Xc=="function"&&typeof v=="function"&&k&&k.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:T,ERB_EXPR:R,TMPLIT_EXPR:F,DATA_ATTR:Z,ARIA_ATTR:B,IS_SCRIPT_OR_DATA:Y,ATTR_WHITESPACE:I,CUSTOM_ELEMENT:P}=vo;let{IS_ALLOWED_URI:_}=vo,L=null;const q=fe({},[...xo,...pa,...xa,...ga,...go]);let V=null;const K=fe({},[...bo,...ba,...yo,...rn]);let se=Object.seal(Zc(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ze=null,ie=null,Ae=!0,He=!0,Le=!1,ge=!0,Q=!1,xe=!0,G=!1,ee=!1,ye=!1,Ne=!1,Se=!1,ue=!1,ke=!0,Qe=!1;const We="user-content-";let Me=!0,Ve=!1,Ge={},we=null;const Ke=fe({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Jt=null;const Pt=fe({},["audio","video","img","source","image","track"]);let et=null;const Bt=fe({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),vt="http://www.w3.org/1998/Math/MathML",qe="http://www.w3.org/2000/svg",$e="http://www.w3.org/1999/xhtml";let jt=$e,Ct=!1,Ns=null;const fr=fe({},[vt,qe,$e],fa);let Ut=fe({},["mi","mo","mn","ms","mtext"]),Xt=fe({},["annotation-xml"]);const Ds=fe({},["title","style","font","a","script"]);let Et=null;const Nt=["application/xhtml+xml","text/html"],pr="text/html";let X=null,he=null;const Ce=r.createElement("form"),pt=function(C){return C instanceof RegExp||C instanceof Function},lt=function(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(he&&he===C)){if((!C||typeof C!="object")&&(C={}),C=ss(C),Et=Nt.indexOf(C.PARSER_MEDIA_TYPE)===-1?pr:C.PARSER_MEDIA_TYPE,X=Et==="application/xhtml+xml"?fa:xn,L=It(C,"ALLOWED_TAGS")?fe({},C.ALLOWED_TAGS,X):q,V=It(C,"ALLOWED_ATTR")?fe({},C.ALLOWED_ATTR,X):K,Ns=It(C,"ALLOWED_NAMESPACES")?fe({},C.ALLOWED_NAMESPACES,fa):fr,et=It(C,"ADD_URI_SAFE_ATTR")?fe(ss(Bt),C.ADD_URI_SAFE_ATTR,X):Bt,Jt=It(C,"ADD_DATA_URI_TAGS")?fe(ss(Pt),C.ADD_DATA_URI_TAGS,X):Pt,we=It(C,"FORBID_CONTENTS")?fe({},C.FORBID_CONTENTS,X):Ke,ze=It(C,"FORBID_TAGS")?fe({},C.FORBID_TAGS,X):ss({}),ie=It(C,"FORBID_ATTR")?fe({},C.FORBID_ATTR,X):ss({}),Ge=It(C,"USE_PROFILES")?C.USE_PROFILES:!1,Ae=C.ALLOW_ARIA_ATTR!==!1,He=C.ALLOW_DATA_ATTR!==!1,Le=C.ALLOW_UNKNOWN_PROTOCOLS||!1,ge=C.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Q=C.SAFE_FOR_TEMPLATES||!1,xe=C.SAFE_FOR_XML!==!1,G=C.WHOLE_DOCUMENT||!1,Ne=C.RETURN_DOM||!1,Se=C.RETURN_DOM_FRAGMENT||!1,ue=C.RETURN_TRUSTED_TYPE||!1,ye=C.FORCE_BODY||!1,ke=C.SANITIZE_DOM!==!1,Qe=C.SANITIZE_NAMED_PROPS||!1,Me=C.KEEP_CONTENT!==!1,Ve=C.IN_PLACE||!1,_=C.ALLOWED_URI_REGEXP||ed,jt=C.NAMESPACE||$e,Ut=C.MATHML_TEXT_INTEGRATION_POINTS||Ut,Xt=C.HTML_INTEGRATION_POINTS||Xt,se=C.CUSTOM_ELEMENT_HANDLING||{},C.CUSTOM_ELEMENT_HANDLING&&pt(C.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(se.tagNameCheck=C.CUSTOM_ELEMENT_HANDLING.tagNameCheck),C.CUSTOM_ELEMENT_HANDLING&&pt(C.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(se.attributeNameCheck=C.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),C.CUSTOM_ELEMENT_HANDLING&&typeof C.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(se.allowCustomizedBuiltInElements=C.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Q&&(He=!1),Se&&(Ne=!0),Ge&&(L=fe({},go),V=[],Ge.html===!0&&(fe(L,xo),fe(V,bo)),Ge.svg===!0&&(fe(L,pa),fe(V,ba),fe(V,rn)),Ge.svgFilters===!0&&(fe(L,xa),fe(V,ba),fe(V,rn)),Ge.mathMl===!0&&(fe(L,ga),fe(V,yo),fe(V,rn))),C.ADD_TAGS&&(L===q&&(L=ss(L)),fe(L,C.ADD_TAGS,X)),C.ADD_ATTR&&(V===K&&(V=ss(V)),fe(V,C.ADD_ATTR,X)),C.ADD_URI_SAFE_ATTR&&fe(et,C.ADD_URI_SAFE_ATTR,X),C.FORBID_CONTENTS&&(we===Ke&&(we=ss(we)),fe(we,C.FORBID_CONTENTS,X)),Me&&(L["#text"]=!0),G&&fe(L,["html","head","body"]),L.table&&(fe(L,["tbody"]),delete ze.tbody),C.TRUSTED_TYPES_POLICY){if(typeof C.TRUSTED_TYPES_POLICY.createHTML!="function")throw vr('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof C.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw vr('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');w=C.TRUSTED_TYPES_POLICY,N=w.createHTML("")}else w===void 0&&(w=Fx(x,a)),w!==null&&typeof N=="string"&&(N=w.createHTML(""));ht&&ht(C),he=C}},At=fe({},[...pa,...xa,...Tx]),zt=fe({},[...ga,...Px]),wt=function(C){let H=v(C);(!H||!H.tagName)&&(H={namespaceURI:jt,tagName:"template"});const te=xn(C.tagName),_e=xn(H.tagName);return Ns[C.namespaceURI]?C.namespaceURI===qe?H.namespaceURI===$e?te==="svg":H.namespaceURI===vt?te==="svg"&&(_e==="annotation-xml"||Ut[_e]):!!At[te]:C.namespaceURI===vt?H.namespaceURI===$e?te==="math":H.namespaceURI===qe?te==="math"&&Xt[_e]:!!zt[te]:C.namespaceURI===$e?H.namespaceURI===qe&&!Xt[_e]||H.namespaceURI===vt&&!Ut[_e]?!1:!zt[te]&&(Ds[te]||!At[te]):!!(Et==="application/xhtml+xml"&&Ns[C.namespaceURI]):!1},Ye=function(C){br(s.removed,{element:C});try{v(C).removeChild(C)}catch{b(C)}},$s=function(C,H){try{br(s.removed,{attribute:H.getAttributeNode(C),from:H})}catch{br(s.removed,{attribute:null,from:H})}if(H.removeAttribute(C),C==="is")if(Ne||Se)try{Ye(H)}catch{}else try{H.setAttribute(C,"")}catch{}},Ni=function(C){let H=null,te=null;if(ye)C="<remove></remove>"+C;else{const Je=po(C,/^[\r\n\t ]+/);te=Je&&Je[0]}Et==="application/xhtml+xml"&&jt===$e&&(C='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+C+"</body></html>");const _e=w?w.createHTML(C):C;if(jt===$e)try{H=new f().parseFromString(_e,Et)}catch{}if(!H||!H.documentElement){H=k.createDocument(jt,"template",null);try{H.documentElement.innerHTML=Ct?N:_e}catch{}}const st=H.body||H.documentElement;return C&&te&&st.insertBefore(r.createTextNode(te),st.childNodes[0]||null),jt===$e?A.call(H,G?"html":"body")[0]:G?H.documentElement:st},wi=function(C){return S.call(C.ownerDocument||C,C,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT|d.SHOW_PROCESSING_INSTRUCTION|d.SHOW_CDATA_SECTION,null)},ea=function(C){return C instanceof h&&(typeof C.nodeName!="string"||typeof C.textContent!="string"||typeof C.removeChild!="function"||!(C.attributes instanceof u)||typeof C.removeAttribute!="function"||typeof C.setAttribute!="function"||typeof C.namespaceURI!="string"||typeof C.insertBefore!="function"||typeof C.hasChildNodes!="function")},Si=function(C){return typeof c=="function"&&C instanceof c};function Zt(re,C,H){sn(re,te=>{te.call(s,C,H,he)})}const Ci=function(C){let H=null;if(Zt(D.beforeSanitizeElements,C,null),ea(C))return Ye(C),!0;const te=X(C.nodeName);if(Zt(D.uponSanitizeElement,C,{tagName:te,allowedTags:L}),xe&&C.hasChildNodes()&&!Si(C.firstElementChild)&&ct(/<[/\w!]/g,C.innerHTML)&&ct(/<[/\w!]/g,C.textContent)||C.nodeType===Nr.progressingInstruction||xe&&C.nodeType===Nr.comment&&ct(/<[/\w]/g,C.data))return Ye(C),!0;if(!L[te]||ze[te]){if(!ze[te]&&ki(te)&&(se.tagNameCheck instanceof RegExp&&ct(se.tagNameCheck,te)||se.tagNameCheck instanceof Function&&se.tagNameCheck(te)))return!1;if(Me&&!we[te]){const _e=v(C)||C.parentNode,st=j(C)||C.childNodes;if(st&&_e){const Je=st.length;for(let xt=Je-1;xt>=0;--xt){const es=y(st[xt],!0);es.__removalCount=(C.__removalCount||0)+1,_e.insertBefore(es,p(C))}}}return Ye(C),!0}return C instanceof l&&!wt(C)||(te==="noscript"||te==="noembed"||te==="noframes")&&ct(/<\/no(script|embed|frames)/i,C.innerHTML)?(Ye(C),!0):(Q&&C.nodeType===Nr.text&&(H=C.textContent,sn([T,R,F],_e=>{H=yr(H,_e," ")}),C.textContent!==H&&(br(s.removed,{element:C.cloneNode()}),C.textContent=H)),Zt(D.afterSanitizeElements,C,null),!1)},Ei=function(C,H,te){if(ke&&(H==="id"||H==="name")&&(te in r||te in Ce))return!1;if(!(He&&!ie[H]&&ct(Z,H))){if(!(Ae&&ct(B,H))){if(!V[H]||ie[H]){if(!(ki(C)&&(se.tagNameCheck instanceof RegExp&&ct(se.tagNameCheck,C)||se.tagNameCheck instanceof Function&&se.tagNameCheck(C))&&(se.attributeNameCheck instanceof RegExp&&ct(se.attributeNameCheck,H)||se.attributeNameCheck instanceof Function&&se.attributeNameCheck(H))||H==="is"&&se.allowCustomizedBuiltInElements&&(se.tagNameCheck instanceof RegExp&&ct(se.tagNameCheck,te)||se.tagNameCheck instanceof Function&&se.tagNameCheck(te))))return!1}else if(!et[H]){if(!ct(_,yr(te,I,""))){if(!((H==="src"||H==="xlink:href"||H==="href")&&C!=="script"&&Sx(te,"data:")===0&&Jt[C])){if(!(Le&&!ct(Y,yr(te,I,"")))){if(te)return!1}}}}}}return!0},ki=function(C){return C!=="annotation-xml"&&po(C,P)},Ti=function(C){Zt(D.beforeSanitizeAttributes,C,null);const{attributes:H}=C;if(!H||ea(C))return;const te={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:V,forceKeepAttr:void 0};let _e=H.length;for(;_e--;){const st=H[_e],{name:Je,namespaceURI:xt,value:es}=st,xr=X(Je),ta=es;let rt=Je==="value"?ta:Cx(ta);if(te.attrName=xr,te.attrValue=rt,te.keepAttr=!0,te.forceKeepAttr=void 0,Zt(D.uponSanitizeAttribute,C,te),rt=te.attrValue,Qe&&(xr==="id"||xr==="name")&&($s(Je,C),rt=We+rt),xe&&ct(/((--!?|])>)|<\/(style|title)/i,rt)){$s(Je,C);continue}if(te.forceKeepAttr)continue;if(!te.keepAttr){$s(Je,C);continue}if(!ge&&ct(/\/>/i,rt)){$s(Je,C);continue}Q&&sn([T,R,F],Ai=>{rt=yr(rt,Ai," ")});const Pi=X(C.nodeName);if(!Ei(Pi,xr,rt)){$s(Je,C);continue}if(w&&typeof x=="object"&&typeof x.getAttributeType=="function"&&!xt)switch(x.getAttributeType(Pi,xr)){case"TrustedHTML":{rt=w.createHTML(rt);break}case"TrustedScriptURL":{rt=w.createScriptURL(rt);break}}if(rt!==ta)try{xt?C.setAttributeNS(xt,Je,rt):C.setAttribute(Je,rt),ea(C)?Ye(C):fo(s.removed)}catch{$s(Je,C)}}Zt(D.afterSanitizeAttributes,C,null)},Ld=function re(C){let H=null;const te=wi(C);for(Zt(D.beforeSanitizeShadowDOM,C,null);H=te.nextNode();)Zt(D.uponSanitizeShadowNode,H,null),Ci(H),Ti(H),H.content instanceof i&&re(H.content);Zt(D.afterSanitizeShadowDOM,C,null)};return s.sanitize=function(re){let C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},H=null,te=null,_e=null,st=null;if(Ct=!re,Ct&&(re="<!-->"),typeof re!="string"&&!Si(re))if(typeof re.toString=="function"){if(re=re.toString(),typeof re!="string")throw vr("dirty is not a string, aborting")}else throw vr("toString is not a function");if(!s.isSupported)return re;if(ee||lt(C),s.removed=[],typeof re=="string"&&(Ve=!1),Ve){if(re.nodeName){const es=X(re.nodeName);if(!L[es]||ze[es])throw vr("root node is forbidden and cannot be sanitized in-place")}}else if(re instanceof c)H=Ni("<!---->"),te=H.ownerDocument.importNode(re,!0),te.nodeType===Nr.element&&te.nodeName==="BODY"||te.nodeName==="HTML"?H=te:H.appendChild(te);else{if(!Ne&&!Q&&!G&&re.indexOf("<")===-1)return w&&ue?w.createHTML(re):re;if(H=Ni(re),!H)return Ne?null:ue?N:""}H&&ye&&Ye(H.firstChild);const Je=wi(Ve?re:H);for(;_e=Je.nextNode();)Ci(_e),Ti(_e),_e.content instanceof i&&Ld(_e.content);if(Ve)return re;if(Ne){if(Se)for(st=E.call(H.ownerDocument);H.firstChild;)st.appendChild(H.firstChild);else st=H;return(V.shadowroot||V.shadowrootmode)&&(st=z.call(n,st,!0)),st}let xt=G?H.outerHTML:H.innerHTML;return G&&L["!doctype"]&&H.ownerDocument&&H.ownerDocument.doctype&&H.ownerDocument.doctype.name&&ct(td,H.ownerDocument.doctype.name)&&(xt="<!DOCTYPE "+H.ownerDocument.doctype.name+`>
`+xt),Q&&sn([T,R,F],es=>{xt=yr(xt,es," ")}),w&&ue?w.createHTML(xt):xt},s.setConfig=function(){let re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};lt(re),ee=!0},s.clearConfig=function(){he=null,ee=!1},s.isValidAttribute=function(re,C,H){he||lt({});const te=X(re),_e=X(C);return Ei(te,_e,H)},s.addHook=function(re,C){typeof C=="function"&&br(D[re],C)},s.removeHook=function(re,C){if(C!==void 0){const H=Nx(D[re],C);return H===-1?void 0:wx(D[re],H,1)[0]}return fo(D[re])},s.removeHooks=function(re){D[re]=[]},s.removeAllHooks=function(){D=jo()},s}var Bx=sd();const cr=t=>Bx.sanitize(t,{ALLOWED_TAGS:["p","br","strong","em","u","h1","h2","h3","h4","h5","h6","ul","ol","li","blockquote","a","img","div","span","code","pre","iframe"],ALLOWED_ATTR:["href","src","alt","title","class","target","width","height","frameborder","allowfullscreen","allow","sandbox","loading"],ALLOW_DATA_ATTR:!1,ALLOW_UNKNOWN_PROTOCOLS:!1,FORBID_TAGS:["script","object","embed","link","style"],FORBID_ATTR:["onerror","onload","onclick","onmouseover"]}),Ux=({title:t})=>{const s=Ze();return e.jsxs(e.Fragment,{children:[e.jsxs($,{variant:"ghost",className:"mb-6 flex items-center gap-2",onClick:()=>s("/content"),children:[e.jsx(Yt,{size:18}),e.jsx("span",{children:"بازگشت به کتابخانه محتوا"})]}),e.jsx("div",{className:"flex justify-between items-start mb-6",children:e.jsx("h1",{className:"text-2xl font-bold text-right flex-1 ml-4",children:t})})]})},zx=iu,Hx=ou,qx=m.forwardRef(({className:t,inset:s,children:r,...n},a)=>e.jsxs(el,{ref:a,className:W("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",s&&"pl-8",t),...n,children:[r,e.jsx(vl,{className:"ml-auto h-4 w-4"})]}));qx.displayName=el.displayName;const Wx=m.forwardRef(({className:t,...s},r)=>e.jsx(tl,{ref:r,className:W("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...s}));Wx.displayName=tl.displayName;const rd=m.forwardRef(({className:t,sideOffset:s=4,...r},n)=>e.jsx(au,{children:e.jsx(sl,{ref:n,sideOffset:s,className:W("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...r})}));rd.displayName=sl.displayName;const Us=m.forwardRef(({className:t,inset:s,...r},n)=>e.jsx(rl,{ref:n,className:W("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s&&"pl-8",t),...r}));Us.displayName=rl.displayName;const Vx=m.forwardRef(({className:t,children:s,checked:r,...n},a)=>e.jsxs(nl,{ref:a,className:W("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:r,...n,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(al,{children:e.jsx(za,{className:"h-4 w-4"})})}),s]}));Vx.displayName=nl.displayName;const Gx=m.forwardRef(({className:t,children:s,...r},n)=>e.jsxs(il,{ref:n,className:W("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...r,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(al,{children:e.jsx(Au,{className:"h-2 w-2 fill-current"})})}),s]}));Gx.displayName=il.displayName;const Kx=m.forwardRef(({className:t,inset:s,...r},n)=>e.jsx(ol,{ref:n,className:W("px-2 py-1.5 text-sm font-semibold",s&&"pl-8",t),...r}));Kx.displayName=ol.displayName;const Qx=m.forwardRef(({className:t,...s},r)=>e.jsx(ll,{ref:r,className:W("-mx-1 my-1 h-px bg-muted",t),...s}));Qx.displayName=ll.displayName;const nd=({title:t,url:s=window.location.href})=>{const{toast:r}=ot(),n=()=>{const l=`https://t.me/share/url?url=${encodeURIComponent(s)}&text=${encodeURIComponent(t)}`;window.open(l,"_blank")},a=()=>{navigator.clipboard.writeText(`${t}
${s}`),r({title:"لینک کپی شد",description:"لینک در کلیپ‌بورد کپی شد. می‌توانید در استوری اینستاگرام استفاده کنید"})},i=()=>{const l=`https://twitter.com/intent/tweet?url=${encodeURIComponent(s)}&text=${encodeURIComponent(t)}`;window.open(l,"_blank")},o=()=>{const l=`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(s)}`;window.open(l,"_blank")},c=()=>{navigator.clipboard.writeText(s),r({title:"لینک کپی شد",description:"لینک در کلیپ‌بورد کپی شد"})};return e.jsxs(zx,{children:[e.jsx(Hx,{asChild:!0,children:e.jsx($,{variant:"outline",size:"icon",className:"rounded-full",children:e.jsx(Ks,{className:"h-5 w-5"})})}),e.jsxs(rd,{align:"end",className:"w-48",children:[e.jsxs(Us,{onClick:n,className:"flex items-center gap-2",children:[e.jsx("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm4.64 6.8c-.15 1.58-.8 5.42-1.13 7.19-.14.75-.42 1-.68 1.03-.58.05-1.02-.38-1.58-.75-.88-.58-1.38-.94-2.23-1.5-.99-.65-.35-1.01.22-1.59.15-.15 2.71-2.48 2.76-2.69.01-.03.01-.14-.07-.2-.08-.06-.19-.04-.27-.02-.11.02-1.91 1.21-5.41 3.56-.51.35-.98.52-1.4.51-.46-.01-1.35-.26-2.01-.47-.81-.27-1.46-.42-1.41-.88.03-.24.38-.49 1.05-.74 4.11-1.79 6.85-2.97 8.22-3.54 3.92-1.66 4.73-1.95 5.26-1.96.12 0 .38.03.55.18.14.12.18.28.2.4-.01.07.01.24-.03.37z"})}),"اشتراک در تلگرام"]}),e.jsxs(Us,{onClick:a,className:"flex items-center gap-2",children:[e.jsx(Bu,{className:"h-4 w-4"}),"اشتراک در اینستاگرام"]}),e.jsxs(Us,{onClick:i,className:"flex items-center gap-2",children:[e.jsx(Qu,{className:"h-4 w-4"}),"اشتراک در توییتر"]}),e.jsxs(Us,{onClick:o,className:"flex items-center gap-2",children:[e.jsx(Ou,{className:"h-4 w-4"}),"اشتراک در فیسبوک"]}),e.jsxs(Us,{onClick:c,className:"flex items-center gap-2",children:[e.jsx(Ks,{className:"h-4 w-4"}),"کپی لینک"]})]})]})},Jr=({articleId:t,title:s="محتوای جالب"})=>{const{toast:r}=ot(),{user:n}=Oe(),{addBookmark:a,removeBookmark:i,isBookmarked:o}=Kr(),[c,l]=m.useState(!1),d=async()=>{if(!n){r({title:"خطا",description:"برای بوکمارک کردن باید وارد شوید",variant:"destructive"});return}l(!0);try{o(t)?(await i(t),r({title:"موفقیت",description:"محتوا از نشان‌شده‌ها حذف شد",variant:"default"})):(await a(t),r({title:"موفقیت",description:"محتوا به نشان‌شده‌ها اضافه شد",variant:"default"}))}catch(h){console.error("Error toggling bookmark:",h),r({title:"خطا",description:h instanceof Error?h.message:"مشکلی در عملیات بوکمارک وجود دارد",variant:"destructive"})}finally{l(!1)}},u=o(t);return e.jsxs("div",{className:"flex gap-2",children:[e.jsx($,{variant:"outline",size:"icon",onClick:d,disabled:c,className:"rounded-full",children:c?e.jsx(bs,{className:"h-5 w-5 animate-spin"}):u?e.jsx(Ps,{className:"h-5 w-5 fill-current text-trader-600"}):e.jsx(yl,{className:"h-5 w-5"})}),e.jsx(nd,{title:s})]})},Yx=({content:t})=>"video_type"in t?e.jsx("div",{className:"w-full aspect-video bg-gray-100 rounded-lg mb-6 relative overflow-hidden",children:t.video_embed&&t.video_embed.trim()!==""?e.jsx("div",{className:"w-full h-full [&>iframe]:w-full [&>iframe]:h-full [&>iframe]:border-0 [&>iframe]:rounded-lg",dangerouslySetInnerHTML:{__html:cr(t.video_embed)}}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Is,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"ویدیو در دسترس نیست"})]})})}):"audio_url"in t?e.jsx("div",{className:"w-full bg-gray-100 rounded-lg mb-6 p-6 flex items-center",children:e.jsx("div",{className:"flex-1",children:t.thumbnail?e.jsx("img",{src:t.thumbnail,alt:t.title,className:"w-32 h-32 object-cover rounded-lg mx-auto",loading:"lazy"}):e.jsx("div",{className:"w-32 h-32 bg-gray-200 rounded-lg flex items-center justify-center mx-auto",children:e.jsx(Ju,{className:"h-12 w-12 text-gray-400"})})})}):t.thumbnail?e.jsx("img",{src:t.thumbnail,alt:t.title,className:"w-full h-64 object-cover rounded-lg mb-6",loading:"lazy"}):null,Jn=({author:t,publishDate:s,duration:r,viewCount:n,tags:a})=>e.jsxs("div",{className:"border-t border-gray-200 pt-8 mt-8",children:[e.jsxs("div",{className:"flex items-center gap-6 text-sm text-gray-500 mb-6 justify-end flex-wrap",children:[t&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(vs,{className:"h-4 w-4"}),e.jsx("span",{children:Gt(t)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Qt,{className:"h-4 w-4"}),e.jsx("span",{children:El(s)})]}),r&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Is,{className:"h-4 w-4"}),e.jsx("span",{children:r})]}),n!==void 0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ru,{className:"h-4 w-4"}),e.jsxs("span",{children:[n.toLocaleString()," بازدید"]})]})]}),a&&a.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 justify-end",children:a.map(i=>e.jsx("span",{className:"bg-trader-100 text-trader-800 text-xs px-3 py-1 rounded-full",children:i.name},i.id))})]}),Jx=()=>e.jsxs("div",{className:"mt-12 pt-8 border-t border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-right",children:"محتوای مرتبط"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsx("div",{className:"text-center text-gray-500 py-8",children:"محتوای مرتبط به‌زودی اضافه خواهد شد"})})]}),wn=m.forwardRef(({className:t,...s},r)=>e.jsx("textarea",{className:W("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 firefox-rtl-fix",t),ref:r,style:{WebkitAppearance:"none",MozAppearance:"none",appearance:"none"},...s}));wn.displayName="Textarea";const ui=m.forwardRef(({className:t,...s},r)=>e.jsx(cl,{ref:r,className:W("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...s}));ui.displayName=cl.displayName;const mi=m.forwardRef(({className:t,...s},r)=>e.jsx(dl,{ref:r,className:W("aspect-square h-full w-full",t),...s}));mi.displayName=dl.displayName;const hi=m.forwardRef(({className:t,...s},r)=>e.jsx(ul,{ref:r,className:W("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...s}));hi.displayName=ul.displayName;const Xr=({contentType:t,contentId:s,comments:r=[],onCommentAdd:n,onCommentDelete:a})=>{const{user:i}=Oe(),{toast:o}=ot(),[c,l]=m.useState(""),[d,u]=m.useState(!1),[h,f]=m.useState([]),[x,g]=m.useState(!0),[y,b]=m.useState(null),[p,j]=m.useState(null),[v,w]=m.useState(""),N=_=>{var L;return{id:_.id,author:_.author,content:_.content,created_at:_.created_at,parent:_.parent,is_approved:_.is_approved,replies:((L=_.replies)==null?void 0:L.map(q=>N(q)))||[]}},k=async()=>{try{g(!0);let _=[];switch(t){case"article":_=await Te.getArticleComments(s);break;case"video":_=await Te.getVideoComments(s);break;case"podcast":_=await Te.getPodcastComments(s);break;case"course":_=[];break;default:_=[]}const q=_.map(N).filter(F);f(q)}catch(_){console.error("Error loading comments:",_),o({title:"خطا در بارگذاری نظرات",description:"لطفا دوباره تلاش کنید",variant:"destructive"})}finally{g(!1)}};m.useEffect(()=>{k()},[t,s]);const S=async()=>{if(!i){o({title:"ورود مورد نیاز",description:"برای ثبت نظر ابتدا وارد شوید",variant:"destructive"});return}if(!c.trim()){o({title:"نظر خالی",description:"لطفا متن نظر خود را وارد کنید",variant:"destructive"});return}u(!0);try{let _;const L={content:c,parent:y};switch(t){case"article":_=await Te.createArticleComment(s,L);break;case"video":_=await Te.createVideoComment(s,L);break;case"podcast":_=await Te.createPodcastComment(s,L);break;case"course":throw new Error("نظرات دوره‌ها هنوز پشتیبانی نمی‌شود");default:throw new Error("نوع محتوای نامعلوم")}const q=N(_);F(q)&&f(y?V=>V.map(K=>K.id===y?{...K,replies:[q,...K.replies||[]]}:K):V=>[q,...V]),l(""),b(null),n&&n(q),o({title:"نظر ثبت شد",description:"نظر شما ثبت شد و پس از تایید منتشر خواهد شد"})}catch(_){console.error("Error submitting comment:",_),o({title:"خطا در ثبت نظر",description:"لطفا دوباره تلاش کنید",variant:"destructive"})}finally{u(!1)}},E=async _=>{if(!v.trim()){o({title:"نظر خالی",description:"لطفا متن نظر خود را وارد کنید",variant:"destructive"});return}try{await Te.updateMediaComment(_,v),f(L=>L.map(q=>q.id===_?{...q,content:v}:q.replies?{...q,replies:q.replies.map(V=>V.id===_?{...V,content:v}:V)}:q)),j(null),w(""),o({title:"نظر ویرایش شد",description:"نظر با موفقیت ویرایش شد"})}catch(L){console.error("Error editing comment:",L),o({title:"خطا در ویرایش نظر",description:"لطفا دوباره تلاش کنید",variant:"destructive"})}},A=async _=>{try{await Te.deleteMediaComment(_),f(L=>L.filter(q=>q.id===_?!1:(q.replies&&(q.replies=q.replies.filter(V=>V.id!==_)),!0))),a&&a(_),o({title:"نظر حذف شد",description:"نظر با موفقیت حذف شد"})}catch(L){console.error("Error deleting comment:",L),o({title:"خطا در حذف نظر",description:"لطفا دوباره تلاش کنید",variant:"destructive"})}},z=_=>{var q,V;const L=_.author||_.user;return L?`${((q=L.first_name)==null?void 0:q.charAt(0))||""}${((V=L.last_name)==null?void 0:V.charAt(0))||""}`.toUpperCase():"??"},D=_=>{const L=_.author||_.user;if(!L)return"کاربر ناشناس";const q=`${L.first_name||""} ${L.last_name||""}`.trim();return q||("username"in L&&L.username?L.username:"email"in L&&L.email?L.email:"کاربر")},T=_=>{const L=_.author||_.user;if(L&&"thumbnail"in L)return L.thumbnail},R=_=>{const L=_.author||_.user;return i&&L&&i.id===L.id},F=_=>{if(_.is_approved)return!0;const L=_.author||_.user;return i&&L&&i.id===L.id},Z=_=>{j(_.id),w(_.content)},B=()=>{j(null),w("")},Y=_=>{b(_),l("")},I=()=>{b(null),l("")},P=(_,L=!1)=>e.jsx(ne,{className:`${L?"mr-8 border-r-2 border-trader-200":"border-l-4 border-trader-200"}`,children:e.jsxs(ae,{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(ui,{className:"h-10 w-10",children:[e.jsx(mi,{src:T(_)}),e.jsx(hi,{className:"bg-trader-100 text-trader-700",children:z(_)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:D(_)}),e.jsx("p",{className:"text-xs text-gray-500",children:El(_.created_at)})]})]}),e.jsxs("div",{className:"flex gap-1",children:[!L&&e.jsx($,{variant:"ghost",size:"sm",onClick:()=>Y(_.id),className:"text-gray-500 hover:text-trader-600",children:e.jsx(Wu,{className:"h-4 w-4"})}),R(_)&&e.jsxs(e.Fragment,{children:[e.jsx($,{variant:"ghost",size:"sm",onClick:()=>Z(_),className:"text-gray-500 hover:text-blue-600",children:e.jsx(qu,{className:"h-4 w-4"})}),e.jsx($,{variant:"ghost",size:"sm",onClick:()=>A(_.id),className:"text-gray-500 hover:text-red-600",children:e.jsx(Na,{className:"h-4 w-4"})})]})]})]}),p===_.id?e.jsxs("div",{className:"space-y-2",children:[e.jsx(wn,{value:v,onChange:q=>w(q.target.value),className:"min-h-[80px] text-right",dir:"rtl"}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx($,{size:"sm",onClick:()=>E(_.id),className:"bg-trader-500 hover:bg-trader-600",children:"ذخیره"}),e.jsx($,{size:"sm",variant:"outline",onClick:B,children:"لغو"})]})]}):e.jsx("p",{className:"text-gray-700 leading-relaxed text-right",dir:"rtl",children:_.content}),_.replies&&_.replies.length>0&&e.jsx("div",{className:"mt-4 space-y-3",children:_.replies.filter(F).map(q=>P(q,!0))})]})},_.id);return x?e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(ia,{className:"h-5 w-5 text-trader-500"}),e.jsx("h3",{className:"text-lg font-semibold",children:"در حال بارگذاری نظرات..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(ia,{className:"h-5 w-5 text-trader-500"}),e.jsxs("h3",{className:"text-lg font-semibold",children:["نظرات (",h.length,")"]})]}),i?e.jsx(ne,{children:e.jsx(ae,{className:"p-4",children:e.jsxs("div",{className:"space-y-4",children:[y&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx("span",{children:"در پاسخ به نظر"}),e.jsx($,{variant:"outline",size:"sm",onClick:I,children:"لغو پاسخ"})]}),e.jsx(wn,{placeholder:y?"پاسخ خود را بنویسید...":"نظر خود را بنویسید...",value:c,onChange:_=>l(_.target.value),className:"min-h-[100px] text-right",dir:"rtl"}),e.jsx("div",{className:"flex justify-end",children:e.jsx($,{onClick:S,disabled:d||!c.trim(),className:"bg-trader-500 hover:bg-trader-600",children:d?"در حال ثبت...":y?"ثبت پاسخ":"ثبت نظر"})})]})})}):e.jsx(ne,{children:e.jsxs(ae,{className:"p-4 text-center",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"برای ثبت نظر ابتدا وارد شوید"}),e.jsx($,{variant:"outline",onClick:()=>window.location.href="/login",children:"ورود به حساب کاربری"})]})}),e.jsx("div",{className:"space-y-4",children:h.length>0?h.map(_=>P(_)):e.jsx(ne,{children:e.jsxs(ae,{className:"p-8 text-center",children:[e.jsx(ia,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"هنوز نظری ثبت نشده است"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"اولین نفری باشید که نظر می‌دهد!"})]})})})]})},Xx=()=>{const{id:t,type:s}=Ms(),r=Ze(),{toast:n}=ot(),{bookmarks:a,addBookmark:i,removeBookmark:o}=as(),[c,l]=m.useState(null),[d,u]=m.useState(!1),[h,f]=m.useState(!0),[x,g]=m.useState(null);m.useEffect(()=>{(async()=>{if(console.log("ContentDetailPage: Fetching content for ID:",t,"Type:",s),!t||!s){console.error("ContentDetailPage: Missing ID or type parameters"),g("پارامترهای مورد نیاز یافت نشد"),f(!1);return}try{f(!0),g(null);let p;const j=s.replace(/s$/,"");switch(console.log("ContentDetailPage: Normalized content type:",j),j){case"article":console.log("ContentDetailPage: Fetching article with ID:",t),p=await Tr.getById(t);break;case"video":console.log("ContentDetailPage: Fetching video with ID:",t),p=await dn.getById(t);break;case"podcast":console.log("ContentDetailPage: Fetching podcast with ID:",t),p=await Pr.getById(t);break;default:console.error("ContentDetailPage: Unknown content type:",j),g("نوع محتوای نامشخص"),f(!1);return}if(console.log("ContentDetailPage: Fetched data:",p),!p){console.error("ContentDetailPage: No data received for ID:",t),g("محتوا یافت نشد"),f(!1);return}l(p);const v=a.some(w=>w.itemId===t&&w.itemType===j);u(v),console.log("ContentDetailPage: Content loaded successfully, bookmarked:",v)}catch(p){console.error("ContentDetailPage: Error fetching content:",p),g("خطا در دریافت محتوا"),n({title:"خطا در دریافت محتوا",description:"لطفا دوباره تلاش کنید",variant:"destructive"})}finally{f(!1)}})()},[t,s,r,n,a]);const y=U.useCallback(()=>{if(!c||!t||!s)return;const b=s.replace(/s$/,"");if(d){const p=a.find(j=>j.itemId===t&&j.itemType===b);p&&(o(p.id),u(!1),n({title:"نشان حذف شد",description:"این محتوا از نشان‌های شما حذف شد"}))}else i(t,b,"user1"),u(!0),n({title:"به نشان‌ها اضافه شد",description:"این محتوا به نشان‌های شما اضافه شد"})},[c,t,s,d,a,o,i,n]);return h?e.jsx(de,{children:e.jsx("div",{className:"trader-container py-8",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-6"}),e.jsx("div",{className:"h-64 bg-gray-200 rounded mb-6"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-4"})]})})}):x||!c?e.jsx(de,{children:e.jsx("div",{className:"trader-container py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg text-gray-600 mb-4",children:x||"محتوای مورد نظر یافت نشد"}),e.jsx($,{onClick:()=>r("/content"),className:"mx-auto bg-trader-500 hover:bg-trader-600",children:"بازگشت به کتابخانه محتوا"})]})})}):e.jsx(Qr,{children:e.jsx(de,{children:e.jsx("div",{className:"trader-container py-8",children:e.jsx(ne,{className:"border-none shadow-md",children:e.jsxs(ae,{className:"p-6",children:[e.jsx(Ux,{title:c.title}),e.jsx("div",{className:"flex justify-end mb-6",children:e.jsx(Jr,{isBookmarked:d,onBookmark:y,title:c.title})}),e.jsx(Yx,{content:c}),"content"in c?e.jsx("div",{className:"prose prose-lg max-w-none text-right prose-headings:text-right prose-p:text-right mb-12",dir:"rtl",dangerouslySetInnerHTML:{__html:cr(c.content)}}):e.jsx("div",{className:"prose prose-lg max-w-none text-right prose-headings:text-right prose-p:text-right mb-12",dir:"rtl",dangerouslySetInnerHTML:{__html:cr(c.description)}}),e.jsx(Jn,{author:c.author,publishDate:"published"in c?c.published:c.created_at,duration:"duration"in c?c.duration:void 0,viewCount:"view_count"in c?c.view_count:void 0,tags:c.tags}),e.jsx("div",{className:"mt-12 pt-8 border-t border-gray-200",children:e.jsx(Xr,{contentType:s==null?void 0:s.replace(/s$/,""),contentId:t})}),e.jsx("div",{className:"mt-12",children:e.jsx(Jx,{})})]})})})})})},Zx=()=>{const{id:t}=Ms(),s=Ze(),{toast:r}=ot(),[n,a]=m.useState(null),[i,o]=m.useState(!0);return m.useEffect(()=>{(async()=>{if(!t){s("/content");return}try{o(!0);const l=await Tr.getById(t);if(!l){s("/content");return}a(l)}catch(l){console.error("Error fetching article:",l),r({title:"خطا در دریافت مقاله",description:"لطفا دوباره تلاش کنید",variant:"destructive"}),s("/content")}finally{o(!1)}})()},[t,s,r]),i?e.jsx(de,{children:e.jsx("div",{className:"trader-container py-8",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-6"}),e.jsx("div",{className:"h-64 bg-gray-200 rounded mb-6"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-4"})]})})}):n?e.jsx(Qr,{children:e.jsx(de,{children:e.jsxs("div",{className:"trader-container py-8",children:[e.jsxs($,{variant:"ghost",className:"mb-6 flex items-center gap-2",onClick:()=>s("/content"),children:[e.jsx(Yt,{size:18}),e.jsx("span",{children:"بازگشت به کتابخانه محتوا"})]}),e.jsx(ne,{className:"border-none shadow-md",children:e.jsxs(ae,{className:"p-6",children:[e.jsx("div",{className:"flex justify-between items-start mb-6",children:e.jsx("h1",{className:"text-2xl font-bold text-right flex-1 ml-4",children:n.title})}),e.jsx("div",{className:"flex justify-end mb-6",children:e.jsx(Jr,{articleId:n.id,title:n.title})}),n.thumbnail&&e.jsx("img",{src:n.thumbnail,alt:n.title,className:"w-full h-64 object-cover rounded-lg mb-6",loading:"lazy"}),e.jsx("div",{className:"prose prose-lg max-w-none text-right prose-headings:text-right prose-p:text-right mb-12",dir:"rtl",dangerouslySetInnerHTML:{__html:cr(n.content)}}),e.jsx(Jn,{author:n.author,publishDate:n.published,viewCount:n.view_count,tags:n.tags}),e.jsx("div",{className:"mt-12 pt-8 border-t border-gray-200",children:e.jsx(Xr,{contentType:"article",contentId:t})}),e.jsxs("div",{className:"mt-12 pt-8 border-t border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-right",children:"مقالات مرتبط"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsx("div",{className:"text-center text-gray-500 py-8",children:"مقالات مرتبط به‌زودی اضافه خواهد شد"})})]})]})})]})})}):e.jsx(de,{children:e.jsx("div",{className:"trader-container py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg text-gray-600 mb-4",children:"مقاله مورد نظر یافت نشد"}),e.jsx($,{onClick:()=>s("/content"),className:"mx-auto",children:"بازگشت به کتابخانه محتوا"})]})})})},eg=()=>{const{id:t}=Ms(),s=Ze(),{toast:r}=ot(),[n,a]=m.useState(null),[i,o]=m.useState(!0),[c,l]=m.useState(!1),[d,u]=m.useState(0),[h,f]=m.useState(0),[x,g]=m.useState(null);m.useEffect(()=>{(async()=>{if(!t){s("/content");return}try{o(!0);const N=await Pr.getById(t);if(!N){s("/content");return}a(N)}catch(N){console.error("Error fetching podcast:",N),r({title:"خطا در دریافت پادکست",description:"لطفا دوباره تلاش کنید",variant:"destructive"}),s("/content")}finally{o(!1)}})()},[t,s,r]),m.useEffect(()=>{if(n&&n.audio_url){const w=new Audio(n.audio_url);return w.addEventListener("timeupdate",()=>{u(w.currentTime)}),w.addEventListener("loadedmetadata",()=>{f(w.duration)}),w.addEventListener("ended",()=>{l(!1)}),g(w),()=>{w.pause(),w.removeEventListener("timeupdate",()=>{}),w.removeEventListener("loadedmetadata",()=>{}),w.removeEventListener("ended",()=>{})}}},[n]);const y=()=>{x&&(c?x.pause():x.play(),l(!c))},b=()=>{x&&(x.currentTime=Math.min(x.currentTime+30,h))},p=()=>{x&&(x.currentTime=Math.max(x.currentTime-30,0))},j=w=>{if(x){const N=parseFloat(w.target.value)/100*h;x.currentTime=N,u(N)}},v=w=>{const N=Math.floor(w/3600),k=Math.floor(w%3600/60),S=Math.floor(w%60);return N>0?`${N}:${k.toString().padStart(2,"0")}:${S.toString().padStart(2,"0")}`:`${k}:${S.toString().padStart(2,"0")}`};return i?e.jsx(de,{children:e.jsx("div",{className:"trader-container py-8",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-6"}),e.jsx("div",{className:"h-64 bg-gray-200 rounded mb-6"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-4"})]})})}):n?e.jsx(Qr,{children:e.jsx(de,{children:e.jsxs("div",{className:"trader-container py-8",children:[e.jsxs($,{variant:"ghost",className:"mb-6 flex items-center gap-2",onClick:()=>s("/content"),children:[e.jsx(Yt,{size:18}),e.jsx("span",{children:"بازگشت به کتابخانه محتوا"})]}),e.jsx(ne,{className:"border-none shadow-md",children:e.jsxs(ae,{className:"p-6",children:[e.jsx("div",{className:"flex justify-between items-start mb-6",children:e.jsx("h1",{className:"text-2xl font-bold text-right flex-1 ml-4",children:n.title})}),e.jsx("div",{className:"flex justify-end mb-6",children:e.jsx(Jr,{articleId:n.id,title:n.title})}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-6 mb-8",children:[n.thumbnail&&e.jsx("div",{className:"md:w-1/3",children:e.jsx("img",{src:n.thumbnail,alt:n.title,className:"w-full h-64 md:h-80 object-cover rounded-lg",loading:"lazy"})}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-center gap-4 mb-4",children:[e.jsx($,{variant:"outline",size:"sm",onClick:p,className:"rounded-full",children:e.jsx(Gu,{size:16})}),e.jsx($,{onClick:y,className:"rounded-full w-12 h-12 bg-trader-500 hover:bg-trader-600",children:c?e.jsx(Hu,{size:20}):e.jsx(Is,{size:20})}),e.jsx($,{variant:"outline",size:"sm",onClick:b,className:"rounded-full",children:e.jsx(wl,{size:16})})]}),e.jsx("div",{className:"mb-2",children:e.jsx("input",{type:"range",min:"0",max:"100",value:h?d/h*100:0,onChange:j,className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider"})}),e.jsxs("div",{className:"flex justify-between text-sm text-gray-600",children:[e.jsx("span",{children:v(d)}),e.jsx("span",{children:v(h)})]}),e.jsxs("div",{className:"mt-4 space-y-2 text-sm",children:[n.episode_number&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"قسمت:"}),e.jsx("span",{className:"font-medium",children:n.episode_number})]}),n.season_number&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"فصل:"}),e.jsx("span",{className:"font-medium",children:n.season_number})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"مدت زمان:"}),e.jsx("span",{className:"font-medium",children:n.duration})]})]})]})})]}),e.jsx("div",{className:"prose prose-lg max-w-none text-right prose-headings:text-right prose-p:text-right mb-12",dir:"rtl",dangerouslySetInnerHTML:{__html:cr(n.description)}}),n.transcript&&e.jsxs("div",{className:"mb-12",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-right",children:"متن پیاده‌شده"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-6 prose prose-sm max-w-none text-right",dir:"rtl",dangerouslySetInnerHTML:{__html:cr(n.transcript)}})]}),e.jsx(Jn,{author:n.author,publishDate:n.date,duration:n.duration,viewCount:n.view_count,tags:n.tags}),e.jsx("div",{className:"mt-12 pt-8 border-t border-gray-200",children:e.jsx(Xr,{contentType:"podcast",contentId:t})}),e.jsxs("div",{className:"mt-12 pt-8 border-t border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-right",children:"پادکست‌های مرتبط"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsx("div",{className:"text-center text-gray-500 py-8",children:"پادکست‌های مرتبط به‌زودی اضافه خواهد شد"})})]})]})})]})})}):e.jsx(de,{children:e.jsx("div",{className:"trader-container py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg text-gray-600 mb-4",children:"پادکست مورد نظر یافت نشد"}),e.jsx($,{onClick:()=>s("/content"),className:"mx-auto",children:"بازگشت به کتابخانه محتوا"})]})})})},tg=Wr("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Ee({className:t,variant:s,...r}){return e.jsx("div",{className:W(tg({variant:s}),t),...r})}const sg=({status:t,className:s=""})=>{const n=(()=>{switch(t){case"live":return{label:"🔴 زنده",className:"bg-red-500 text-white animate-pulse"};case"scheduled":return{label:"⏰ برنامه‌ریزی شده",className:"bg-blue-500 text-white"};case"ended":return{label:"✅ پایان یافته",className:"bg-gray-500 text-white"};default:return{label:t,className:"bg-gray-500 text-white"}}})();return e.jsx(Ee,{className:`${n.className} ${s}`,children:n.label})},rg=({livestream:t})=>{const s=n=>{if(!n)return"زمان شروع مشخص نشده";try{return new Date(n).toLocaleString("fa-IR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return n}},r=n=>{if(!n)return null;try{const a=new Date(n),i=new Date,o=a.getTime()-i.getTime();if(o<=0)return null;const c=Math.floor(o/(1e3*60*60*24)),l=Math.floor(o%(1e3*60*60*24)/(1e3*60*60)),d=Math.floor(o%(1e3*60*60)/(1e3*60));return c>0?`${c} روز و ${l} ساعت دیگر`:l>0?`${l} ساعت و ${d} دقیقه دیگر`:`${d} دقیقه دیگر`}catch{return null}};return t.stream_status==="live"&&t.stream_url?e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"bg-black rounded-lg overflow-hidden",children:e.jsx("iframe",{src:t.stream_url,className:"w-full h-96 md:h-[500px]",frameBorder:"0",allowFullScreen:!0,title:t.title})}),e.jsx("div",{className:"absolute top-4 right-4",children:e.jsx("div",{className:"bg-red-500 text-white px-3 py-1 rounded-full text-sm font-medium animate-pulse",children:"🔴 زنده"})})]}):e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:t.thumbnail,alt:t.title,className:"w-full h-64 md:h-80 object-cover rounded-lg",loading:"lazy"}),t.stream_status==="scheduled"&&e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center rounded-lg",children:e.jsxs("div",{className:"text-center text-white",children:[e.jsx(Qt,{className:"w-16 h-16 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:"هنوز شروع نشده"}),e.jsx("p",{className:"text-lg",children:s(t.start_at)}),r(t.start_at)&&e.jsx("p",{className:"text-sm mt-2",children:r(t.start_at)})]})}),t.stream_status==="ended"&&e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center rounded-lg",children:e.jsxs("div",{className:"text-center text-white",children:[e.jsx(Is,{className:"w-16 h-16 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:"پایان یافته"}),e.jsx("p",{className:"text-sm",children:"این لایو استریم به پایان رسیده است"})]})})]})},No=()=>{const{id:t}=Ms(),s=Ze(),{toast:r}=ot(),[n,a]=m.useState(null),[i,o]=m.useState(!0);return m.useEffect(()=>{(async()=>{if(!t){s("/content");return}try{o(!0);const l=await un.getById(t);if(!l){s("/content");return}a(l)}catch(l){console.error("Error fetching livestream:",l),r({title:"خطا در دریافت لایو استریم",description:"لطفا دوباره تلاش کنید",variant:"destructive"}),s("/content")}finally{o(!1)}})()},[t,s,r]),i?e.jsx(de,{children:e.jsx("div",{className:"trader-container py-8",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-6"}),e.jsx("div",{className:"h-64 bg-gray-200 rounded mb-6"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-4"})]})})}):n?e.jsx(Qr,{children:e.jsx(de,{children:e.jsxs("div",{className:"trader-container py-8",children:[e.jsxs($,{variant:"ghost",className:"mb-6 flex items-center gap-2",onClick:()=>s("/content"),children:[e.jsx(Yt,{size:18}),e.jsx("span",{children:"بازگشت به کتابخانه محتوا"})]}),e.jsx(ne,{className:"border-none shadow-md",children:e.jsxs(ae,{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(sg,{status:n.stream_status}),n.featured&&e.jsx(Ee,{className:"bg-yellow-500 text-white",children:"⭐ ویژه"})]}),e.jsx("h1",{className:"text-2xl font-bold text-right flex-1 ml-4",children:n.title})]}),e.jsx("div",{className:"flex justify-end mb-6",children:e.jsx(Jr,{articleId:n.id.toString(),title:n.title})}),e.jsx("div",{className:"mb-8",children:e.jsx(rg,{livestream:n})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-gray-50 rounded-lg",children:[e.jsx(vs,{className:"w-5 h-5 text-gray-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"برگزار کننده"}),e.jsx("p",{className:"font-medium",children:Gt(n.author)})]})]}),e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-gray-50 rounded-lg",children:[e.jsx(Tn,{className:"w-5 h-5 text-gray-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"تاریخ شروع"}),e.jsx("p",{className:"font-medium",children:Xu(n.start_at)})]})]}),e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-gray-50 rounded-lg",children:[e.jsx(Or,{className:"w-5 h-5 text-gray-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"بینندگان فعلی"}),e.jsx("p",{className:"font-medium",children:n.current_viewers.toLocaleString()})]})]}),e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-gray-50 rounded-lg",children:[e.jsx(Or,{className:"w-5 h-5 text-gray-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"بازدید کل"}),e.jsx("p",{className:"font-medium",children:n.view_count.toLocaleString()})]})]})]}),n.description&&e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-right",children:"توضیحات"}),e.jsx("p",{className:"text-gray-700 text-right leading-relaxed",children:n.description})]}),n.category&&e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-right",children:"دسته‌بندی"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ee,{className:"bg-trader-100 text-trader-800",children:n.category.name}),n.category.description&&e.jsx("p",{className:"text-sm text-gray-600 text-right",children:n.category.description})]})]}),n.tags&&n.tags.length>0&&e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-right",children:"برچسب‌ها"}),e.jsx("div",{className:"flex flex-wrap gap-2 justify-end",children:n.tags.map(c=>e.jsx(Ee,{variant:"outline",children:c.name},c.id))})]}),e.jsx(Jn,{author:n.author,publishDate:n.created_at,viewCount:n.view_count,tags:n.tags}),e.jsx("div",{className:"mt-12 pt-8 border-t border-gray-200",children:e.jsx(Xr,{contentType:"livestream",contentId:t})}),e.jsxs("div",{className:"mt-12 pt-8 border-t border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-right",children:"لایو استریم‌های مرتبط"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsx("div",{className:"text-center text-gray-500 py-8",children:"لایو استریم‌های مرتبط به‌زودی اضافه خواهد شد"})})]})]})})]})})}):e.jsx(de,{children:e.jsx("div",{className:"trader-container py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg text-gray-600 mb-4",children:"لایو استریم مورد نظر یافت نشد"}),e.jsx($,{onClick:()=>s("/content"),className:"mx-auto",children:"بازگشت به کتابخانه محتوا"})]})})})},ng=()=>{const{myCourses:t,isLoading:s}=Un(),{user:r}=Oe(),[n,a]=m.useState(!0);return m.useEffect(()=>{console.log("MyCoursesPage - myCourses data:",t),console.log("MyCoursesPage - myCourses length:",t.length),a(s.myCourses)},[t,s]),r?(console.log("MyCoursesPage render - localLoading:",n,"myCourses:",t),e.jsx(de,{children:e.jsxs("div",{className:"trader-container py-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6 fade-in",children:"دوره‌های من"}),n?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:Array.from({length:8}).map((i,o)=>e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden animate-pulse",children:[e.jsx("div",{className:"w-full h-48 bg-gray-300"}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"h-4 bg-gray-300 rounded mb-2"}),e.jsx("div",{className:"h-3 bg-gray-300 rounded mb-4"}),e.jsx("div",{className:"h-2 bg-gray-300 rounded mb-1"}),e.jsx("div",{className:"h-2 bg-gray-300 rounded mb-4"}),e.jsx("div",{className:"h-8 bg-gray-300 rounded"})]})]},`skeleton-${o}`))}):t.length>0?e.jsx("div",{className:"fade-in",children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:t.map(i=>{var o;return e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[e.jsx(me,{to:`/courses/${i.id}`,children:e.jsx("img",{src:i.thumbnail,alt:i.title,className:"w-full h-48 object-cover",onError:c=>{console.log("Image load error for course:",i.id,i.thumbnail);const l=c.target;l.src="/placeholder.svg"}})}),e.jsxs("div",{className:"p-4",children:[e.jsx(me,{to:`/courses/${i.id}`,children:e.jsx("h3",{className:"font-bold text-lg mb-2 hover:text-trader-500 transition-colors",children:i.title})}),e.jsx("p",{className:"text-gray-600 text-sm mb-4",children:i.instructor}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{children:"پیشرفت دوره"}),e.jsxs("span",{children:[((o=i.progress_percentage)==null?void 0:o.toFixed(1))||0,"%"]})]}),e.jsx("div",{className:"w-full h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-trader-500 rounded-full transition-all duration-300",style:{width:`${i.progress_percentage||0}%`}})})]}),e.jsx($,{asChild:!0,className:"w-full bg-trader-500 hover:bg-trader-600",children:e.jsx(me,{to:`/courses/${i.id}`,children:"ادامه دوره"})})]})]},i.id)})})}):e.jsx("div",{className:"scale-in",children:e.jsx(zr,{icon:e.jsx(ur,{className:"h-16 w-16"}),title:"هنوز در دوره‌ای ثبت‌نام نکرده‌اید",description:"از بین دوره‌های متنوع ما، دوره‌های مورد علاقه خود را انتخاب کنید",action:e.jsx($,{asChild:!0,className:"mt-4 bg-trader-500 hover:bg-trader-600 btn-click",children:e.jsx(me,{to:"/",children:"مشاهده دوره‌ها"})})})})]})})):e.jsx(de,{children:e.jsxs("div",{className:"trader-container py-12 text-center fade-in",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"برای مشاهده دوره‌های خود ابتدا وارد شوید"}),e.jsx(me,{to:"/login",className:"trader-btn-primary btn-click",children:"ورود به حساب کاربری"})]})})},ag=()=>{const{user:t}=Oe(),{bookmarks:s,articles:r,isLoading:n}=Kr(),[a,i]=m.useState("articles");if(!t)return window.location.href="/login",null;const c=(()=>{const l=s.map(d=>d.article.id);return r.filter(d=>l.includes(d.id))})();return n.bookmarks||n.articles?e.jsx(de,{children:e.jsxs("div",{className:"trader-container py-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(Ps,{className:"h-5 w-5 text-trader-500"}),e.jsx("h1",{className:"text-2xl font-bold",children:"نشان‌های من"})]}),e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-6"}),e.jsx("div",{className:"space-y-4",children:[...Array(3)].map((l,d)=>e.jsx("div",{className:"h-32 bg-gray-200 rounded"},d))})]})]})}):e.jsx(de,{children:e.jsxs("div",{className:"trader-container py-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(Ps,{className:"h-5 w-5 text-trader-500"}),e.jsx("h1",{className:"text-2xl font-bold",children:"نشان‌های من"})]}),e.jsx("div",{className:"mb-6 border-b border-gray-200 overflow-x-auto pb-1",children:e.jsx("div",{className:"flex gap-4",children:e.jsxs("button",{onClick:()=>i("articles"),className:`py-2 px-1 font-medium text-sm whitespace-nowrap ${a==="articles"?"text-trader-500 border-b-2 border-trader-500":"text-gray-600"}`,children:["مقالات (",s.length,")"]})})}),e.jsx("div",{children:c.length===0?e.jsx(zr,{icon:e.jsx(Ps,{className:"h-16 w-16"}),title:"هنوز مقاله‌ای نشان نکرده‌اید",description:"مقالات مورد علاقه خود را نشان کنید تا بعداً به آن‌ها دسترسی داشته باشید",action:e.jsx($,{asChild:!0,className:"mt-4 bg-trader-500 hover:bg-trader-600",children:e.jsx(me,{to:"/content",children:"مشاهده محتوا"})})}):e.jsx("div",{className:"flex flex-col gap-4",children:c.map(l=>e.jsx(cs,{id:l.id,title:l.title,description:l.description,thumbnail:l.thumbnail,type:"article",date:l.date,author:l.author},l.id))})})]})})},ig=()=>{const{user:t,logout:s}=Oe(),[r,n]=m.useState(!1);if(m.useEffect(()=>{n(!0)},[]),!t)return e.jsx(de,{children:e.jsxs("div",{className:"trader-container py-12 text-center",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"برای مشاهده پروفایل خود ابتدا وارد شوید"}),e.jsx(me,{to:"/login",className:"trader-btn-primary",children:"ورود به حساب کاربری"})]})});const a=[{icon:e.jsx(Tn,{className:"h-5 w-5"}),title:"دوره‌های من",description:"مشاهده و ادامه دوره‌های خریداری شده",path:"/my-courses"},{icon:e.jsx(Ps,{className:"h-5 w-5"}),title:"نشان‌های من",description:"محتوای ذخیره شده شما",path:"/bookmarks"},{icon:e.jsx(vs,{className:"h-5 w-5"}),title:"اطلاعات شخصی",description:"ویرایش پروفایل و مشخصات کاربری",path:"/edit-profile"}];return e.jsx(de,{children:e.jsxs("div",{className:"trader-container py-6",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-md p-6 mb-6 scale-in",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-20 h-20 rounded-full overflow-hidden ml-4",children:e.jsx("img",{src:t.avatar,alt:t.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold mb-1",children:t.name}),e.jsx("p",{className:"text-gray-500 text-sm",children:t.email})]})]})}),e.jsxs("div",{className:"grid gap-4",children:[a.map((i,o)=>e.jsxs(me,{to:i.path,className:`bg-white rounded-xl shadow-md p-4 flex items-center hover:shadow-lg transition-all duration-300 hover:bg-gray-50 ${r?"opacity-0 animate-slide-in":""}`,style:{animationDelay:r?`${o*100}ms`:"0ms",animationFillMode:"forwards"},children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-trader-50 text-trader-500 flex items-center justify-center ml-4",children:i.icon}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-base",children:i.title}),e.jsx("p",{className:"text-gray-500 text-sm",children:i.description})]})]},o)),e.jsx("button",{onClick:()=>s(),className:"mt-4 w-full py-3 border border-red-500 text-red-500 rounded-xl font-medium hover:bg-red-50 transition-colors duration-200 btn-click",children:"خروج از حساب کاربری"})]})]})})},og=Wr("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Ws=m.forwardRef(({className:t,...s},r)=>e.jsx(ml,{ref:r,className:W(og(),t),...s}));Ws.displayName=ml.displayName;const ad=fu,id=m.createContext({}),gn=({...t})=>e.jsx(id.Provider,{value:{name:t.name},children:e.jsx(pu,{...t})}),Xn=()=>{const t=m.useContext(id),s=m.useContext(od),{getFieldState:r,formState:n}=hu(),a=r(t.name,n);if(!t)throw new Error("useFormField should be used within <FormField>");const{id:i}=s;return{id:i,name:t.name,formItemId:`${i}-form-item`,formDescriptionId:`${i}-form-item-description`,formMessageId:`${i}-form-item-message`,...a}},od=m.createContext({}),fi=m.forwardRef(({className:t,...s},r)=>{const n=m.useId();return e.jsx(od.Provider,{value:{id:n},children:e.jsx("div",{ref:r,className:W("space-y-2",t),...s})})});fi.displayName="FormItem";const pi=m.forwardRef(({className:t,...s},r)=>{const{error:n,formItemId:a}=Xn();return e.jsx(Ws,{ref:r,className:W(n&&"text-destructive",t),htmlFor:a,...s})});pi.displayName="FormLabel";const xi=m.forwardRef(({...t},s)=>{const{error:r,formItemId:n,formDescriptionId:a,formMessageId:i}=Xn();return e.jsx(Fo,{ref:s,id:n,"aria-describedby":r?`${a} ${i}`:`${a}`,"aria-invalid":!!r,...t})});xi.displayName="FormControl";const ld=m.forwardRef(({className:t,...s},r)=>{const{formDescriptionId:n}=Xn();return e.jsx("p",{ref:r,id:n,className:W("text-sm text-muted-foreground",t),...s})});ld.displayName="FormDescription";const gi=m.forwardRef(({className:t,children:s,...r},n)=>{const{error:a,formMessageId:i}=Xn(),o=a?String(a==null?void 0:a.message):s;return o?e.jsx("p",{ref:n,id:i,className:W("text-sm font-medium text-destructive",t),...r,children:o}):null});gi.displayName="FormMessage";var lg=function(t,s){for(var r={};t.length;){var n=t[0],a=n.code,i=n.message,o=n.path.join(".");if(!r[o])if("unionErrors"in n){var c=n.unionErrors[0].errors[0];r[o]={message:c.message,type:c.code}}else r[o]={message:i,type:a};if("unionErrors"in n&&n.unionErrors.forEach(function(u){return u.errors.forEach(function(h){return t.push(h)})}),s){var l=r[o].types,d=l&&l[n.code];r[o]=bu(o,s,r,a,d?[].concat(d,n.message):n.message)}t.shift()}return r},cd=function(t,s,r){return r===void 0&&(r={}),function(n,a,i){try{return Promise.resolve(function(o,c){try{var l=Promise.resolve(t[r.mode==="sync"?"parse":"parseAsync"](n,s)).then(function(d){return i.shouldUseNativeValidation&&xu({},i),{errors:{},values:r.raw?n:d}})}catch(d){return c(d)}return l&&l.then?l.then(void 0,c):l}(0,function(o){if(function(c){return Array.isArray(c==null?void 0:c.errors)}(o))return{values:{},errors:gu(lg(o.errors,!i.shouldUseNativeValidation&&i.criteriaMode==="all"),i)};throw o}))}catch(o){return Promise.reject(o)}}};const cg=fl({amount:yu().min(1e4,"حداقل مبلغ شارژ ۱۰ هزار تومان است").max(1e8,"حداکثر مبلغ شارژ ۱۰۰ میلیون تومان است")}),is=t=>{const s=typeof t=="string"?parseFloat(t):t;return Xe(s)},dg=t=>{const s=typeof t=="string"?parseFloat(t):t;return s>=1e9?`${fn(Math.round(s/1e9))} میلیارد تومان`:s>=1e6?`${fn(Math.round(s/1e6))} میلیون تومان`:s>=1e3?`${fn(Math.round(s/1e3))} هزار تومان`:Xe(s)},ug=()=>{const t=Ze(),{wallet:s,courses:r,loadingStates:n,errors:a,refetchWallet:i}=as(),{user:o,isLoading:c}=Oe(),[l,d]=m.useState(!1),[u,h]=m.useState(!1),[f,x]=m.useState(!1),[g,y]=m.useState(null),b=pl({resolver:cd(cg),defaultValues:{amount:0}});m.useEffect(()=>{const S=localStorage.getItem("pendingCourseId");if(S&&r&&r.length>0){const E=r.find(A=>A.id===S);if(E&&(y({id:E.id,price:E.price,title:E.title}),s&&s.balance<E.price)){const A=E.price-s.balance;b.setValue("amount",A),d(!0)}}},[r,s==null?void 0:s.balance,o==null?void 0:o.id]);const p=async S=>{var E,A;if(!(!s||!o)){h(!0);try{const D=(await Pe.post("/wallet/deposit-gateway/",{amount:S.amount})).data;D.success&&D.payment_url?(be({title:"انتقال به درگاه پرداخت",description:"در حال انتقال به درگاه پرداخت..."}),localStorage.setItem("deposit_amount",S.amount.toString()),window.location.href=D.payment_url):be({title:"خطا در ایجاد درگاه پرداخت",description:D.error||"متأسفانه اتصال به درگاه پرداخت با مشکل مواجه شد",variant:"destructive"})}catch(z){console.error("Payment gateway error:",z);const D=((A=(E=z.response)==null?void 0:E.data)==null?void 0:A.error)||"متأسفانه اتصال به درگاه پرداخت با مشکل مواجه شد";be({title:"خطا در اتصال به درگاه",description:D,variant:"destructive"})}finally{h(!1)}}},j=()=>{i()},v=S=>{const E=new Date(S);return new Intl.DateTimeFormat("fa-IR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(E)},w=S=>{switch(S){case"deposit":return e.jsx(Oi,{className:"h-5 w-5 text-green-500"});case"purchase":return e.jsx(ys,{className:"h-5 w-5 text-trader-500"});default:return e.jsx(Oi,{className:"h-5 w-5 text-gray-500"})}},N=S=>{switch(S){case"deposit":return"text-green-500";case"purchase":return"text-trader-500";default:return"text-gray-500"}},k=async()=>{var S,E,A,z,D;if(!(!g||!s)){if(s.balance<g.price){be({title:"موجودی ناکافی",description:"موجودی کیف پول شما برای خرید این دوره کافی نیست",variant:"destructive"});return}x(!0);try{if((await Pe.post(`/crs/courses/${g.id}/enroll/`,{course_id:parseInt(g.id)})).status===201){js(),y(null),be({title:"خرید موفق",description:`دوره "${g.title}" با موفقیت خریداری شد`});try{await Ls.sendCoursePurchaseNotification(g.title,g.id),console.log("Course purchase notification sent successfully from wallet page")}catch(R){console.warn("Failed to send course purchase notification:",R)}i(),t(`/learn/${g.id}`)}}catch(T){console.error("Error completing purchase:",T);let R="خطا در خرید دوره";if(((S=T.response)==null?void 0:S.status)===400){const F=T.response.data;(E=F==null?void 0:F.course_id)!=null&&E[0]?R=F.course_id[0]:(A=F==null?void 0:F.non_field_errors)!=null&&A[0]?R=F.non_field_errors[0]:F!=null&&F.detail&&(R=F.detail)}else((z=T.response)==null?void 0:z.status)===409?(R="شما قبلاً در این دوره ثبت‌نام کرده‌اید",js(),y(null)):((D=T.response)==null?void 0:D.status)===402&&(R="موجودی کیف پول شما برای خرید این دوره کافی نیست");be({title:"خطا در خرید",description:R,variant:"destructive"})}finally{x(!1)}}};return c?e.jsx(de,{children:e.jsx("div",{className:"trader-container py-12 text-center",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-trader-500 mb-4"}),e.jsx("h2",{className:"text-xl font-bold mb-2",children:"در حال بررسی احراز هویت..."}),e.jsx("p",{className:"text-gray-600",children:"لطفاً صبر کنید"})]})})}):o?n.wallet?e.jsx(de,{children:e.jsx("div",{className:"trader-container py-12 text-center",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-trader-500 mb-4"}),e.jsx("h2",{className:"text-xl font-bold mb-2",children:"در حال بارگذاری کیف پول..."}),e.jsx("p",{className:"text-gray-600",children:"لطفاً صبر کنید"}),(a==null?void 0:a.wallet)&&e.jsx("p",{className:"text-amber-600 text-sm mt-2",children:"در حال تلاش مجدد..."})]})})}):a!=null&&a.wallet?e.jsx(de,{children:e.jsx("div",{className:"trader-container py-12 text-center",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(Gs,{className:"h-12 w-12 text-red-500 mb-4"}),e.jsx("h2",{className:"text-xl font-bold mb-4 text-red-600",children:a.wallet}),e.jsx("p",{className:"text-gray-600 mb-6",children:"در صورت تداوم مشکل، لطفاً با پشتیبانی تماس بگیرید"}),e.jsx($,{onClick:j,className:"bg-trader-500 hover:bg-trader-600",children:"تلاش مجدد"})]})})}):s?e.jsx(de,{children:e.jsxs("div",{className:"trader-container py-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:"کیف پول"}),g&&e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-4 mb-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ys,{className:"h-6 w-6 text-amber-500 ml-3"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"font-bold",children:["خرید در انتظار: ",g.title]}),e.jsxs("p",{className:"text-sm mt-1",children:["قیمت دوره: ",e.jsx("span",{className:"font-bold",children:is(g.price)})," | موجودی فعلی: ",e.jsx("span",{className:"font-bold",children:is(s.balance)})]}),s.balance<g.price?e.jsxs("p",{className:"text-sm text-red-600 mt-1",children:["نیاز به شارژ: ",e.jsx("span",{className:"font-bold",children:is(g.price-s.balance)})]}):e.jsx("p",{className:"text-sm text-green-600 mt-1",children:"✅ موجودی شما برای خرید این دوره کافی است"})]}),e.jsxs("div",{className:"mr-auto flex gap-2",children:[e.jsx($,{onClick:()=>t(`/courses/${g.id}`),variant:"outline",size:"sm",children:"بازگشت به دوره"}),s.balance>=g.price?e.jsx($,{onClick:k,disabled:f,className:"bg-green-600 hover:bg-green-700",size:"sm",children:f?"در حال خرید...":"تکمیل خرید"}):e.jsx($,{onClick:()=>d(!0),className:"bg-green-600 hover:bg-green-700",size:"sm",children:"شارژ کیف پول"})]})]})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 mb-6",children:[e.jsx("p",{className:"text-gray-500 mb-1",children:"موجودی فعلی"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h2",{className:"text-3xl font-bold text-trader-600 mb-1",children:Xe(s.balance)}),e.jsx("p",{className:"text-lg text-gray-600",children:"تومان"}),s.balance>=1e6&&e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["(",dg(s.balance),")"]})]}),e.jsx("div",{className:"flex mt-6 gap-3",children:e.jsxs("button",{className:"flex-1 trader-btn-primary flex items-center justify-center",onClick:()=>d(!0),children:[e.jsx(Ir,{className:"h-5 w-5 ml-1"}),"افزایش موجودی"]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[e.jsx("h3",{className:"text-xl font-bold mb-6",children:"تاریخچه تراکنش‌ها"}),e.jsx("div",{className:"space-y-4",children:s.transactions&&s.transactions.length>0?s.transactions.map((S,E)=>e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-100 pb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center ml-3",children:w(S.transaction_type)}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:S.description}),e.jsx("p",{className:"text-gray-500 text-sm",children:v(S.created_at)})]})]}),e.jsxs("div",{className:"text-left",children:[e.jsxs("p",{className:`font-bold ${N(S.transaction_type)}`,children:[S.transaction_type==="purchase"?"-":"+",is(S.amount)]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["مانده: ",is(S.balance_after)]})]})]},E)):e.jsx("div",{className:"text-center py-8 text-gray-500",children:"هنوز هیچ تراکنشی انجام نشده است"})})]}),e.jsx(oi,{open:l,onOpenChange:d,children:e.jsxs(Vn,{className:"sm:max-w-[425px]",children:[e.jsx(Gn,{children:e.jsx(Qn,{children:"افزایش موجودی کیف پول"})}),e.jsx(ad,{...b,children:e.jsxs("form",{onSubmit:b.handleSubmit(p),className:"space-y-4 py-4",children:[e.jsx(gn,{control:b.control,name:"amount",render:({field:S})=>e.jsxs(fi,{children:[e.jsx(pi,{children:"مبلغ (تومان)"}),e.jsx(xi,{children:e.jsx("div",{className:"relative",children:e.jsx("input",{type:"number",min:"10000",step:"10000",className:"flex h-10 w-full rounded-md border border-gray-200 bg-white px-3 py-2 text-sm ring-offset-white focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-trader-500",placeholder:"مبلغ مورد نظر را وارد کنید (حداقل ۱۰ هزار تومان)",...S,onChange:E=>S.onChange(Number(E.target.value))})})}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mt-2",children:[e.jsx("button",{type:"button",onClick:()=>S.onChange(5e4),className:"px-3 py-1 text-xs border border-gray-300 rounded hover:bg-gray-100 transition-colors",children:"۵۰ هزار"}),e.jsx("button",{type:"button",onClick:()=>S.onChange(1e5),className:"px-3 py-1 text-xs border border-gray-300 rounded hover:bg-gray-100 transition-colors",children:"۱۰۰ هزار"}),e.jsx("button",{type:"button",onClick:()=>S.onChange(5e5),className:"px-3 py-1 text-xs border border-gray-300 rounded hover:bg-gray-100 transition-colors",children:"۵۰۰ هزار"})]}),S.value>0&&e.jsxs("p",{className:"text-sm text-blue-600 mt-2",children:["مبلغ وارد شده: ",is(S.value)]}),g&&s.balance<g.price&&e.jsxs("p",{className:"text-sm text-green-600",children:["حداقل مبلغ پیشنهادی: ",is(g.price-s.balance),"جهت خرید دوره"]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["موجودی فعلی: ",is(s.balance)]}),e.jsx(gi,{})]})}),e.jsxs(Kn,{className:"flex justify-between sm:justify-between gap-2",children:[e.jsx($,{type:"button",variant:"outline",onClick:()=>d(!1),children:"انصراف"}),e.jsx($,{type:"submit",disabled:!b.formState.isValid||u,className:"bg-green-600 hover:bg-green-700",children:u?"در حال پردازش...":"پرداخت و شارژ کیف پول"})]})]})})]})})]})}):e.jsx(de,{children:e.jsx("div",{className:"trader-container py-12 text-center",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(Gs,{className:"h-12 w-12 text-red-500 mb-4"}),e.jsx("h2",{className:"text-xl font-bold mb-4 text-red-600",children:"خطا در بارگذاری اطلاعات کیف پول"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"در صورت تداوم مشکل، لطفاً با پشتیبانی تماس بگیرید"}),e.jsx($,{onClick:j,className:"bg-trader-500 hover:bg-trader-600",children:"تلاش مجدد"})]})})}):e.jsx(de,{children:e.jsxs("div",{className:"trader-container py-12 text-center",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"برای مشاهده کیف پول خود ابتدا وارد شوید"}),e.jsx(me,{to:"/login",className:"trader-btn-primary",children:"ورود به حساب کاربری"})]})})},St=m.forwardRef(({className:t,type:s,...r},n)=>e.jsx("input",{type:s,className:W("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm firefox-rtl-fix",t),ref:n,style:{WebkitAppearance:"none",MozAppearance:"none",appearance:"none"},...r}));St.displayName="Input";var mg=Object.defineProperty,hg=Object.defineProperties,fg=Object.getOwnPropertyDescriptors,Sn=Object.getOwnPropertySymbols,dd=Object.prototype.hasOwnProperty,ud=Object.prototype.propertyIsEnumerable,wo=(t,s,r)=>s in t?mg(t,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[s]=r,pg=(t,s)=>{for(var r in s||(s={}))dd.call(s,r)&&wo(t,r,s[r]);if(Sn)for(var r of Sn(s))ud.call(s,r)&&wo(t,r,s[r]);return t},xg=(t,s)=>hg(t,fg(s)),gg=(t,s)=>{var r={};for(var n in t)dd.call(t,n)&&s.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&Sn)for(var n of Sn(t))s.indexOf(n)<0&&ud.call(t,n)&&(r[n]=t[n]);return r};function bg(t){let s=setTimeout(t,0),r=setTimeout(t,10),n=setTimeout(t,50);return[s,r,n]}function yg(t){let s=m.useRef();return m.useEffect(()=>{s.current=t}),s.current}var vg=18,md=40,jg=`${md}px`,Ng=["[data-lastpass-icon-root]","com-1password-button","[data-dashlanecreated]",'[style$="2147483647 !important;"]'].join(",");function wg({containerRef:t,inputRef:s,pushPasswordManagerStrategy:r,isFocused:n}){let[a,i]=m.useState(!1),[o,c]=m.useState(!1),[l,d]=m.useState(!1),u=m.useMemo(()=>r==="none"?!1:(r==="increase-width"||r==="experimental-no-flickering")&&a&&o,[a,o,r]),h=m.useCallback(()=>{let f=t.current,x=s.current;if(!f||!x||l||r==="none")return;let g=f,y=g.getBoundingClientRect().left+g.offsetWidth,b=g.getBoundingClientRect().top+g.offsetHeight/2,p=y-vg,j=b;document.querySelectorAll(Ng).length===0&&document.elementFromPoint(p,j)===f||(i(!0),d(!0))},[t,s,l,r]);return m.useEffect(()=>{let f=t.current;if(!f||r==="none")return;function x(){let y=window.innerWidth-f.getBoundingClientRect().right;c(y>=md)}x();let g=setInterval(x,1e3);return()=>{clearInterval(g)}},[t,r]),m.useEffect(()=>{let f=n||document.activeElement===s.current;if(r==="none"||!f)return;let x=setTimeout(h,0),g=setTimeout(h,2e3),y=setTimeout(h,5e3),b=setTimeout(()=>{d(!0)},6e3);return()=>{clearTimeout(x),clearTimeout(g),clearTimeout(y),clearTimeout(b)}},[s,n,r,h]),{hasPWMBadge:a,willPushPWMBadge:u,PWM_BADGE_SPACE_WIDTH:jg}}var hd=m.createContext({}),fd=m.forwardRef((t,s)=>{var r=t,{value:n,onChange:a,maxLength:i,textAlign:o="left",pattern:c,placeholder:l,inputMode:d="numeric",onComplete:u,pushPasswordManagerStrategy:h="increase-width",pasteTransformer:f,containerClassName:x,noScriptCSSFallback:g=Sg,render:y,children:b}=r,p=gg(r,["value","onChange","maxLength","textAlign","pattern","placeholder","inputMode","onComplete","pushPasswordManagerStrategy","pasteTransformer","containerClassName","noScriptCSSFallback","render","children"]),j,v,w,N,k;let[S,E]=m.useState(typeof p.defaultValue=="string"?p.defaultValue:""),A=n??S,z=yg(A),D=m.useCallback(G=>{a==null||a(G),E(G)},[a]),T=m.useMemo(()=>c?typeof c=="string"?new RegExp(c):c:null,[c]),R=m.useRef(null),F=m.useRef(null),Z=m.useRef({value:A,onChange:D,isIOS:typeof window<"u"&&((v=(j=window==null?void 0:window.CSS)==null?void 0:j.supports)==null?void 0:v.call(j,"-webkit-touch-callout","none"))}),B=m.useRef({prev:[(w=R.current)==null?void 0:w.selectionStart,(N=R.current)==null?void 0:N.selectionEnd,(k=R.current)==null?void 0:k.selectionDirection]});m.useImperativeHandle(s,()=>R.current,[]),m.useEffect(()=>{let G=R.current,ee=F.current;if(!G||!ee)return;Z.current.value!==G.value&&Z.current.onChange(G.value),B.current.prev=[G.selectionStart,G.selectionEnd,G.selectionDirection];function ye(){if(document.activeElement!==G){q(null),K(null);return}let ue=G.selectionStart,ke=G.selectionEnd,Qe=G.selectionDirection,We=G.maxLength,Me=G.value,Ve=B.current.prev,Ge=-1,we=-1,Ke;if(Me.length!==0&&ue!==null&&ke!==null){let Bt=ue===ke,vt=ue===Me.length&&Me.length<We;if(Bt&&!vt){let qe=ue;if(qe===0)Ge=0,we=1,Ke="forward";else if(qe===We)Ge=qe-1,we=qe,Ke="backward";else if(We>1&&Me.length>1){let $e=0;if(Ve[0]!==null&&Ve[1]!==null){Ke=qe<Ve[1]?"backward":"forward";let jt=Ve[0]===Ve[1]&&Ve[0]<We;Ke==="backward"&&!jt&&($e=-1)}Ge=$e+qe,we=$e+qe+1}}Ge!==-1&&we!==-1&&Ge!==we&&R.current.setSelectionRange(Ge,we,Ke)}let Jt=Ge!==-1?Ge:ue,Pt=we!==-1?we:ke,et=Ke??Qe;q(Jt),K(Pt),B.current.prev=[Jt,Pt,et]}if(document.addEventListener("selectionchange",ye,{capture:!0}),ye(),document.activeElement===G&&_(!0),!document.getElementById("input-otp-style")){let ue=document.createElement("style");if(ue.id="input-otp-style",document.head.appendChild(ue),ue.sheet){let ke="background: transparent !important; color: transparent !important; border-color: transparent !important; opacity: 0 !important; box-shadow: none !important; -webkit-box-shadow: none !important; -webkit-text-fill-color: transparent !important;";wr(ue.sheet,"[data-input-otp]::selection { background: transparent !important; color: transparent !important; }"),wr(ue.sheet,`[data-input-otp]:autofill { ${ke} }`),wr(ue.sheet,`[data-input-otp]:-webkit-autofill { ${ke} }`),wr(ue.sheet,"@supports (-webkit-touch-callout: none) { [data-input-otp] { letter-spacing: -.6em !important; font-weight: 100 !important; font-stretch: ultra-condensed; font-optical-sizing: none !important; left: -1px !important; right: 1px !important; } }"),wr(ue.sheet,"[data-input-otp] + * { pointer-events: all !important; }")}}let Ne=()=>{ee&&ee.style.setProperty("--root-height",`${G.clientHeight}px`)};Ne();let Se=new ResizeObserver(Ne);return Se.observe(G),()=>{document.removeEventListener("selectionchange",ye,{capture:!0}),Se.disconnect()}},[]);let[Y,I]=m.useState(!1),[P,_]=m.useState(!1),[L,q]=m.useState(null),[V,K]=m.useState(null);m.useEffect(()=>{bg(()=>{var G,ee,ye,Ne;(G=R.current)==null||G.dispatchEvent(new Event("input"));let Se=(ee=R.current)==null?void 0:ee.selectionStart,ue=(ye=R.current)==null?void 0:ye.selectionEnd,ke=(Ne=R.current)==null?void 0:Ne.selectionDirection;Se!==null&&ue!==null&&(q(Se),K(ue),B.current.prev=[Se,ue,ke])})},[A,P]),m.useEffect(()=>{z!==void 0&&A!==z&&z.length<i&&A.length===i&&(u==null||u(A))},[i,u,z,A]);let se=wg({containerRef:F,inputRef:R,pushPasswordManagerStrategy:h,isFocused:P}),ze=m.useCallback(G=>{let ee=G.currentTarget.value.slice(0,i);if(ee.length>0&&T&&!T.test(ee)){G.preventDefault();return}typeof z=="string"&&ee.length<z.length&&document.dispatchEvent(new Event("selectionchange")),D(ee)},[i,D,z,T]),ie=m.useCallback(()=>{var G;if(R.current){let ee=Math.min(R.current.value.length,i-1),ye=R.current.value.length;(G=R.current)==null||G.setSelectionRange(ee,ye),q(ee),K(ye)}_(!0)},[i]),Ae=m.useCallback(G=>{var ee,ye;let Ne=R.current;if(!f&&(!Z.current.isIOS||!G.clipboardData||!Ne))return;let Se=G.clipboardData.getData("text/plain"),ue=f?f(Se):Se;G.preventDefault();let ke=(ee=R.current)==null?void 0:ee.selectionStart,Qe=(ye=R.current)==null?void 0:ye.selectionEnd,We=(ke!==Qe?A.slice(0,ke)+ue+A.slice(Qe):A.slice(0,ke)+ue+A.slice(ke)).slice(0,i);if(We.length>0&&T&&!T.test(We))return;Ne.value=We,D(We);let Me=Math.min(We.length,i-1),Ve=We.length;Ne.setSelectionRange(Me,Ve),q(Me),K(Ve)},[i,D,T,A]),He=m.useMemo(()=>({position:"relative",cursor:p.disabled?"default":"text",userSelect:"none",WebkitUserSelect:"none",pointerEvents:"none"}),[p.disabled]),Le=m.useMemo(()=>({position:"absolute",inset:0,width:se.willPushPWMBadge?`calc(100% + ${se.PWM_BADGE_SPACE_WIDTH})`:"100%",clipPath:se.willPushPWMBadge?`inset(0 ${se.PWM_BADGE_SPACE_WIDTH} 0 0)`:void 0,height:"100%",display:"flex",textAlign:o,opacity:"1",color:"transparent",pointerEvents:"all",background:"transparent",caretColor:"transparent",border:"0 solid transparent",outline:"0 solid transparent",boxShadow:"none",lineHeight:"1",letterSpacing:"-.5em",fontSize:"var(--root-height)",fontFamily:"monospace",fontVariantNumeric:"tabular-nums"}),[se.PWM_BADGE_SPACE_WIDTH,se.willPushPWMBadge,o]),ge=m.useMemo(()=>m.createElement("input",xg(pg({autoComplete:p.autoComplete||"one-time-code"},p),{"data-input-otp":!0,"data-input-otp-placeholder-shown":A.length===0||void 0,"data-input-otp-mss":L,"data-input-otp-mse":V,inputMode:d,pattern:T==null?void 0:T.source,"aria-placeholder":l,style:Le,maxLength:i,value:A,ref:R,onPaste:G=>{var ee;Ae(G),(ee=p.onPaste)==null||ee.call(p,G)},onChange:ze,onMouseOver:G=>{var ee;I(!0),(ee=p.onMouseOver)==null||ee.call(p,G)},onMouseLeave:G=>{var ee;I(!1),(ee=p.onMouseLeave)==null||ee.call(p,G)},onFocus:G=>{var ee;ie(),(ee=p.onFocus)==null||ee.call(p,G)},onBlur:G=>{var ee;_(!1),(ee=p.onBlur)==null||ee.call(p,G)}})),[ze,ie,Ae,d,Le,i,V,L,p,T==null?void 0:T.source,A]),Q=m.useMemo(()=>({slots:Array.from({length:i}).map((G,ee)=>{var ye;let Ne=P&&L!==null&&V!==null&&(L===V&&ee===L||ee>=L&&ee<V),Se=A[ee]!==void 0?A[ee]:null,ue=A[0]!==void 0?null:(ye=l==null?void 0:l[ee])!=null?ye:null;return{char:Se,placeholderChar:ue,isActive:Ne,hasFakeCaret:Ne&&Se===null}}),isFocused:P,isHovering:!p.disabled&&Y}),[P,Y,i,V,L,p.disabled,A]),xe=m.useMemo(()=>y?y(Q):m.createElement(hd.Provider,{value:Q},b),[b,Q,y]);return m.createElement(m.Fragment,null,g!==null&&m.createElement("noscript",null,m.createElement("style",null,g)),m.createElement("div",{ref:F,"data-input-otp-container":!0,style:He,className:x},xe,m.createElement("div",{style:{position:"absolute",inset:0,pointerEvents:"none"}},ge)))});fd.displayName="Input";function wr(t,s){try{t.insertRule(s)}catch{console.error("input-otp could not insert CSS rule:",s)}}var Sg=`
[data-input-otp] {
  --nojs-bg: white !important;
  --nojs-fg: black !important;

  background-color: var(--nojs-bg) !important;
  color: var(--nojs-fg) !important;
  caret-color: var(--nojs-fg) !important;
  letter-spacing: .25em !important;
  text-align: center !important;
  border: 1px solid var(--nojs-fg) !important;
  border-radius: 4px !important;
  width: 100% !important;
}
@media (prefers-color-scheme: dark) {
  [data-input-otp] {
    --nojs-bg: black !important;
    --nojs-fg: white !important;
  }
}`;const pd=m.forwardRef(({className:t,containerClassName:s,...r},n)=>e.jsx(fd,{ref:n,containerClassName:W("flex items-center gap-2 has-[:disabled]:opacity-50",s),className:W("disabled:cursor-not-allowed",t),...r}));pd.displayName="InputOTP";const xd=m.forwardRef(({className:t,...s},r)=>e.jsx("div",{ref:r,className:W("flex items-center",t),...s}));xd.displayName="InputOTPGroup";const zs=m.forwardRef(({index:t,className:s,...r},n)=>{const a=m.useContext(hd),{char:i,hasFakeCaret:o,isActive:c}=a.slots[t];return e.jsxs("div",{ref:n,className:W("relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md",c&&"z-10 ring-2 ring-ring ring-offset-background",s),...r,children:[i,o&&e.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"h-4 w-px animate-caret-blink bg-foreground duration-1000"})})]})});zs.displayName="InputOTPSlot";const Cg=m.forwardRef(({...t},s)=>e.jsx("div",{ref:s,role:"separator",...t,children:e.jsx(_u,{})}));Cg.displayName="InputOTPSeparator";const Hs=t=>{const s="۰۱۲۳۴۵۶۷۸۹",r="٠١٢٣٤٥٦٧٨٩",n="0123456789";let a=t;for(let i=0;i<s.length;i++)a=a.replace(new RegExp(s[i],"g"),n[i]);for(let i=0;i<r.length;i++)a=a.replace(new RegExp(r[i],"g"),n[i]);return a},Fa=t=>{const r=Hs(t).replace(/[^\d+]/g,"");return r.startsWith("+98")?"0"+r.substring(3):r.startsWith("98")&&r.length===12?"0"+r.substring(2):r},So=t=>{const s=Fa(t);return/^09\d{9}$/.test(s)},Eg=()=>{const[t,s]=m.useState(()=>{const B=sessionStorage.getItem("loginStep"),Y=B?parseInt(B):0;return console.log("Initializing step from sessionStorage:",Y),Y}),[r,n]=m.useState(()=>{const B=sessionStorage.getItem("loginPhone");return console.log("Initializing phone from sessionStorage:",B||""),B||""}),[a,i]=m.useState(""),[o,c]=m.useState(()=>{const B=sessionStorage.getItem("loginTimer"),Y=B?parseInt(B):120;return console.log("Initializing timer from sessionStorage:",Y),Y}),[l,d]=m.useState(()=>{const Y=sessionStorage.getItem("loginTimerActive")==="true";return console.log("Initializing timerActive from sessionStorage:",Y),Y}),{requestOTP:u,verifyOTP:h,isLoading:f,error:x,user:g,phoneNumber:y,setPhoneNumber:b}=Oe(),p=Ze(),j=m.useRef(t);j.current=t;const v=m.useCallback(B=>{console.log("=== SET STEP CALLED ==="),console.log("Current step:",j.current),console.log("New step:",B),console.log("Stack trace:",new Error().stack),sessionStorage.setItem("loginStep",B.toString()),console.log("Saved step to sessionStorage:",B),s(B)},[]),w=m.useCallback(B=>{console.log("Setting phone to:",B),sessionStorage.setItem("loginPhone",B),n(B)},[]),N=m.useCallback(B=>{console.log("Setting timerActive to:",B),sessionStorage.setItem("loginTimerActive",B.toString()),d(B)},[]),k=m.useCallback(B=>{sessionStorage.setItem("loginTimer",B.toString()),c(B)},[]);m.useEffect(()=>(console.log("LoginPage component mounted"),()=>{console.log("LoginPage component unmounting")}),[]),m.useEffect(()=>{console.log("Step changed to:",t,t===0?"PHONE_ENTRY":"OTP_VERIFICATION"),console.log("Stack trace for step change:",new Error().stack)},[t]),m.useEffect(()=>{console.log("Phone state changed to:",r)},[r]),m.useEffect(()=>{console.log("PhoneNumber context changed to:",y)},[y]),m.useEffect(()=>{if(g){console.log("=== USER LOGIN DETECTED ==="),console.log("User is logged in, redirecting...",g),console.log("User ID:",g.id),console.log("User profile complete:",g.isProfileComplete),console.log("User first_name:",g.first_name),console.log("User last_name:",g.last_name),console.log("Clearing login sessionStorage"),sessionStorage.removeItem("loginStep"),sessionStorage.removeItem("loginPhone"),sessionStorage.removeItem("loginTimer"),sessionStorage.removeItem("loginTimerActive");const B=setTimeout(()=>{g.isProfileComplete?(console.log("=== REDIRECTING TO PROFILE ==="),console.log("Profile is complete, redirecting to profile"),p("/profile")):(console.log("=== REDIRECTING TO COMPLETE PROFILE ==="),console.log("Profile is incomplete, redirecting to complete-profile"),p("/complete-profile"))},500);return()=>clearTimeout(B)}},[g,p]),m.useEffect(()=>{const B=Hs(a);B.length===5&&!f&&t===1&&(console.log("Auto-submitting OTP:",B),(async()=>{try{console.log("Verifying OTP:",B),await h(B),console.log("OTP verified successfully")}catch(I){console.error("Error verifying OTP:",I)}})())},[a,f,t,h]),m.useEffect(()=>{let B=null;return l&&o>0&&(B=setInterval(()=>{c(Y=>{const I=Y<=1?0:Y-1;return I===0&&N(!1),sessionStorage.setItem("loginTimer",I.toString()),I})},1e3)),()=>{B&&clearInterval(B)}},[l,o,N]);const S=B=>{const Y=Math.floor(B/60),I=B%60;return`${Y}:${I.toString().padStart(2,"0")}`},E=m.useCallback(async B=>{console.log("=== OTP VERIFICATION START ==="),console.log("Verifying OTP:",B),console.log("Phone number from context:",y),console.log("Current step:",t),console.log("Is loading:",f);try{console.log("=== CALLING VERIFY OTP API ==="),console.log("Verifying OTP:",B),await h(B),console.log("=== OTP VERIFICATION SUCCESS ==="),console.log("OTP verified successfully")}catch(Y){console.log("=== OTP VERIFICATION FAILED ==="),console.error("Error verifying OTP:",Y)}console.log("=== OTP VERIFICATION END ===")},[h,y,t,f]),A=async B=>{B.preventDefault(),console.log("=== PHONE SUBMIT START ==="),console.log("Submitting phone:",r),console.log("Current step:",t),console.log("Is loading:",f);const Y=Fa(r);if(console.log("Formatted phone:",Y),!So(Y)){console.log("Phone validation failed - invalid format");return}try{console.log("=== REQUESTING OTP ==="),console.log("Requesting OTP for phone:",Y),console.log("Calling requestOTP API...");const I=await u(Y);console.log("=== OTP REQUEST SUCCESS ==="),console.log("OTP response:",I),console.log("=== MOVING TO OTP STEP ==="),console.log("Before setStep - Current step:",t),v(1),w(Y),N(!0),k(120),console.log("After setStep - Step should now be OTP_VERIFICATION")}catch(I){console.log("=== OTP REQUEST FAILED ==="),console.error("Error requesting OTP:",I),console.log("Not moving to OTP step due to error")}console.log("=== PHONE SUBMIT END ===")},z=async()=>{console.log("Resending OTP for phone:",y);try{await u(y),N(!0),k(120),i("")}catch(B){console.error("Error resending OTP:",B)}},D=async B=>{B.preventDefault(),console.log("Manual submitting OTP:",a);const Y=Hs(a);if(console.log("English OTP:",Y),!Y||Y.length!==5){console.log("OTP validation failed - invalid length");return}await E(Y)},T=()=>{console.log("=== HANDLE BACK TO PHONE CALLED ==="),console.log("Going back to phone entry"),console.log("Stack trace:",new Error().stack),sessionStorage.removeItem("loginStep"),sessionStorage.removeItem("loginPhone"),sessionStorage.removeItem("loginTimer"),sessionStorage.removeItem("loginTimerActive"),v(0),i(""),N(!1),k(120),b("")},R=()=>{sessionStorage.removeItem("loginStep"),sessionStorage.removeItem("loginPhone"),sessionStorage.removeItem("loginTimer"),sessionStorage.removeItem("loginTimerActive"),p("/")},F=B=>{console.log("OTP changed:",B);const Y=Hs(B);console.log("English OTP value:",Y),i(Y)},Z=B=>{const Y=B.target.value;console.log("Phone changed:",Y);const I=Hs(Y);console.log("English phone value:",I),w(I)};return console.log("LoginPage render - Step:",t,"Step name:",t===0?"PHONE_ENTRY":"OTP_VERIFICATION","Phone:",r,"PhoneNumber from context:",y),e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-md w-full space-y-8 bg-white p-8 rounded-xl shadow-md",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex justify-start mb-4",children:e.jsxs($,{variant:"ghost",size:"sm",onClick:R,className:"flex items-center text-gray-600 hover:text-gray-800",children:[e.jsx(Yt,{className:"h-4 w-4 ml-1"}),"بازگشت به سایت"]})}),e.jsx("h2",{className:"text-3xl font-bold text-trader-500",children:"مستر تریدر آکادمی"}),e.jsx("h3",{className:"mt-2 text-xl font-medium",children:t===0?"ورود / ثبت نام":"تایید کد"})]}),x&&e.jsx("div",{className:"bg-red-50 text-red-600 p-3 rounded-md text-sm text-center",children:x}),t===0?e.jsxs("form",{className:"mt-8 space-y-6",onSubmit:A,children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-1",children:"شماره موبایل"}),e.jsxs("div",{className:"relative",children:[e.jsx(Nl,{className:"absolute top-3 right-3 h-5 w-5 text-gray-400"}),e.jsx(St,{id:"phone",name:"phone",type:"tel",dir:"ltr",className:"text-left pr-10",placeholder:"09123456789",value:r,onChange:Z,required:!0,disabled:f})]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"کد تایید به این شماره ارسال خواهد شد"})]}),e.jsx($,{type:"submit",className:"w-full bg-trader-500 hover:bg-trader-600 py-3",disabled:f||!So(Fa(r)),children:f?"در حال ارسال کد...":"ارسال کد تایید"})]}):e.jsxs("form",{className:"mt-8 space-y-6",onSubmit:D,children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{htmlFor:"otp",className:"block text-sm font-medium text-gray-700",children:["کد تایید ارسال شده به ",y]}),l&&o>0&&e.jsxs("div",{className:"flex items-center justify-center bg-blue-50 border border-blue-200 rounded-md p-3 mb-4",children:[e.jsx(Qt,{className:"h-4 w-4 text-blue-600 ml-2"}),e.jsxs("span",{className:"text-blue-800 text-sm font-medium",children:["زمان باقی‌مانده: ",S(o)]})]}),e.jsx("div",{className:"flex justify-center py-4",dir:"ltr",children:e.jsx(pd,{maxLength:5,value:a,onChange:F,disabled:f,dir:"ltr",children:e.jsxs(xd,{dir:"ltr",children:[e.jsx(zs,{index:0}),e.jsx(zs,{index:1}),e.jsx(zs,{index:2}),e.jsx(zs,{index:3}),e.jsx(zs,{index:4})]})})}),e.jsx("p",{className:"text-xs text-gray-500 text-center",children:"کد 5 رقمی ارسال شده را وارد کنید (خودکار تایید می‌شود)"})]}),e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx($,{type:"submit",className:"w-full bg-trader-500 hover:bg-trader-600 py-3",disabled:f||Hs(a).length!==5,children:f?"در حال تایید...":"تایید کد"}),!l&&o===0&&e.jsx($,{type:"button",variant:"outline",className:"w-full py-3 border-trader-500 text-trader-500 hover:bg-trader-50",onClick:z,disabled:f,children:f?"در حال ارسال...":"ارسال دوباره کد تایید"}),e.jsx($,{type:"button",variant:"outline",className:"w-full py-3",onClick:T,disabled:f,children:"تغییر شماره موبایل"})]})]})]})})},kg=()=>{const[t,s]=m.useState(""),[r,n]=m.useState(""),[a,i]=m.useState(""),{user:o,completeProfile:c,isLoading:l,error:d}=Oe(),u=Ze(),[h,f]=m.useState(!0);m.useEffect(()=>{const g=setTimeout(()=>{f(!1)},1e3);return()=>clearTimeout(g)},[]),m.useEffect(()=>{if(console.log("CompleteProfilePage: useEffect - user:",o,"pageLoading:",h),!o&&!h){console.log("CompleteProfilePage: No user, redirecting to login"),u("/login");return}o!=null&&o.isProfileComplete&&!h&&(console.log("CompleteProfilePage: Profile already complete, redirecting to profile"),u("/profile"))},[o,u,h]);const x=async g=>{g.preventDefault(),console.log("CompleteProfilePage: Form submitted with:",{name:t,email:r});const y=t.trim();if(!y){i("لطفاً نام خود را وارد کنید"),console.log("CompleteProfilePage: Name is empty, not submitting");return}if(y.length<2){i("نام باید حداقل ۲ کاراکتر باشد"),console.log("CompleteProfilePage: Name is too short, not submitting:",y);return}if(!/^[\u0600-\u06FFa-zA-Z\s]+$/.test(y)){i("نام فقط می‌تواند شامل حروف فارسی و انگلیسی باشد"),console.log("CompleteProfilePage: Invalid name format:",y);return}i("");try{console.log("CompleteProfilePage: Calling completeProfile with name:",y,"and email:",r.trim()),console.log("CompleteProfilePage: Current user:",o),console.log("CompleteProfilePage: Auth tokens in localStorage:",localStorage.getItem("auth_tokens")?"present":"missing"),await c(y,r.trim()),console.log("CompleteProfilePage: Profile completed successfully"),u("/profile")}catch(p){console.error("CompleteProfilePage: Error completing profile:",p),p!=null&&p.message?i(p.message):i(typeof p=="string"?p:"خطا در تکمیل پروفایل. لطفاً دوباره تلاش کنید.")}};return h?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"max-w-md w-full space-y-8 bg-white p-8 rounded-xl shadow-md",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(Be,{className:"h-8 w-3/4 mx-auto mb-4"}),e.jsx(Be,{className:"h-6 w-1/2 mx-auto mb-2"}),e.jsx(Be,{className:"h-4 w-5/6 mx-auto"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(Be,{className:"h-10 w-full"}),e.jsx(Be,{className:"h-10 w-full"}),e.jsx(Be,{className:"h-12 w-full mt-4"})]})]})}):o?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-md w-full space-y-8 bg-white p-8 rounded-xl shadow-md",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-3xl font-bold text-trader-500",children:"مستر تریدر آکادمی"}),e.jsx("h3",{className:"mt-2 text-xl font-medium",children:"تکمیل پروفایل"}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"برای استفاده از امکانات سایت، لطفا اطلاعات خود را تکمیل کنید"})]}),d&&e.jsx("div",{className:"bg-red-50 text-red-600 p-3 rounded-md text-sm",children:d}),a&&e.jsx("div",{className:"bg-red-50 text-red-600 p-3 rounded-md text-sm",children:a}),e.jsxs("form",{className:"mt-8 space-y-6",onSubmit:x,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"نام و نام خانوادگی"}),e.jsxs("div",{className:"relative",children:[e.jsx(vs,{className:"absolute top-3 right-3 h-5 w-5 text-gray-400"}),e.jsx(St,{id:"name",name:"name",type:"text",className:"pr-10",placeholder:"نام و نام خانوادگی",value:t,onChange:g=>{s(g.target.value),i("")},required:!0,minLength:2})]}),a&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"ایمیل (اختیاری)"}),e.jsxs("div",{className:"relative",children:[e.jsx(Wa,{className:"absolute top-3 right-3 h-5 w-5 text-gray-400"}),e.jsx(St,{id:"email",name:"email",type:"email",dir:"ltr",className:"text-left pr-10",placeholder:"email@example.com",value:r,onChange:g=>n(g.target.value)})]})]})]}),e.jsx($,{type:"submit",className:"w-full bg-trader-500 hover:bg-trader-600 py-3",disabled:l||!t.trim()||t.trim().length<2,children:l?e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsx(bs,{className:"h-4 w-4 animate-spin mr-2"}),"در حال ثبت اطلاعات..."]}):"ذخیره اطلاعات"})]})]})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-lg",children:"در حال بارگذاری..."})})})},Tg=({courseData:t})=>{const s=Ze();return e.jsxs("div",{className:"relative h-48 bg-gradient-to-r from-trader-500 to-trader-600 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-black/30"}),e.jsx("img",{src:t.info.thumbnail,alt:t.info.title,className:"w-full h-full object-contain opacity-80 bg-gray-50"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"text-center text-white"})}),e.jsxs($,{variant:"ghost",className:"absolute top-6 right-6 text-white hover:bg-white/20",onClick:()=>s("/courses"),children:[e.jsx(Yt,{size:18,className:"ml-2"}),e.jsx("span",{children:"بازگشت به لیست دوره‌ها"})]})]})},Pg=({percentage:t,size:s="md",strokeWidth:r=8,className:n,showText:a=!0,color:i="text-trader-600"})=>{const o={sm:16,md:24,lg:32},c=40,l=2*Math.PI*c,d=l-t/100*l,u=o[s];return e.jsxs("div",{className:W("relative inline-flex items-center justify-center",n),children:[e.jsxs("svg",{className:W("transform -rotate-90",`w-${u} h-${u}`),style:{width:`${u*.25}rem`,height:`${u*.25}rem`},viewBox:"0 0 100 100",children:[e.jsx("circle",{cx:"50",cy:"50",r:c,stroke:"currentColor",strokeWidth:r,fill:"transparent",className:"text-gray-200"}),e.jsx("circle",{cx:"50",cy:"50",r:c,stroke:"currentColor",strokeWidth:r,fill:"transparent",strokeDasharray:l,strokeDashoffset:d,className:W(i,"transition-all duration-500"),strokeLinecap:"round"})]}),a&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("span",{className:W("font-bold",i,{"text-xs":s==="sm","text-sm":s==="md","text-lg":s==="lg"}),children:[Math.round(t),"%"]})})]})},Ag=({courseData:t,isEnrolled:s,isProcessing:r,isFree:n,coursePrice:a,onPurchase:i,onEnroll:o})=>{var d;const c=Ze(),l=t.user_progress;return e.jsx(ne,{className:"sticky top-8",children:e.jsxs(ae,{className:"p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsx("img",{src:t.info.thumbnail,alt:t.info.title,className:"w-full h-48 object-contain rounded-lg bg-gray-50"})}),s?e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600 mb-2",children:"دوره خریداری شده"}),e.jsx("div",{className:"text-sm text-gray-600",children:"پیشرفت شما در این دوره"})]}),e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx(Pg,{percentage:(l==null?void 0:l.course_progress.completion_percentage)||0,size:"lg",color:"text-trader-600"})}),e.jsxs("div",{className:"space-y-3 text-sm bg-gray-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-gray-600 flex items-center",children:[e.jsx(ur,{className:"h-4 w-4 ml-1"}),"دروس تکمیل شده:"]}),e.jsxs("span",{className:"font-medium",children:[(l==null?void 0:l.course_progress.completed_lessons)||0," از ",t.info.total_lessons]})]}),(l==null?void 0:l.next_lesson)&&e.jsxs("div",{className:"mt-4 p-3 bg-trader-50 rounded-lg border border-trader-200",children:[e.jsx("div",{className:"text-sm text-trader-800 font-medium mb-1",children:"درس بعدی:"}),e.jsx("div",{className:"text-sm text-trader-700",children:l.next_lesson.title})]})]})]}):e.jsx("div",{className:"text-center mb-6",children:e.jsx("div",{className:"text-3xl font-bold text-trader-600",dir:"rtl",children:Mc(a,n)})}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-trader-600",children:t.info.total_lessons}),e.jsx("div",{className:"text-sm text-gray-600",children:"درس"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-trader-600",children:Math.floor(t.info.total_duration/60)}),e.jsx("div",{className:"text-sm text-gray-600",children:"دقیقه"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-trader-600",children:t.info.total_chapters}),e.jsx("div",{className:"text-sm text-gray-600",children:"سرفصل"})]})]}),e.jsx("div",{className:"mb-6",children:s?e.jsxs($,{className:"w-full py-3 bg-green-600 hover:bg-green-700",onClick:()=>c(`/learn/${t.info.id}`),children:[e.jsx(Is,{className:"h-4 w-4 ml-2"}),"ادامه یادگیری"]}):e.jsx($,{className:"w-full py-3 bg-trader-600 hover:bg-trader-700",onClick:n?o:i,disabled:r,children:r?e.jsx(bs,{className:"h-4 w-4 animate-spin mx-auto"}):e.jsxs(e.Fragment,{children:[e.jsx(ys,{className:"h-4 w-4 ml-2"}),n?"ثبت‌نام در دوره رایگان":"خرید دوره"]})})}),e.jsx("div",{className:"text-center text-sm text-gray-600 border-t pt-4",children:s?e.jsxs("div",{className:"flex items-center justify-center text-green-600",children:[e.jsx(bl,{className:"h-4 w-4 ml-1"}),"دسترسی مادام‌العمر فعال"]}):"پشتیبانی و دسترسی مادام‌العمر"}),e.jsxs("div",{className:"mt-8 space-y-4 border-t pt-6",children:[e.jsx("h3",{className:"font-bold text-lg text-right",children:"اطلاعات دوره"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"مدرس:"}),e.jsx("span",{className:"font-medium",children:t.info.instructor})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"سطح دوره:"}),e.jsx("span",{className:"font-medium",children:t.info.level==="beginner"?"مقدماتی":t.info.level==="intermediate"?"متوسط":t.info.level==="advanced"?"پیشرفته":t.info.level})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"تاریخ بروزرسانی:"}),e.jsx("span",{className:"font-medium",children:t.info.updated_at})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"تعداد دانشجو:"}),e.jsx("span",{className:"font-medium",children:((d=t.info.total_students)==null?void 0:d.toLocaleString())||"0"})]})]})]}),s&&(l==null?void 0:l.chapter_progress)&&l.chapter_progress.length>0&&e.jsxs("div",{className:"mt-8 space-y-4 border-t pt-6",children:[e.jsx("h3",{className:"font-bold text-lg text-right",children:"پیشرفت فصل‌ها"}),e.jsx("div",{className:"space-y-3",children:l.chapter_progress.map(u=>e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium",children:u.title}),e.jsxs("span",{className:"text-sm text-gray-600",children:[Math.round(u.progress_percentage),"%"]})]}),e.jsx("div",{className:"w-full h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-trader-500 rounded-full transition-all duration-300",style:{width:`${u.progress_percentage}%`}})})]},u.id))})]})]})})},_g=({chapters:t})=>e.jsx("div",{className:"space-y-4",children:t.map((s,r)=>e.jsx(ne,{className:"border border-gray-200",children:e.jsxs(ae,{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-2",children:["فصل ",r+1,": ",s.title]}),e.jsx("p",{className:"text-gray-600 text-sm",children:s.description})]}),e.jsxs("div",{className:"text-left text-sm text-gray-500",children:[s.lessons.length," جلسه"]})]}),e.jsxs("div",{className:"space-y-2",children:[s.lessons.slice(0,3).map(n=>e.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-sm font-medium",children:n.title}),n.is_free_preview&&e.jsx("span",{className:"text-xs text-green-600 mr-2",children:"(پیش‌نمایش رایگان)"})]}),e.jsxs("div",{className:"flex items-center text-xs text-gray-500",children:[e.jsx(Qt,{size:12,className:"ml-1"}),n.duration," دقیقه"]})]},n.id)),s.lessons.length>3&&e.jsxs("div",{className:"text-center text-sm text-gray-500 py-2",children:["و ",s.lessons.length-3," درس دیگر..."]})]})]})},s.id))}),Ig=({courseData:t})=>e.jsx("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:e.jsx(_g,{chapters:t.chapters})}),os={log:(t,s)=>{},error:(t,s)=>{},success:(t,s)=>{},warn:(t,s)=>{},trackPendingCourse:()=>localStorage.getItem("pendingCourseId"),trackWalletBalance:(t,s)=>{},trackApiCall:(t,s,r)=>{},trackApiResponse:(t,s,r)=>{}},Rg=()=>{const{slug:t}=Ms(),s=Ze(),{toast:r}=ot(),{user:n}=Oe(),{wallet:a}=as(),{refetchWallet:i}=Za(),{enrollCourse:o,fetchCourseDetails:c,refreshCourseDetails:l}=Un(),[d,u]=m.useState(null),[h,f]=m.useState(!0),[x,g]=m.useState(!1),[y,b]=m.useState(!1);m.useEffect(()=>{(async()=>{if(!t){s("/courses");return}f(!0);try{const E=await c(t);E?u(E):(r({title:"خطا",description:"مشکلی در دریافت اطلاعات دوره وجود دارد.",variant:"destructive"}),s("/courses"))}catch(E){console.error("Failed to fetch course details",E),r({title:"خطا",description:"مشکلی در دریافت اطلاعات دوره وجود دارد.",variant:"destructive"}),s("/courses")}finally{f(!1)}})()},[t,s,r,c]);const p=async()=>{var S,E,A,z,D;if(b(!1),os.log("Starting confirmed purchase process",{courseId:d==null?void 0:d.info.id,slug:t}),!n){s("/login");return}if(!(!d||!t)){g(!0);try{const T=parseFloat(d.info.price);if(os.trackWalletBalance(a,T),a&&a.balance<T){const Z=T-a.balance;os.warn("Insufficient wallet balance",{balance:a.balance,required:T,shortfall:Z}),r({title:"موجودی ناکافی",description:`برای خرید این دوره نیاز به ${Xe(Z)} شارژ اضافی دارید`,variant:"destructive"}),localStorage.setItem("pendingCourseId",d.info.id.toString()),os.log("Saved pending course ID",d.info.id.toString()),s("/wallet");return}const R={course_id:parseInt(d.info.id)};os.trackApiCall(`/crs/courses/${t}/enroll/`,"POST",R);const F=await Pe.post(`/crs/courses/${t}/enroll/`,R);if(os.trackApiResponse(`/crs/courses/${t}/enroll/`,F.status,F.data),F.status===201){js(),os.success("Purchase completed successfully"),o(d.info.id.toString()),r({title:"خرید موفق",description:`دوره ${d.info.title} با موفقیت خریداری شد`});try{await Ls.sendCoursePurchaseNotification(d.info.title,d.info.id.toString()),console.log("Course purchase notification sent successfully")}catch(B){console.warn("Failed to send course purchase notification:",B)}const Z=await l(t);Z&&u(Z),i(),g(!1)}}catch(T){if(console.error("Error processing purchase:",T),g(!1),((S=T.response)==null?void 0:S.status)===400){const R=T.response.data;let F="خطا در پردازش خرید";(E=R==null?void 0:R.course_id)!=null&&E[0]?F=R.course_id[0]:(A=R==null?void 0:R.non_field_errors)!=null&&A[0]?F=R.non_field_errors[0]:R!=null&&R.detail?F=R.detail:R!=null&&R.message&&(F=R.message),r({title:"خطا در ثبت‌نام",description:F,variant:"destructive"})}else((z=T.response)==null?void 0:z.status)===402?(r({title:"موجودی ناکافی",description:"موجودی کیف پول شما برای خرید این دوره کافی نیست",variant:"destructive"}),localStorage.setItem("pendingCourseId",d.info.id.toString()),s("/wallet")):((D=T.response)==null?void 0:D.status)===409?r({title:"خطا",description:"شما قبلاً در این دوره ثبت‌نام کرده‌اید",variant:"destructive"}):r({title:"خطا",description:"خطا در پردازش خرید. لطفاً دوباره تلاش کنید.",variant:"destructive"})}}},j=async()=>{if(os.log("Purchase button clicked",{courseId:d==null?void 0:d.info.id,slug:t}),!n){s("/login");return}if(!d||!t)return;const S=parseFloat(d.info.price);if(a&&a.balance<S){const E=S-a.balance;r({title:"موجودی ناکافی",description:`برای خرید این دوره نیاز به ${Xe(E)} شارژ اضافی دارید`,variant:"destructive"}),localStorage.setItem("pendingCourseId",d.info.id.toString()),s("/wallet");return}b(!0)},v=async()=>{var E,A,z,D;if(!n){s("/login");return}if(!d||!t)return;if(parseFloat(d.info.price)===0){g(!0);try{if((await Pe.post(`/crs/courses/${t}/enroll/`,{course_id:parseInt(d.info.id)})).status===201){js(),o(d.info.id.toString()),r({title:"ثبت‌نام موفق",description:`شما با موفقیت در دوره ${d.info.title} ثبت‌نام شدید`});try{await Ls.sendCourseEnrollmentNotification(d.info.title,d.info.id.toString()),console.log("Course enrollment notification sent successfully")}catch(F){console.warn("Failed to send course enrollment notification:",F)}const R=await l(t);R&&u(R)}}catch(T){if(console.error("Error processing free enrollment:",T),((E=T.response)==null?void 0:E.status)===400){const R=T.response.data;let F="خطا در ثبت‌نام";(A=R==null?void 0:R.course_id)!=null&&A[0]?F=R.course_id[0]:(z=R==null?void 0:R.non_field_errors)!=null&&z[0]?F=R.non_field_errors[0]:R!=null&&R.detail?F=R.detail:R!=null&&R.message&&(F=R.message),r({title:"خطا در ثبت‌نام",description:F,variant:"destructive"})}else((D=T.response)==null?void 0:D.status)===409?r({title:"خطا",description:"شما قبلاً در این دوره ثبت‌نام کرده‌اید",variant:"destructive"}):r({title:"خطا",description:"خطا در پردازش ثبت‌نام. لطفاً دوباره تلاش کنید.",variant:"destructive"})}finally{g(!1)}return}j()};if(h)return e.jsx(de,{children:e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-80 bg-gray-200 mb-8"}),e.jsx("div",{className:"trader-container",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx("div",{className:"h-96 bg-gray-200 rounded-lg"})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsx("div",{className:"h-96 bg-gray-200 rounded-lg"})})]})})]})})});if(!d)return e.jsx(de,{children:e.jsxs("div",{className:"trader-container py-8",children:[e.jsx("div",{className:"text-center",children:"اطلاعات دوره یافت نشد"}),e.jsx($,{onClick:()=>s("/courses"),className:"mt-4 mx-auto block",children:"بازگشت به لیست دوره‌ها"})]})});const w=d.info.is_enrolled||d.user_progress!==void 0&&d.user_progress!==null,N=parseFloat(d.info.price),k=N===0;return e.jsxs(de,{children:[e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Tg,{courseData:d}),e.jsx("div",{className:"trader-container py-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(Jc,{defaultValue:"content",className:"w-full",children:[e.jsxs(di,{className:"grid w-full grid-cols-3",dir:"rtl",children:[e.jsx(_r,{value:"content",children:"محتوای دوره"}),e.jsx(_r,{value:"info",children:"اطلاعات دوره"}),e.jsx(_r,{value:"comments",children:"نظرات"})]}),e.jsx(pn,{value:"content",className:"mt-6",children:e.jsx(Ig,{courseData:d})}),e.jsx(pn,{value:"info",className:"mt-6",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6 text-right",children:"درباره دوره"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8",children:[e.jsxs("div",{className:"bg-trader-50 rounded-lg p-4 text-center",children:[e.jsx(Qt,{className:"h-8 w-8 text-trader-600 mx-auto mb-2"}),e.jsx("div",{className:"text-lg font-bold text-trader-600",children:Math.floor(d.info.total_duration/60)}),e.jsx("div",{className:"text-sm text-gray-600",children:"ساعت ویدیو"})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 text-center",children:[e.jsx(Or,{className:"h-8 w-8 text-blue-600 mx-auto mb-2"}),e.jsx("div",{className:"text-lg font-bold text-blue-600",children:d.info.total_students}),e.jsx("div",{className:"text-sm text-gray-600",children:"دانشجو"})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-4 text-center",children:[e.jsx(mt,{className:"h-8 w-8 text-green-600 mx-auto mb-2"}),e.jsx("div",{className:"text-lg font-bold text-green-600",children:d.info.total_lessons}),e.jsx("div",{className:"text-sm text-gray-600",children:"درس"})]})]}),e.jsxs("div",{className:"prose prose-lg max-w-none text-right",dir:"rtl",children:[e.jsx("div",{className:"text-gray-700 leading-relaxed mb-6",dangerouslySetInnerHTML:{__html:d.info.description}}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center py-3 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"مدرس:"}),e.jsx("span",{className:"font-medium",children:d.info.instructor})]}),e.jsxs("div",{className:"flex justify-between items-center py-3 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"سطح دوره:"}),e.jsx("span",{className:"font-medium",children:d.info.level==="beginner"?"مقدماتی":d.info.level==="intermediate"?"متوسط":d.info.level==="advanced"?"پیشرفته":d.info.level})]}),e.jsxs("div",{className:"flex justify-between items-center py-3 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"زبان دوره:"}),e.jsx("span",{className:"font-medium",children:(d.info.language==="fa","فارسی")})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center py-3 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"تعداد فصل:"}),e.jsx("span",{className:"font-medium",children:d.info.total_chapters})]}),e.jsxs("div",{className:"flex justify-between items-center py-3 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"تعداد درس:"}),e.jsx("span",{className:"font-medium",children:d.info.total_lessons})]}),e.jsxs("div",{className:"flex justify-between items-center py-3 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"مدت زمان:"}),e.jsxs("span",{className:"font-medium",children:[Math.floor(d.info.total_duration/60)," ساعت"]})]})]})]}),d.info.tags&&d.info.tags.length>0&&e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"برچسب‌ها"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:d.info.tags.map((S,E)=>e.jsx("span",{className:"bg-trader-100 text-trader-800 text-sm px-3 py-1 rounded-full",children:S},E))})]})]})]})}),e.jsx(pn,{value:"comments",className:"mt-6",children:e.jsx("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:e.jsx(Xr,{contentType:"course",contentId:d.info.id.toString(),comments:d.comments})})})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsx(Ag,{courseData:d,isEnrolled:w,isProcessing:x,isFree:k,coursePrice:N,onPurchase:j,onEnroll:v})})]})})]}),e.jsx(oi,{open:y,onOpenChange:b,children:e.jsxs(Vn,{className:"sm:max-w-[500px]",children:[e.jsx(Gn,{children:e.jsx(Qn,{className:"text-center",children:"تأیید خرید دوره"})}),e.jsxs("div",{className:"py-4",children:[e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("img",{src:d==null?void 0:d.info.thumbnail,alt:d==null?void 0:d.info.title,className:"w-16 h-16 object-contain rounded-lg ml-4 bg-gray-50"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg",children:d==null?void 0:d.info.title}),e.jsxs("p",{className:"text-gray-600 text-sm",children:["مدرس: ",d==null?void 0:d.info.instructor]})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ys,{className:"h-5 w-5 text-blue-600 ml-2"}),e.jsx("span",{className:"text-blue-800",children:"مبلغ دوره:"})]}),e.jsx("span",{className:"font-bold text-blue-600",children:Xe(N)})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Cl,{className:"h-5 w-5 text-green-600 ml-2"}),e.jsx("span",{className:"text-green-800",children:"موجودی فعلی شما:"})]}),e.jsx("span",{className:"font-bold text-green-600",children:Xe((a==null?void 0:a.balance)||0)})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-trader-50 border border-trader-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(mt,{className:"h-5 w-5 text-trader-600 ml-2"}),e.jsx("span",{className:"text-trader-800",children:"موجودی پس از خرید:"})]}),e.jsx("span",{className:"font-bold text-trader-600",children:Xe(((a==null?void 0:a.balance)||0)-N)})]})]}),e.jsx("div",{className:"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("p",{className:"text-yellow-800 text-center",children:["مبلغ ",e.jsx("span",{className:"font-bold",children:Xe(N)})," از کیف پول شما برای خرید دوره ",e.jsxs("span",{className:"font-bold",children:['"',d==null?void 0:d.info.title,'"']})," کم می‌شود."]})})]}),e.jsxs(Kn,{className:"flex justify-between sm:justify-between gap-2",children:[e.jsx($,{type:"button",variant:"outline",onClick:()=>b(!1),children:"انصراف"}),e.jsx($,{type:"submit",onClick:p,disabled:x,className:"bg-green-600 hover:bg-green-700",children:x?"در حال پردازش...":"تأیید و خرید"})]})]})})]})},Og=({pagination:t,onPageChange:s,isLoading:r=!1,className:n,showSummary:a=!0,itemsName:i="مورد"})=>{const{currentPage:o,totalPages:c,totalCount:l,hasNext:d,hasPrevious:u}=t;if(c<=1||l===0)return null;const f=(()=>{const b=[],j=Math.floor(2.5);if(c<=5)for(let v=1;v<=c;v++)b.push(v);else{b.push(1);let v=Math.max(2,o-j),w=Math.min(c-1,o+j);v>2&&b.push("...");for(let N=v;N<=w;N++)b.push(N);w<c-1&&b.push("..."),c>1&&b.push(c)}return b})(),x=b=>{b!==o&&!r&&s(b)},g=()=>{u&&!r&&s(o-1)},y=()=>{d&&!r&&s(o+1)};return e.jsxs("div",{className:W("w-full",n),children:[a&&e.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4 mb-4",children:e.jsxs("div",{className:"text-sm text-gray-600",children:["نمایش صفحه ",e.jsx("span",{className:"font-medium",children:o})," از"," ",e.jsx("span",{className:"font-medium",children:c})," صفحه",l>0&&e.jsxs(e.Fragment,{children:[" ","(",e.jsx("span",{className:"font-medium",children:l.toLocaleString("fa-IR")})," ",i,")"]})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-2",children:[e.jsxs($,{variant:"outline",size:"sm",onClick:g,disabled:!u||r,className:"flex items-center gap-1 min-w-[100px]",children:[e.jsx(vl,{className:"h-4 w-4"}),"قبلی"]}),e.jsx("div",{className:"flex items-center gap-1 overflow-x-auto",children:f.map((b,p)=>{if(b==="...")return e.jsx("div",{className:"flex items-center justify-center w-8 h-8",children:e.jsx(Iu,{className:"h-4 w-4 text-gray-400"})},`ellipsis-${p}`);const j=b,v=j===o;return e.jsx($,{variant:v?"default":"outline",size:"sm",onClick:()=>x(j),disabled:r,className:W("min-w-[32px] h-8 px-2",v&&"bg-trader-500 hover:bg-trader-600"),children:j.toLocaleString("fa-IR")},j)})}),e.jsxs($,{variant:"outline",size:"sm",onClick:y,disabled:!d||r,className:"flex items-center gap-1 min-w-[100px]",children:["بعدی",e.jsx(ja,{className:"h-4 w-4"})]})]}),e.jsxs("div",{className:"sm:hidden text-center text-xs text-gray-500 mt-3",children:["صفحه ",o.toLocaleString("fa-IR")," از ",c.toLocaleString("fa-IR")]})]})},Lg=cu,Mg=du,gd=m.forwardRef(({className:t,align:s="center",sideOffset:r=4,...n},a)=>e.jsx(lu,{children:e.jsx(hl,{ref:a,align:s,sideOffset:r,className:W("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n})}));gd.displayName=hl.displayName;var Zn="Checkbox",[Dg,X0]=kn(Zn),[$g,bi]=Dg(Zn);function Fg(t){const{__scopeCheckbox:s,checked:r,children:n,defaultChecked:a,disabled:i,form:o,name:c,onCheckedChange:l,required:d,value:u="on",internal_do_not_use_render:h}=t,[f,x]=Zo({prop:r,defaultProp:a??!1,onChange:l,caller:Zn}),[g,y]=m.useState(null),[b,p]=m.useState(null),j=m.useRef(!1),v=g?!!o||!!g.closest("form"):!0,w={checked:f,disabled:i,setChecked:x,control:g,setControl:y,name:c,form:o,value:u,hasConsumerStoppedPropagationRef:j,required:d,defaultChecked:gs(a)?!1:a,isFormControl:v,bubbleInput:b,setBubbleInput:p};return e.jsx($g,{scope:s,...w,children:Bg(h)?h(w):n})}var bd="CheckboxTrigger",yd=m.forwardRef(({__scopeCheckbox:t,onKeyDown:s,onClick:r,...n},a)=>{const{control:i,value:o,disabled:c,checked:l,required:d,setControl:u,setChecked:h,hasConsumerStoppedPropagationRef:f,isFormControl:x,bubbleInput:g}=bi(bd,t),y=En(a,u),b=m.useRef(l);return m.useEffect(()=>{const p=i==null?void 0:i.form;if(p){const j=()=>h(b.current);return p.addEventListener("reset",j),()=>p.removeEventListener("reset",j)}},[i,h]),e.jsx($t.button,{type:"button",role:"checkbox","aria-checked":gs(l)?"mixed":l,"aria-required":d,"data-state":Sd(l),"data-disabled":c?"":void 0,disabled:c,value:o,...n,ref:y,onKeyDown:Mt(s,p=>{p.key==="Enter"&&p.preventDefault()}),onClick:Mt(r,p=>{h(j=>gs(j)?!0:!j),g&&x&&(f.current=p.isPropagationStopped(),f.current||p.stopPropagation())})})});yd.displayName=bd;var yi=m.forwardRef((t,s)=>{const{__scopeCheckbox:r,name:n,checked:a,defaultChecked:i,required:o,disabled:c,value:l,onCheckedChange:d,form:u,...h}=t;return e.jsx(Fg,{__scopeCheckbox:r,checked:a,defaultChecked:i,disabled:c,required:o,onCheckedChange:d,name:n,form:u,value:l,internal_do_not_use_render:({isFormControl:f})=>e.jsxs(e.Fragment,{children:[e.jsx(yd,{...h,ref:s,__scopeCheckbox:r}),f&&e.jsx(wd,{__scopeCheckbox:r})]})})});yi.displayName=Zn;var vd="CheckboxIndicator",jd=m.forwardRef((t,s)=>{const{__scopeCheckbox:r,forceMount:n,...a}=t,i=bi(vd,r);return e.jsx(Ba,{present:n||gs(i.checked)||i.checked===!0,children:e.jsx($t.span,{"data-state":Sd(i.checked),"data-disabled":i.disabled?"":void 0,...a,ref:s,style:{pointerEvents:"none",...t.style}})})});jd.displayName=vd;var Nd="CheckboxBubbleInput",wd=m.forwardRef(({__scopeCheckbox:t,...s},r)=>{const{control:n,hasConsumerStoppedPropagationRef:a,checked:i,defaultChecked:o,required:c,disabled:l,name:d,value:u,form:h,bubbleInput:f,setBubbleInput:x}=bi(Nd,t),g=En(r,x),y=uu(i),b=mu(n);m.useEffect(()=>{const j=f;if(!j)return;const v=window.HTMLInputElement.prototype,N=Object.getOwnPropertyDescriptor(v,"checked").set,k=!a.current;if(y!==i&&N){const S=new Event("click",{bubbles:k});j.indeterminate=gs(i),N.call(j,gs(i)?!1:i),j.dispatchEvent(S)}},[f,y,i,a]);const p=m.useRef(gs(i)?!1:i);return e.jsx($t.input,{type:"checkbox","aria-hidden":!0,defaultChecked:o??p.current,required:c,disabled:l,name:d,value:u,form:h,...s,tabIndex:-1,ref:g,style:{...s.style,...b,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});wd.displayName=Nd;function Bg(t){return typeof t=="function"}function gs(t){return t==="indeterminate"}function Sd(t){return gs(t)?"indeterminate":t?"checked":"unchecked"}const Cr=m.forwardRef(({className:t,...s},r)=>e.jsx(yi,{ref:r,className:W("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...s,children:e.jsx(jd,{className:W("flex items-center justify-center text-current"),children:e.jsx(za,{className:"h-4 w-4"})})}));Cr.displayName=yi.displayName;const Ug=()=>{const{courses:t,isLoading:s,pagination:r}=Un(),[n,a]=m.useState(""),[i,o]=m.useState([]),[c,l]=m.useState([]),[d,u]=m.useState([]),[h,f]=m.useState("all"),[x,g]=m.useState(1),[y,b]=m.useState([]),[p,j]=m.useState({currentPage:1,totalPages:1,totalCount:0,hasNext:!1,hasPrevious:!1}),v=Array.from(new Set(t.flatMap(T=>T.categories))),w=Array.from(new Set(t.map(T=>T.level).filter(Boolean))),N=async(T=1)=>{try{const R=await Bs.getAll(T,12);let F=[...R.results];n&&(F=F.filter(Z=>Z.title.toLowerCase().includes(n.toLowerCase())||Z.instructor.toLowerCase().includes(n.toLowerCase())||Z.description.toLowerCase().includes(n.toLowerCase()))),c.length>0&&(F=F.filter(Z=>Z.categories.some(B=>c.includes(B)))),d.length>0&&(F=F.filter(Z=>Z.level&&d.includes(Z.level))),h==="free"?F=F.filter(Z=>Z.price===0):h==="paid"&&(F=F.filter(Z=>Z.price>0)),b(F),j({currentPage:R.current_page,totalPages:R.total_pages,totalCount:F.length,hasNext:!!R.next,hasPrevious:!!R.previous})}catch(R){console.error("Error loading courses:",R),b([])}};m.useEffect(()=>{g(1),N(1)},[n,c,d,h]);const k=T=>{g(T),N(T)},S=T=>{l(R=>R.includes(T)?R.filter(F=>F!==T):[...R,T])},E=T=>{u(R=>R.includes(T)?R.filter(F=>F!==T):[...R,T])},A=T=>{f(T)},z=()=>{l([]),u([]),f("all"),a("")},D={beginner:"مقدماتی",intermediate:"متوسط",advanced:"پیشرفته"};return e.jsx(de,{children:e.jsxs("div",{className:"trader-container py-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:"دوره‌های آموزشی"}),e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Rr,{className:"absolute top-3 right-3 h-4 w-4 text-gray-400"}),e.jsx(St,{placeholder:"جستجو در دوره‌ها...",className:"pr-10",value:n,onChange:T=>a(T.target.value),disabled:s.courses})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(Lg,{children:[e.jsx(Mg,{asChild:!0,children:e.jsxs($,{variant:"outline",className:"flex gap-2",disabled:s.courses,children:[e.jsx(Mu,{className:"h-4 w-4"}),"فیلترها",e.jsx(Pu,{className:"h-4 w-4"})]})}),e.jsx(gd,{className:"w-80",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"دسته‌بندی"}),e.jsx("div",{className:"space-y-2",children:v.map(T=>e.jsxs("div",{className:"flex items-center",children:[e.jsx(Cr,{id:`category-${T}`,checked:c.includes(T),onCheckedChange:()=>S(T)}),e.jsx(Ws,{htmlFor:`category-${T}`,className:"mr-2 text-sm",children:T})]},T))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"سطح"}),e.jsx("div",{className:"space-y-2",children:w.map(T=>T&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(Cr,{id:`level-${T}`,checked:d.includes(T),onCheckedChange:()=>E(T)}),e.jsx(Ws,{htmlFor:`level-${T}`,className:"mr-2 text-sm",children:D[T]||T})]},T))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"قیمت"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Cr,{id:"price-all",checked:h==="all",onCheckedChange:()=>A("all")}),e.jsx(Ws,{htmlFor:"price-all",className:"mr-2 text-sm",children:"همه"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Cr,{id:"price-free",checked:h==="free",onCheckedChange:()=>A("free")}),e.jsx(Ws,{htmlFor:"price-free",className:"mr-2 text-sm",children:"رایگان"})]})]})]}),e.jsx($,{variant:"outline",onClick:z,className:"w-full",children:"پاک کردن فیلترها"})]})})]})})]}),(c.length>0||d.length>0||h!=="all")&&e.jsxs("div",{className:"flex flex-wrap gap-2 mt-4",children:[c.map(T=>e.jsxs("div",{className:"bg-gray-100 px-3 py-1 rounded-full text-sm flex items-center gap-1",children:[T,e.jsx("button",{onClick:()=>S(T),className:"text-gray-500 hover:text-gray-700",children:"×"})]},`selected-${T}`)),d.map(T=>e.jsxs("div",{className:"bg-gray-100 px-3 py-1 rounded-full text-sm flex items-center gap-1",children:[D[T]||T,e.jsx("button",{onClick:()=>E(T),className:"text-gray-500 hover:text-gray-700",children:"×"})]},`selected-${T}`)),h!=="all"&&e.jsxs("div",{className:"bg-gray-100 px-3 py-1 rounded-full text-sm flex items-center gap-1",children:[h==="free"?"رایگان":"پولی",e.jsx("button",{onClick:()=>f("all"),className:"text-gray-500 hover:text-gray-700",children:"×"})]})]})]}),e.jsx("div",{className:"mb-8",children:s.courses?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:Array.from({length:12}).map((T,R)=>e.jsx(Dc,{},`skeleton-${R}`))}):y.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:y.map(T=>e.jsx(li,{id:T.id,title:T.title,instructor:T.instructor,thumbnail:T.thumbnail,price:T.price,isFree:T.price===0,is_enrolled:T.is_enrolled},T.id))}),e.jsx("div",{className:"mt-8",children:e.jsx(Og,{pagination:p,onPageChange:k,isLoading:s.courses,itemsName:"دوره"})})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-lg text-gray-500",children:"هیچ دوره‌ای با فیلترهای انتخاب شده یافت نشد."}),e.jsx($,{variant:"link",onClick:z,className:"mt-2",children:"پاک کردن فیلترها"})]})})]})})},bn=U.forwardRef(({id:t,label:s,type:r="text",description:n,placeholder:a,required:i=!1,className:o="",error:c,formItemProps:l,formLabelProps:d,formControlProps:u,...h},f)=>e.jsxs(fi,{className:o,...l,children:[e.jsxs(pi,{htmlFor:t,...d,className:`${c?"text-red-500":""} ${(d==null?void 0:d.className)||""}`,children:[s," ",i&&e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(xi,{...u,children:r==="textarea"?e.jsx(wn,{id:t,placeholder:a,className:`${c?"border-red-300 focus:ring-red-500":""}`,"aria-invalid":c?"true":"false",ref:f,...h}):e.jsx(St,{id:t,type:r,placeholder:a,className:`${c?"border-red-300 focus:ring-red-500":""}`,"aria-invalid":c?"true":"false",ref:f,...h})}),n&&e.jsx(ld,{children:n}),c&&e.jsx(gi,{className:"text-red-500",children:c})]}));bn.displayName="FormField";const zg=fl({name:ra().min(3,{message:"نام باید حداقل ۳ کاراکتر باشد"}),email:ra().email({message:"لطفاً یک ایمیل معتبر وارد کنید"}),message:ra().min(10,{message:"پیام باید حداقل ۱۰ کاراکتر باشد"})}),Hg=()=>{const[t,s]=m.useState(!1),{toast:r}=ot(),n=pl({resolver:cd(zg),defaultValues:{name:"",email:"",message:""},mode:"onBlur"}),a=async d=>{s(!0);try{console.log("Form submitted:",d),await new Promise(u=>setTimeout(u,1e3)),r.success({title:"پیام شما با موفقیت ارسال شد",description:"با تشکر از تماس شما. به زودی با شما تماس خواهیم گرفت."}),n.reset()}catch{r.destructive({title:"خطا در ارسال پیام",description:"متأسفانه مشکلی در ارسال پیام شما پیش آمد. لطفاً دوباره تلاش کنید."})}finally{s(!1)}},i=()=>{r.success({title:"عملیات موفق",description:"این یک پیام موفقیت‌آمیز است"})},o=()=>{r.destructive({title:"خطا رخ داد",description:"این یک پیام خطا است"})},c=()=>{r.warning({title:"هشدار",description:"این یک پیام هشدار است"})},l=()=>{r.info({title:"اطلاعات",description:"این یک پیام اطلاع‌رسانی است"})};return e.jsx(de,{children:e.jsxs("div",{className:"py-8 px-4 max-w-5xl mx-auto",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6 text-center",children:"تماس با ما"}),e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"flex flex-col space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-trader-600",children:"راه‌های ارتباطی"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-trader-100 p-3 rounded-full",children:e.jsx(Nl,{className:"h-5 w-5 text-trader-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"شماره تماس"}),e.jsx("p",{className:"text-gray-600",children:"۰۲۱-۸۸۷۷۶۶۵۵"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-trader-100 p-3 rounded-full",children:e.jsx(Wa,{className:"h-5 w-5 text-trader-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"پست الکترونیکی"}),e.jsx("p",{className:"text-gray-600",children:"info@mrtrader.com"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-trader-100 p-3 rounded-full",children:e.jsx(Uu,{className:"h-5 w-5 text-trader-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"آدرس"}),e.jsx("p",{className:"text-gray-600",children:"تهران، خیابان ولیعصر، مرکز آموزش مستر تریدر"})]})]}),e.jsxs("div",{className:"mt-6 pt-6 border-t",children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"نمایش انواع پیام‌ها"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx($,{onClick:i,variant:"outline",className:"text-green-600 border-green-600 hover:bg-green-50",children:"نمایش پیام موفقیت"}),e.jsx($,{onClick:o,variant:"outline",className:"text-red-600 border-red-600 hover:bg-red-50",children:"نمایش پیام خطا"}),e.jsx($,{onClick:c,variant:"outline",className:"text-amber-600 border-amber-600 hover:bg-amber-50",children:"نمایش پیام هشدار"}),e.jsx($,{onClick:l,variant:"outline",className:"text-blue-600 border-blue-600 hover:bg-blue-50",children:"نمایش پیام اطلاعات"})]})]})]}),e.jsxs("div",{className:"border-t pt-6 mt-4 md:border-t-0 md:pt-0 md:mt-0 md:border-r md:pr-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-trader-600",children:"فرم تماس"}),e.jsx(ad,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(a),className:"space-y-4",children:[e.jsx(gn,{control:n.control,name:"name",render:({field:d})=>{var u;return e.jsx(bn,{id:"name",label:"نام و نام خانوادگی",placeholder:"نام و نام خانوادگی خود را وارد کنید",required:!0,error:(u=n.formState.errors.name)==null?void 0:u.message,...d})}}),e.jsx(gn,{control:n.control,name:"email",render:({field:d})=>{var u;return e.jsx(bn,{id:"email",type:"email",label:"ایمیل",placeholder:"example@email.com",required:!0,error:(u=n.formState.errors.email)==null?void 0:u.message,dir:"ltr",className:"text-left",...d})}}),e.jsx(gn,{control:n.control,name:"message",render:({field:d})=>{var u;return e.jsx(bn,{id:"message",type:"textarea",label:"پیام",placeholder:"پیام خود را بنویسید...",required:!0,error:(u=n.formState.errors.message)==null?void 0:u.message,...d})}}),e.jsx($,{type:"submit",className:"bg-trader-500 hover:bg-trader-600 w-full",disabled:t,children:t?"در حال ارسال...":"ارسال پیام"})]})})]})]})})]})})},qg=()=>e.jsx(de,{children:e.jsxs("div",{className:"py-8 px-4",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6 text-center",children:"درباره ما"}),e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold mb-3 text-trader-600",children:"مستر تریدر آکادمی"}),e.jsx("p",{className:"text-gray-700 leading-relaxed",children:"مستر تریدر آکادمی یکی از پیشرو‌ترین مراکز آموزش بازارهای مالی در ایران است. ما با هدف ارتقای سطح دانش مالی و سرمایه‌گذاری در میان علاقه‌مندان به بازارهای مالی، دوره‌های آموزشی متنوعی را ارائه می‌دهیم."})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 pt-4",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"bg-trader-100 p-3 rounded-full shrink-0",children:e.jsx(ur,{className:"h-5 w-5 text-trader-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:"آموزش تخصصی"}),e.jsx("p",{className:"text-gray-600",children:"ما با بهره‌گیری از مدرسین متخصص و با تجربه، آموزش‌های کاربردی در زمینه تحلیل تکنیکال، تحلیل بنیادی، مدیریت سرمایه و استراتژی‌های معاملاتی ارائه می‌دهیم."})]})]}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"bg-trader-100 p-3 rounded-full shrink-0",children:e.jsx(Or,{className:"h-5 w-5 text-trader-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:"جامعه معامله‌گران"}),e.jsx("p",{className:"text-gray-600",children:"با پیوستن به جامعه مستر تریدر، شما به شبکه‌ای از معامله‌گران حرفه‌ای دسترسی خواهید داشت و می‌توانید تجربیات و دانش خود را با دیگر اعضا به اشتراک بگذارید."})]})]}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"bg-trader-100 p-3 rounded-full shrink-0",children:e.jsx(bl,{className:"h-5 w-5 text-trader-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:"تعهد به کیفیت"}),e.jsx("p",{className:"text-gray-600",children:"ما متعهد هستیم که بهترین و به‌روزترین محتوای آموزشی را در اختیار شما قرار دهیم. تمامی دوره‌های ما مبتنی بر استانداردهای بین‌المللی و تجربیات عملی در بازارهای مالی است."})]})]})]}),e.jsxs("div",{className:"pt-6 border-t mt-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-trader-600",children:"تاریخچه ما"}),e.jsx("p",{className:"text-gray-700 leading-relaxed mb-4",children:"مستر تریدر آکادمی در سال ۱۳۹۵ با هدف ارتقای سطح دانش مالی در ایران تأسیس شد. از آن زمان تاکنون، بیش از ۱۰,۰۰۰ دانشجو در دوره‌های مختلف ما شرکت کرده‌اند و ما افتخار می‌کنیم که به بسیاری از آنها کمک کرده‌ایم تا به معامله‌گران موفقی تبدیل شوند."}),e.jsx("p",{className:"text-gray-700 leading-relaxed",children:"ما همواره در حال توسعه محتوا و خدمات آموزشی خود هستیم تا بتوانیم پاسخگوی نیازهای متغیر بازار و دانشجویان باشیم."})]})]})})]})}),Wg=()=>{const{user:t}=Oe(),[s,r]=m.useState(""),n=[{id:"ORD-1234",date:"۱۴۰۴/۰۲/۱۵",title:"دوره جامع تحلیل تکنیکال",price:"۲,۵۰۰,۰۰۰",status:"completed"},{id:"ORD-1235",date:"۱۴۰۴/۰۱/۱۸",title:"سمینار آموزشی معاملات ارز دیجیتال",price:"۹۵۰,۰۰۰",status:"completed"},{id:"ORD-1236",date:"۱۴۰۳/۱۲/۰۵",title:"کتاب الکترونیکی اصول سرمایه‌گذاری",price:"۳۵۰,۰۰۰",status:"processing"}],a=s?n.filter(c=>c.title.includes(s)||c.id.includes(s)):n,i=c=>{switch(c){case"completed":return e.jsx(za,{className:"h-5 w-5 text-green-500"});case"processing":return e.jsx(Qt,{className:"h-5 w-5 text-yellow-500"});case"cancelled":return e.jsx(Qs,{className:"h-5 w-5 text-red-500"});default:return e.jsx(_s,{className:"h-5 w-5 text-gray-500"})}},o=c=>{switch(c){case"completed":return"تکمیل شده";case"processing":return"در حال پردازش";case"cancelled":return"لغو شده";default:return"نامشخص"}};return t?e.jsx(de,{children:e.jsxs("div",{className:"trader-container py-6",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsxs(me,{to:"/profile",className:"flex items-center text-gray-600 hover:text-trader-500",children:[e.jsx(Yt,{className:"h-5 w-5 ml-1"}),e.jsx("span",{children:"بازگشت به پروفایل"})]}),e.jsx("h1",{className:"text-2xl font-bold mr-auto",children:"سفارش‌های من"})]}),n.length>0&&e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"جستجو در سفارش‌ها...",className:"w-full border border-gray-200 rounded-lg py-2 px-10 focus:outline-none focus:ring-2 focus:ring-trader-500",value:s,onChange:c=>r(c.target.value)}),e.jsx(Rr,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"})]})}),n.length>0?a.length>0?e.jsx("div",{className:"grid gap-4",children:a.map(c=>e.jsx(ne,{className:"overflow-hidden",children:e.jsx(ae,{className:"p-0",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between p-6 border-b border-gray-100",children:[e.jsxs("div",{className:"mb-3 md:mb-0",children:[e.jsx("h3",{className:"font-bold text-lg mb-1",children:c.title}),e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[e.jsxs("span",{className:"ml-3",children:["شماره سفارش: ",c.id]}),e.jsxs("span",{children:["تاریخ: ",c.date]})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"flex items-center ml-4",children:[i(c.status),e.jsx("span",{className:"mr-1 text-sm",children:o(c.status)})]}),e.jsxs("div",{className:"font-bold",children:[c.price," تومان"]})]})]})})},c.id))}):e.jsx(zr,{icon:e.jsx(Rr,{className:"h-16 w-16"}),title:"نتیجه‌ای یافت نشد",description:`هیچ سفارشی منطبق با عبارت "${s}" یافت نشد`,action:e.jsx($,{onClick:()=>r(""),variant:"outline",className:"mt-4",children:"پاک کردن جستجو"})}):e.jsx(zr,{icon:e.jsx(_s,{className:"h-16 w-16"}),title:"هنوز سفارشی ثبت نکرده‌اید",description:"تاریخچه سفارش‌های شما در اینجا نمایش داده خواهد شد",action:e.jsx($,{asChild:!0,className:"mt-4 bg-trader-500 hover:bg-trader-600",children:e.jsx(me,{to:"/courses",children:"مشاهده دوره‌های آموزشی"})})})]})}):e.jsx(de,{children:e.jsxs("div",{className:"trader-container py-12 text-center",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"برای مشاهده سفارش‌های خود ابتدا وارد شوید"}),e.jsx(me,{to:"/login",className:"trader-btn-primary",children:"ورود به حساب کاربری"})]})})};function Vg(){var j,v;const{user:t,updateProfile:s,updateAvatar:r}=Oe(),[n,a]=m.useState(!1),[i,o]=m.useState(!1),[c,l]=m.useState(null),[d,u]=m.useState(!1),h=m.useRef(null),[f,x]=m.useState({first_name:(t==null?void 0:t.first_name)||"",last_name:(t==null?void 0:t.last_name)||"",email:(t==null?void 0:t.email)||""}),g=async w=>{w.preventDefault(),l(null),u(!1),a(!0),console.log("ProfileForm: handleSubmit called with formData:",f);try{await s(f),u(!0)}catch(N){console.error("ProfileForm: Error updating profile:",N),l((N==null?void 0:N.message)||"خطا در بروزرسانی پروفایل")}finally{a(!1)}},y=w=>{const{name:N,value:k}=w.target;x(S=>({...S,[N]:k}))},b=()=>{var w;(w=h.current)==null||w.click()},p=async w=>{var k;const N=(k=w.target.files)==null?void 0:k[0];if(N){if(!N.type.startsWith("image/")){l("لطفاً یک فایل تصویری انتخاب کنید");return}if(N.size>5*1024*1024){l("حجم فایل نباید بیشتر از 5 مگابایت باشد");return}l(null),o(!0);try{const S=await Te.uploadAvatar(N);r(S.avatar),u(!0)}catch{l("خطا در آپلود عکس پروفایل")}finally{o(!1)}}};return t?e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsxs("div",{className:"flex flex-col items-center mb-8",children:[e.jsxs("div",{className:"relative group",children:[e.jsxs(ui,{className:"w-24 h-24 border-4 border-gray-200",children:[e.jsx(mi,{src:t.avatar,alt:t.name}),e.jsxs(hi,{className:"text-xl",children:[(j=t.first_name)==null?void 0:j[0],(v=t.last_name)==null?void 0:v[0]]})]}),e.jsx("button",{type:"button",onClick:b,disabled:i,className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-50 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-200 disabled:cursor-not-allowed",children:i?e.jsx(bs,{className:"h-6 w-6 animate-spin"}):e.jsx(Tu,{className:"h-6 w-6"})})]}),e.jsxs("button",{type:"button",onClick:b,disabled:i,className:"mt-3 text-sm text-trader-500 hover:text-trader-600 transition-colors duration-200 flex items-center gap-1 disabled:opacity-50",children:[e.jsx(Yu,{className:"h-4 w-4"}),i?"در حال آپلود...":"تغییر عکس پروفایل"]}),e.jsx("input",{ref:h,type:"file",accept:"image/*",onChange:p,className:"hidden"})]}),e.jsxs("form",{onSubmit:g,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"first_name",className:"block text-sm font-medium text-gray-700 mb-1",children:"نام"}),e.jsxs("div",{className:"relative",children:[e.jsx(vs,{className:"absolute top-3 right-3 h-5 w-5 text-gray-400"}),e.jsx(St,{type:"text",id:"first_name",name:"first_name",value:f.first_name,onChange:y,className:"pr-10",placeholder:"نام خود را وارد کنید",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"last_name",className:"block text-sm font-medium text-gray-700 mb-1",children:"نام خانوادگی"}),e.jsxs("div",{className:"relative",children:[e.jsx(vs,{className:"absolute top-3 right-3 h-5 w-5 text-gray-400"}),e.jsx(St,{type:"text",id:"last_name",name:"last_name",value:f.last_name,onChange:y,className:"pr-10",placeholder:"نام خانوادگی خود را وارد کنید",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"ایمیل"}),e.jsxs("div",{className:"relative",children:[e.jsx(Wa,{className:"absolute top-3 right-3 h-5 w-5 text-gray-400"}),e.jsx(St,{type:"email",id:"email",name:"email",value:f.email,onChange:y,className:"text-left pr-10",placeholder:"email@example.com",required:!0,dir:"ltr"})]})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-md",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["شماره موبایل: ",e.jsx("span",{className:"font-medium",children:t.phone_number})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"برای تغییر شماره موبایل با پشتیبانی تماس بگیرید"})]}),c&&e.jsx("div",{className:"bg-red-50 text-red-600 p-3 rounded-md text-sm",children:c}),d&&e.jsx("div",{className:"bg-green-50 text-green-600 p-3 rounded-md text-sm",children:"اطلاعات شما با موفقیت بروزرسانی شد"}),e.jsx($,{type:"submit",disabled:n,className:"w-full bg-trader-500 hover:bg-trader-600 py-3",children:n?e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsx(bs,{className:"h-4 w-4 animate-spin ml-2"}),"در حال بروزرسانی..."]}):"بروزرسانی پروفایل"})]})]}):null}const Co=()=>{const{user:t}=Oe();return t?e.jsx(de,{children:e.jsxs("div",{className:"trader-container py-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs(me,{to:"/profile",className:"flex items-center text-trader-500 hover:text-trader-600 transition-colors duration-200",children:[e.jsx(Yt,{className:"h-5 w-5 ml-2"}),"بازگشت به پروفایل"]})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6 text-center",children:"ویرایش اطلاعات شخصی"}),e.jsx(Vg,{})]})]})}):e.jsx(de,{children:e.jsxs("div",{className:"trader-container py-12 text-center",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"برای ویرایش پروفایل ابتدا وارد شوید"}),e.jsx(me,{to:"/login",className:"trader-btn-primary",children:"ورود به حساب کاربری"})]})})};var vi="Progress",ji=100,[Gg,Z0]=kn(vi),[Kg,Qg]=Gg(vi),Cd=m.forwardRef((t,s)=>{const{__scopeProgress:r,value:n=null,max:a,getValueLabel:i=Yg,...o}=t;(a||a===0)&&!Eo(a)&&console.error(Jg(`${a}`,"Progress"));const c=Eo(a)?a:ji;n!==null&&!ko(n,c)&&console.error(Xg(`${n}`,"Progress"));const l=ko(n,c)?n:null,d=Cn(l)?i(l,c):void 0;return e.jsx(Kg,{scope:r,value:l,max:c,children:e.jsx($t.div,{"aria-valuemax":c,"aria-valuemin":0,"aria-valuenow":Cn(l)?l:void 0,"aria-valuetext":d,role:"progressbar","data-state":Td(l,c),"data-value":l??void 0,"data-max":c,...o,ref:s})})});Cd.displayName=vi;var Ed="ProgressIndicator",kd=m.forwardRef((t,s)=>{const{__scopeProgress:r,...n}=t,a=Qg(Ed,r);return e.jsx($t.div,{"data-state":Td(a.value,a.max),"data-value":a.value??void 0,"data-max":a.max,...n,ref:s})});kd.displayName=Ed;function Yg(t,s){return`${Math.round(t/s*100)}%`}function Td(t,s){return t==null?"indeterminate":t===s?"complete":"loading"}function Cn(t){return typeof t=="number"}function Eo(t){return Cn(t)&&!isNaN(t)&&t>0}function ko(t,s){return Cn(t)&&!isNaN(t)&&t<=s&&t>=0}function Jg(t,s){return`Invalid prop \`max\` of value \`${t}\` supplied to \`${s}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${ji}\`.`}function Xg(t,s){return`Invalid prop \`value\` of value \`${t}\` supplied to \`${s}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${ji} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var Pd=Cd,Zg=kd;const Ad=m.forwardRef(({className:t,value:s,...r},n)=>e.jsx(Pd,{ref:n,className:W("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...r,children:e.jsx(Zg,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(s||0)}%)`}})}));Ad.displayName=Pd.displayName;const ya=()=>{const t=localStorage.getItem(ns);if(t){const s=JSON.parse(t);if(s!=null&&s.access)return{Authorization:`Bearer ${s.access}`,"Content-Type":"application/json"}}return{"Content-Type":"application/json"}},e0=()=>{var N,k;const{courseId:t}=Ms(),s=Ze(),{user:r}=Oe(),[n,a]=m.useState(null),[i,o]=m.useState(null),[c,l]=m.useState(!0),[d,u]=m.useState(!1),[h,f]=m.useState(0),[x,g]=m.useState(0);m.useEffect(()=>{if(!r){s("/login");return}if(!t){s("/courses");return}y()},[t,r,s]),m.useEffect(()=>{var S;i&&(f(((S=i.progress)==null?void 0:S.last_position)||0),g(i.duration*60))},[i]),m.useEffect(()=>{const S=E=>{if(E.origin.includes("arvancloud.ir")||E.origin.includes("arvanvod.ir")){const A=E.data;A.type==="timeupdate"&&A.currentTime&&(f(A.currentTime),Math.floor(A.currentTime)%10===0&&i&&b(i.id,A.currentTime)),A.type==="play"&&u(!0),A.type==="pause"&&u(!1),A.type==="ended"&&i&&(p(i.id),setTimeout(()=>{w()},2e3))}};return window.addEventListener("message",S),()=>{window.removeEventListener("message",S)}},[i]);const y=async()=>{l(!0);try{const S=await fetch(`${le}${pe.COURSE_LEARN(t)}`,{headers:ya()});if(S.ok){const E=await S.json();a(E),E.next_lesson?o(E.next_lesson):E.chapters.length>0&&E.chapters[0].lessons.length>0&&o(E.chapters[0].lessons[0])}else if(S.status===403)be({title:"خطا در دسترسی",description:"برای دسترسی به این دوره باید در آن ثبت‌نام کرده باشید.",variant:"destructive"}),s(`/courses/${t}`);else if(S.status===401)be({title:"خطا در احراز هویت",description:"لطفا مجددا وارد شوید.",variant:"destructive"}),s("/login");else throw new Error("Failed to fetch learn data")}catch(S){console.error("Error fetching learn data:",S),be({title:"خطا",description:"مشکلی در دریافت اطلاعات دوره وجود دارد.",variant:"destructive"}),s("/courses")}finally{l(!1)}},b=async(S,E)=>{try{await fetch(`${le}${pe.LESSON_PROGRESS(t,S)}`,{method:"POST",headers:ya(),body:JSON.stringify({watched_duration:Math.floor(E),last_position:Math.floor(E)})})}catch(A){console.error("Error updating progress:",A)}},p=async S=>{try{(await fetch(`${le}${pe.LESSON_COMPLETE(t,S)}`,{method:"POST",headers:ya()})).ok&&(be({title:"موفقیت",description:"درس با موفقیت تکمیل شد!"}),y())}catch(E){console.error("Error marking lesson complete:",E)}},j=S=>{var E;o(S),f(((E=S.progress)==null?void 0:E.last_position)||0),u(!1)},v=()=>{if(!n||!i)return null;for(const S of n.chapters){const E=S.lessons.findIndex(A=>A.id===i.id);if(E!==-1){if(E<S.lessons.length-1)return S.lessons[E+1];const A=n.chapters.findIndex(z=>z.id===S.id);if(A<n.chapters.length-1){const z=n.chapters[A+1];if(z.lessons.length>0)return z.lessons[0]}}}return null},w=()=>{const S=v();S&&o(S)};return c?e.jsx(de,{children:e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"lg:col-span-3",children:[e.jsx(Be,{className:"aspect-video w-full mb-4"}),e.jsx(Be,{className:"h-8 w-3/4 mb-2"}),e.jsx(Be,{className:"h-4 w-1/2"})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsx(Be,{className:"h-96 w-full"})})]})})})}):n?e.jsx(de,{children:e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"lg:col-span-3",children:[e.jsx(ne,{className:"mb-6",children:e.jsx(ae,{className:"p-0",children:e.jsx("div",{className:"aspect-video bg-black rounded-lg overflow-hidden",children:i!=null&&i.video_url?e.jsx("iframe",{src:i.video_url,className:"w-full h-full rounded-lg",frameBorder:"0",allowFullScreen:!0,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",title:i.title,onLoadStart:()=>{var S;f(((S=i.progress)==null?void 0:S.last_position)||0)}}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-white",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Is,{className:"h-16 w-16 mx-auto mb-4 opacity-70"}),e.jsx("p",{className:"text-lg",children:"ویدیو دردسترس نیست"}),e.jsx("p",{className:"text-sm opacity-70 mt-2",children:"لطفا مجددا تلاش کنید یا با پشتیبانی تماس بگیرید"})]})})})})}),e.jsx(ne,{className:"mb-6",children:e.jsxs(ae,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 flex-col gap-4",children:[e.jsx("h1",{className:"text-xl font-bold",dir:"rtl",children:i==null?void 0:i.title}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs($,{variant:"outline",size:"sm",onClick:()=>i&&p(i.id),disabled:(N=i==null?void 0:i.progress)==null?void 0:N.is_completed,children:[e.jsx(mt,{className:"h-4 w-4 ml-1"}),(k=i==null?void 0:i.progress)!=null&&k.is_completed?"تکمیل شده":"تکمیل درس"]}),e.jsxs($,{variant:"outline",size:"sm",onClick:w,disabled:!v(),children:[e.jsx(wl,{className:"h-4 w-4 ml-1"}),"درس بعدی"]})]})]}),e.jsx("div",{className:"text-sm text-gray-600",dir:"rtl",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(Qt,{className:"h-4 w-4 ml-1"}),i==null?void 0:i.duration," دقیقه"]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx(ur,{className:"h-4 w-4 ml-1"}),n.course.instructor]})]})})]})}),e.jsx(ne,{children:e.jsxs(ae,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-bold mb-4",dir:"rtl",children:"توضیحات درس"}),e.jsx("div",{className:"prose prose-sm max-w-none",dir:"rtl",children:e.jsx("p",{children:(i==null?void 0:i.content)||"توضیحی برای این درس ارائه نشده است."})})]})})]}),e.jsxs("div",{className:"lg:col-span-1",children:[e.jsx(ne,{className:"mb-6",children:e.jsxs(ae,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-bold mb-4",dir:"rtl",children:"پیشرفت دوره"}),e.jsxs("div",{className:"text-center mb-4",children:[e.jsxs("div",{className:"text-3xl font-bold text-trader-600",children:[Math.round(n.user_progress.completion_percentage),"%"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"تکمیل شده"})]}),e.jsx(Ad,{value:n.user_progress.completion_percentage,className:"mb-4"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"دروس تکمیل شده:"}),e.jsxs("span",{children:[n.user_progress.completed_lessons," از ",n.user_progress.total_lessons]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"زمان مشاهده:"}),e.jsxs("span",{children:[Math.floor(n.user_progress.watched_duration/60)," دقیقه"]})]})]})]})}),e.jsx(ne,{children:e.jsxs(ae,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-bold mb-4",dir:"rtl",children:"محتوای دوره"}),e.jsx("div",{className:"space-y-4",children:n.chapters.map(S=>e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsx("h4",{className:"font-semibold mb-2",dir:"rtl",children:S.title}),e.jsx("div",{className:"space-y-2",children:S.lessons.map(E=>{var A;return e.jsx("div",{className:`flex items-center justify-between p-2 rounded cursor-pointer transition-colors ${(i==null?void 0:i.id)===E.id?"bg-trader-100 border border-trader-300":"hover:bg-gray-100"}`,onClick:()=>j(E),children:e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx("div",{className:"flex-shrink-0",children:(A=E.progress)!=null&&A.is_completed?e.jsx(mt,{className:"h-4 w-4 text-green-600"}):e.jsx(Is,{className:"h-4 w-4 text-gray-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",dir:"rtl",children:E.title}),e.jsxs("p",{className:"text-xs text-gray-500",children:[E.duration," دقیقه"]})]})]})},E.id)})})]},S.id))})]})})]})]})})})}):e.jsx(de,{children:e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx(ne,{children:e.jsxs(ae,{className:"p-8 text-center",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"دوره یافت نشد"}),e.jsx($,{onClick:()=>s("/courses"),children:"بازگشت به لیست دوره‌ها"})]})})})})},t0=()=>{const t=dr();return m.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",t.pathname)},[t.pathname]),e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),e.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),e.jsx("a",{href:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})},s0=()=>{const t=Ze(),[s]=Hd(),{user:r,isLoading:n}=Oe(),{refetchWallet:a,courses:i,enrollCourse:o}=as(),[c,l]=m.useState(!0),[d,u]=m.useState(!1),[h,f]=m.useState(null),[x,g]=m.useState("در حال آماده‌سازی..."),[y,b]=m.useState(null),p=m.useRef(!1),j=async k=>{var A,z,D,T;const S=localStorage.getItem("pendingCourseId");if(!S||!i)return;const E=i.find(R=>R.id===S);if(!E){console.log("Pending course not found in courses list");return}if(b({id:E.id,title:E.title,price:E.price}),k>=E.price){u(!0),g("در حال تکمیل خرید دوره...");try{if(console.log(`Attempting to purchase pending course: ${E.title}`),(await Pe.post(`/crs/courses/${E.id}/enroll/`,{course_id:parseInt(E.id)})).status===201){js(),o(E.id),f(F=>F?{...F,message:`کیف پول شارژ شد و دوره "${E.title}" با موفقیت خریداری شد`}:null),be({title:"خرید موفق",description:`دوره "${E.title}" با موفقیت خریداری شد`});try{await Ls.sendCoursePurchaseNotification(E.title,E.id),console.log("Course purchase notification sent successfully after wallet recharge")}catch(F){console.warn("Failed to send course purchase notification:",F)}setTimeout(()=>{t(`/learn/${E.id}`)},3e3)}}catch(R){console.error("Error purchasing pending course:",R);let F="خطا در خرید دوره";if(((A=R.response)==null?void 0:A.status)===400){const Z=R.response.data;(z=Z==null?void 0:Z.course_id)!=null&&z[0]?F=Z.course_id[0]:(D=Z==null?void 0:Z.non_field_errors)!=null&&D[0]?F=Z.non_field_errors[0]:Z!=null&&Z.detail&&(F=Z.detail)}else((T=R.response)==null?void 0:T.status)===409&&(F="شما قبلاً در این دوره ثبت‌نام کرده‌اید",js());be({title:"خطا در خرید دوره",description:F,variant:"destructive"})}finally{u(!1)}}};m.useEffect(()=>{(async()=>{if(p.current)return;p.current=!0;const S=s.get("Authority"),E=s.get("Status");if(console.log(`Frontend: Starting verification - Authority: ${S}, Status: ${E}`),!S){console.log("Frontend: No authority parameter"),f({success:!1,message:"پارامترهای پرداخت نامعتبر است"}),l(!1);return}const A=localStorage.getItem("auth_tokens");if(console.log(`Frontend: Auth tokens in localStorage: ${A?"present":"not found"}`),!A){console.log("Frontend: No auth tokens found"),f({success:!1,message:"لطفاً دوباره وارد شوید"}),l(!1);return}console.log("Frontend: Tokens exist, proceeding with verification..."),g("در حال تایید پرداخت...");try{console.log("Frontend: Sending verification request to backend");const D=(await Pe.get(`/wallet/deposit-verify/?Authority=${S}&Status=${E}`)).data;console.log("Frontend: Backend response:",D),D.success?(console.log("Frontend: Payment successful"),f({success:!0,message:D.message,amount:D.amount,new_balance:D.new_balance}),a&&a(),be({title:"پرداخت موفق",description:D.message}),D.new_balance&&await j(D.new_balance),d||setTimeout(()=>{t("/wallet")},3e3)):(console.log("Frontend: Payment failed -",D.error),f({success:!1,message:D.error||"پرداخت با مشکل مواجه شد"}),be({title:"خطا در پرداخت",description:D.error||"پرداخت با مشکل مواجه شد",variant:"destructive"}))}catch(z){console.error("Frontend: Verification error:",z),f({success:!1,message:"خطا در تایید پرداخت"}),be({title:"خطا در تایید پرداخت",description:"متأسفانه در تایید پرداخت مشکلی رخ داد",variant:"destructive"})}finally{l(!1)}})()},[i]);const v=()=>{t("/wallet")},w=()=>{t("/")},N=()=>{y&&t(`/learn/${y.id}`)};return e.jsx(de,{children:e.jsx("div",{className:"trader-container py-12",children:e.jsx("div",{className:"max-w-md mx-auto bg-white rounded-xl shadow-md p-8 text-center",children:c||d?e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(Kt,{className:"h-12 w-12 text-trader-500 animate-spin mb-4"}),e.jsx("h2",{className:"text-xl font-bold mb-2",children:x}),e.jsx("p",{className:"text-gray-600",children:"لطفاً صبر کنید"}),d&&y&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mt-4 w-full",children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx(ys,{className:"h-5 w-5 text-blue-600 ml-2"}),e.jsxs("p",{className:"text-sm text-blue-600",children:["در حال خرید دوره: ",y.title]})]})})]}):h?e.jsx("div",{className:"flex flex-col items-center",children:h.success?e.jsxs(e.Fragment,{children:[e.jsx(mt,{className:"h-12 w-12 text-green-500 mb-4"}),e.jsx("h2",{className:"text-xl font-bold mb-4 text-green-600",children:"پرداخت موفق"}),e.jsx("p",{className:"text-gray-600 mb-4",children:h.message}),h.amount&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-6 w-full",children:[e.jsx("p",{className:"text-sm text-green-600 mb-1",children:"مبلغ پرداخت شده:"}),e.jsxs("p",{className:"text-lg font-bold text-green-700",children:[Xe(h.amount)," تومان"]}),h.new_balance&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm text-green-600 mb-1 mt-2",children:"موجودی جدید:"}),e.jsxs("p",{className:"text-lg font-bold text-green-700",children:[Xe(h.new_balance)," تومان"]})]})]}),y&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4 w-full",children:[e.jsxs("div",{className:"flex items-center justify-center mb-2",children:[e.jsx(ys,{className:"h-5 w-5 text-blue-600 ml-2"}),e.jsx("p",{className:"text-sm font-medium text-blue-600",children:"دوره خریداری شده"})]}),e.jsx("p",{className:"text-lg font-bold text-blue-700",children:y.title}),e.jsxs("p",{className:"text-sm text-blue-600 mt-1",children:["مبلغ: ",Xe(y.price)," تومان"]})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4 w-full",children:e.jsx("p",{className:"text-sm text-blue-600",children:y?"📋 شما در حال انتقال به صفحه دوره هستید...":"📋 شما در حال انتقال به صفحه کیف پول هستید..."})}),e.jsx("div",{className:"flex gap-3 w-full",children:y?e.jsxs(e.Fragment,{children:[e.jsx($,{onClick:N,className:"flex-1 bg-trader-500 hover:bg-trader-600",children:"شروع دوره"}),e.jsx($,{onClick:v,variant:"outline",className:"flex-1",children:"مشاهده کیف پول"})]}):e.jsxs(e.Fragment,{children:[e.jsx($,{onClick:v,className:"flex-1 bg-trader-500 hover:bg-trader-600",children:"مشاهده کیف پول"}),e.jsx($,{onClick:w,variant:"outline",className:"flex-1",children:"بازگشت به خانه"})]})})]}):e.jsxs(e.Fragment,{children:[e.jsx(or,{className:"h-12 w-12 text-red-500 mb-4"}),e.jsx("h2",{className:"text-xl font-bold mb-4 text-red-600",children:"پرداخت ناموفق"}),e.jsx("p",{className:"text-gray-600 mb-6",children:h.message}),e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3 mb-4 w-full",children:e.jsx("p",{className:"text-sm text-amber-600",children:"⚠️ در صورت عدم موفقیت، مبلغ ظرف 24-72 ساعت به حساب شما برگشت داده می‌شود"})}),e.jsxs("div",{className:"flex gap-3 w-full",children:[e.jsx($,{onClick:()=>window.location.reload(),className:"flex-1 bg-trader-500 hover:bg-trader-600",children:"تلاش مجدد"}),e.jsx($,{onClick:w,variant:"outline",className:"flex-1",children:"بازگشت به خانه"})]})]})}):e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(or,{className:"h-12 w-12 text-red-500 mb-4"}),e.jsx("h2",{className:"text-xl font-bold mb-4 text-red-600",children:"خطا در پردازش"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"متأسفانه در پردازش پرداخت مشکلی رخ داد"}),e.jsx($,{onClick:w,className:"bg-trader-500 hover:bg-trader-600",children:"بازگشت به خانه"})]})})})})},r0=()=>{const{user:t}=Oe(),{toast:s}=ot(),[r,n]=m.useState("1"),[a,i]=m.useState("1"),[o,c]=m.useState("1"),[l,d]=m.useState("تست کامنت"),[u,h]=m.useState([]),f=async()=>{try{const v=await Te.getArticleComments(r);h(w=>[...w,{type:"Article Comments",data:v}]),s({title:"موفق",description:"کامنت‌های مقاله دریافت شد"})}catch(v){s({title:"خطا",description:"دریافت کامنت‌های مقاله ناموفق",variant:"destructive"}),console.error(v)}},x=async()=>{if(!t){s({title:"خطا",description:"وارد شوید",variant:"destructive"});return}try{const v=await Te.createArticleComment(r,{content:l});h(w=>[...w,{type:"New Article Comment",data:v}]),s({title:"موفق",description:"کامنت مقاله ایجاد شد"})}catch(v){s({title:"خطا",description:"ایجاد کامنت مقاله ناموفق",variant:"destructive"}),console.error(v)}},g=async()=>{try{const v=await Te.getVideoComments(a);h(w=>[...w,{type:"Video Comments",data:v}]),s({title:"موفق",description:"کامنت‌های ویدیو دریافت شد"})}catch(v){s({title:"خطا",description:"دریافت کامنت‌های ویدیو ناموفق",variant:"destructive"}),console.error(v)}},y=async()=>{if(!t){s({title:"خطا",description:"وارد شوید",variant:"destructive"});return}try{const v=await Te.createVideoComment(a,{content:l});h(w=>[...w,{type:"New Video Comment",data:v}]),s({title:"موفق",description:"کامنت ویدیو ایجاد شد"})}catch(v){s({title:"خطا",description:"ایجاد کامنت ویدیو ناموفق",variant:"destructive"}),console.error(v)}},b=async()=>{try{const v=await Te.getPodcastComments(o);h(w=>[...w,{type:"Podcast Comments",data:v}]),s({title:"موفق",description:"کامنت‌های پادکست دریافت شد"})}catch(v){s({title:"خطا",description:"دریافت کامنت‌های پادکست ناموفق",variant:"destructive"}),console.error(v)}},p=async()=>{if(!t){s({title:"خطا",description:"وارد شوید",variant:"destructive"});return}try{const v=await Te.createPodcastComment(o,{content:l});h(w=>[...w,{type:"New Podcast Comment",data:v}]),s({title:"موفق",description:"کامنت پادکست ایجاد شد"})}catch(v){s({title:"خطا",description:"ایجاد کامنت پادکست ناموفق",variant:"destructive"}),console.error(v)}},j=()=>{h([])};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs(ne,{children:[e.jsx(Ie,{children:e.jsx(Re,{children:"تست API های کامنت"})}),e.jsxs(ae,{className:"space-y-4",children:[t?e.jsxs("p",{className:"text-green-600",children:["وارد شده: ",t.first_name," ",t.last_name]}):e.jsx("p",{className:"text-red-600",children:"وارد نشده‌اید"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(St,{placeholder:"Article ID",value:r,onChange:v=>n(v.target.value)}),e.jsx(St,{placeholder:"Video ID",value:a,onChange:v=>i(v.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(St,{placeholder:"Podcast ID",value:o,onChange:v=>c(v.target.value)}),e.jsx(St,{placeholder:"متن کامنت",value:l,onChange:v=>d(v.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx($,{onClick:f,variant:"outline",children:"دریافت کامنت‌های مقاله"}),e.jsx($,{onClick:x,className:"bg-blue-500 hover:bg-blue-600",children:"ایجاد کامنت مقاله"}),e.jsx($,{onClick:g,variant:"outline",children:"دریافت کامنت‌های ویدیو"}),e.jsx($,{onClick:y,className:"bg-green-500 hover:bg-green-600",children:"ایجاد کامنت ویدیو"}),e.jsx($,{onClick:b,variant:"outline",children:"دریافت کامنت‌های پادکست"}),e.jsx($,{onClick:p,className:"bg-purple-500 hover:bg-purple-600",children:"ایجاد کامنت پادکست"})]}),e.jsx($,{onClick:j,variant:"destructive",children:"پاک کردن نتایج"})]})]}),u.length>0&&e.jsxs(ne,{children:[e.jsx(Ie,{children:e.jsx(Re,{children:"نتایج"})}),e.jsx(ae,{children:e.jsx("div",{className:"space-y-4",children:u.map((v,w)=>e.jsxs("div",{className:"border p-4 rounded",children:[e.jsx("h4",{className:"font-semibold mb-2",children:v.type}),e.jsx("pre",{className:"text-xs bg-gray-100 p-2 rounded overflow-auto",children:JSON.stringify(v.data,null,2)})]},w))})})]})]})},n0=()=>e.jsx(de,{children:e.jsxs("div",{className:"trader-container py-8",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6 text-center",children:"تست سیستم کامنت"}),e.jsx(r0,{})]})}),a0=({contentId:t,contentType:s,title:r="محتوای جالب",showLike:n=!0,showShare:a=!0,className:i=""})=>{const{toast:o}=ot(),{user:c}=Oe(),{addBookmark:l,removeBookmark:d,isBookmarked:u}=Kr(),[h,f]=m.useState(!1),[x,g]=m.useState(!1),[y,b]=m.useState(0),p=async()=>{if(!c){o({title:"خطا",description:"برای بوکمارک کردن باید وارد شوید",variant:"destructive"});return}f(!0);try{if(s!=="article"){o({title:"اطلاع",description:"فعلاً فقط مقالات قابل بوکمارک هستند",variant:"default"}),f(!1);return}u(t)?(await d(t),o({title:"موفقیت",description:"محتوا از نشان‌شده‌ها حذف شد",variant:"default"})):(await l(t),o({title:"موفقیت",description:"محتوا به نشان‌شده‌ها اضافه شد",variant:"default"}))}catch(N){console.error("Error toggling bookmark:",N),o({title:"خطا",description:N instanceof Error?N.message:"مشکلی در عملیات بوکمارک وجود دارد",variant:"destructive"})}finally{f(!1)}},j=async()=>{if(!c){o({title:"خطا",description:"برای پسندیدن باید وارد شوید",variant:"destructive"});return}try{g(!x),b(N=>x?N-1:N+1),o({title:"موفقیت",description:x?"پسند شما حذف شد":"محتوا پسندیده شد",variant:"default"})}catch(N){console.error("Error toggling like:",N),o({title:"خطا",description:"مشکلی در عملیات پسندیدن وجود دارد",variant:"destructive"})}},v=s==="article"?u(t):!1,w=()=>{switch(s){case"article":return"مقاله";case"video":return"ویدیو";case"podcast":return"پادکست";default:return"محتوا"}};return e.jsxs("div",{className:`flex gap-2 ${i}`,children:[e.jsxs($,{variant:"outline",size:"icon",onClick:p,disabled:h||s!=="article",className:"rounded-full relative group",title:s!=="article"?`بوکمارک برای ${w()} فعلاً در دسترس نیست`:v?"حذف از نشان‌شده‌ها":"اضافه به نشان‌شده‌ها",children:[h?e.jsx(bs,{className:"h-5 w-5 animate-spin"}):v?e.jsx(Ps,{className:"h-5 w-5 fill-current text-trader-600"}):e.jsx(yl,{className:`h-5 w-5 ${s!=="article"?"text-gray-400":""}`}),s!=="article"&&e.jsxs("div",{className:`absolute bottom-full mb-2 left-1/2 transform -translate-x-1/2 
                          bg-gray-800 text-white text-xs rounded px-2 py-1 
                          opacity-0 group-hover:opacity-100 transition-opacity
                          pointer-events-none whitespace-nowrap z-10`,children:["بوکمارک برای ",w()," فعلاً در دسترس نیست"]})]}),n&&e.jsxs($,{variant:"outline",size:"icon",onClick:j,className:"rounded-full",title:x?"حذف پسند":"پسندیدن",children:[e.jsx($u,{className:`h-5 w-5 ${x?"fill-current text-red-500":""}`}),y>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:y})]}),a&&e.jsx(nd,{title:r})]})},i0=()=>{const{articles:t,bookmarks:s,isLoading:r}=Kr(),{user:n}=Oe();return n?e.jsxs("div",{className:"w-full max-w-4xl mx-auto space-y-6",children:[e.jsxs(ne,{children:[e.jsx(Ie,{children:e.jsxs(Re,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"تست سیستم بوکمارک"}),e.jsxs(Ee,{variant:"outline",children:[s.length," بوکمارک"]})]})}),e.jsxs(ae,{children:[e.jsxs("p",{className:"text-gray-600 mb-4",children:["خوش آمدید ",n.first_name||n.name,"! شما می‌توانید مقالات را بوکمارک کنید و در صفحه",e.jsx(me,{to:"/bookmarks",className:"text-blue-600 mx-1 underline",children:"نشان‌های من"}),"مشاهده کنید."]}),r.articles&&e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{children:"در حال بارگذاری مقالات..."})})]})]}),!r.articles&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"مقالات موجود برای بوکمارک"}),t.length===0?e.jsx(ne,{children:e.jsx(ae,{className:"py-6",children:e.jsx("p",{className:"text-center text-gray-600",children:"هیچ مقاله‌ای در دسترس نیست."})})}):t.slice(0,5).map(a=>e.jsx(ne,{className:"overflow-hidden",children:e.jsx(ae,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2 line-clamp-2",children:a.title}),e.jsx("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:a.summary||a.description||"خلاصه‌ای در دسترس نیست"}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[e.jsxs("span",{children:["نویسنده: ",Gt(a.author)]}),e.jsxs("span",{children:["تاریخ: ",new Date(a.date).toLocaleDateString("fa-IR")]}),e.jsxs("span",{children:["بازدید: ",a.view_count]})]})]}),e.jsxs("div",{className:"flex flex-col gap-3 items-end",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"عملیات عادی:"}),e.jsx(Jr,{articleId:a.id,title:a.title})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"عملیات پیشرفته:"}),e.jsx(a0,{contentId:a.id,contentType:"article",title:a.title})]}),e.jsx($,{asChild:!0,variant:"outline",size:"sm",children:e.jsx(me,{to:`/content/articles/${a.id}`,children:"مشاهده مقاله"})})]})]})})},a.id))]}),s.length>0&&e.jsxs(ne,{children:[e.jsx(Ie,{children:e.jsx(Re,{children:"خلاصه بوکمارک‌های شما"})}),e.jsxs(ae,{children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:s.map(a=>e.jsxs("div",{className:"p-3 border rounded-lg bg-gray-50",children:[e.jsx("h4",{className:"font-medium text-sm line-clamp-1 mb-1",children:a.article.title}),e.jsxs("p",{className:"text-xs text-gray-600",children:["بوکمارک شده در: ",new Date(a.created_at).toLocaleDateString("fa-IR")]}),e.jsx($,{asChild:!0,variant:"link",size:"sm",className:"p-0 h-auto mt-1",children:e.jsx(me,{to:`/content/articles/${a.article.id}`,children:"مشاهده →"})})]},a.id))}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx($,{asChild:!0,children:e.jsx(me,{to:"/bookmarks",children:"مشاهده همه بوکمارک‌ها"})})})]})]}),e.jsxs(ne,{children:[e.jsx(Ie,{children:e.jsx(Re,{children:"راهنمای تست"})}),e.jsx(ae,{className:"space-y-3 text-sm",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"مراحل تست:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-gray-600",children:[e.jsx("li",{children:"روی دکمه بوکمارک کلیک کنید"}),e.jsx("li",{children:"پیام موفقیت را مشاهده کنید"}),e.jsx("li",{children:"تغییر آیکون را ببینید"}),e.jsx("li",{children:"به صفحه بوکمارک‌ها بروید"}),e.jsx("li",{children:"مقاله بوکمارک شده را مشاهده کنید"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"ویژگی‌های پیاده‌سازی شده:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-gray-600",children:[e.jsx("li",{children:"✅ بوکمارک مقالات"}),e.jsx("li",{children:"✅ حذف بوکمارک"}),e.jsx("li",{children:"✅ مشاهده لیست بوکمارک‌ها"}),e.jsx("li",{children:"✅ Real-time UI updates"}),e.jsx("li",{children:"⏳ بوکمارک ویدیو (آینده)"}),e.jsx("li",{children:"⏳ بوکمارک پادکست (آینده)"})]})]})]})})]})]}):e.jsxs(ne,{className:"w-full max-w-2xl mx-auto",children:[e.jsx(Ie,{children:e.jsx(Re,{children:"تست سیستم بوکمارک"})}),e.jsxs(ae,{children:[e.jsx("p",{className:"text-center text-gray-600",children:"برای تست سیستم بوکمارک، ابتدا وارد حساب کاربری خود شوید."}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx($,{asChild:!0,children:e.jsx(me,{to:"/login",children:"ورود به حساب کاربری"})})})]})]})},o0=()=>e.jsx(de,{children:e.jsx("div",{className:"trader-container py-6",children:e.jsx(i0,{})})}),l0=()=>{const{isInstallable:t,isInstalled:s,isIOS:r,isAndroid:n,isStandalone:a,deferredPrompt:i,installApp:o,canShowPrompt:c}=Hn(),{toast:l}=ot(),[d,u]=m.useState([]),h=v=>{u(w=>[...w,`${new Date().toLocaleTimeString()}: ${v}`])},f=()=>{u([])},x=async()=>{try{await o(),h("✅ Install prompt triggered successfully"),l({title:"تست موفق",description:"Install prompt با موفقیت اجرا شد",variant:"default"})}catch(v){h(`❌ Install prompt failed: ${v}`),l({title:"تست ناموفق",description:`خطا: ${v}`,variant:"destructive"})}},g=()=>{localStorage.removeItem("pwa-prompt-seen"),localStorage.removeItem("pwa-prompt-dismissed"),h("🗑️ PWA localStorage data cleared"),l({title:"داده‌ها پاک شد",description:"اطلاعات PWA از localStorage حذف شد"})},y=()=>{localStorage.removeItem("pwa-prompt-seen"),localStorage.removeItem("pwa-prompt-dismissed"),window.location.reload()},b=v=>v?e.jsx(mt,{className:"w-5 h-5 text-green-500"}):e.jsx(or,{className:"w-5 h-5 text-red-500"}),j=(()=>{const v=navigator.userAgent,w=navigator.platform,N=navigator.language;return{userAgent:v.substring(0,100)+(v.length>100?"...":""),platform:w,language:N,cookieEnabled:navigator.cookieEnabled,onLine:navigator.onLine}})();return e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-4xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"تست سیستم PWA"}),e.jsx("p",{className:"text-gray-600",children:"این صفحه برای تست و بررسی عملکرد سیستم Progressive Web App طراحی شده است."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[e.jsxs(ne,{children:[e.jsx(Ie,{children:e.jsxs(Re,{className:"flex items-center gap-2",children:[e.jsx(kr,{className:"w-5 h-5"}),"وضعیت PWA"]})}),e.jsxs(ae,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"قابل نصب"}),e.jsxs("div",{className:"flex items-center gap-2",children:[b(t),e.jsx(Ee,{variant:t?"default":"secondary",children:t?"بله":"خیر"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"نصب شده"}),e.jsxs("div",{className:"flex items-center gap-2",children:[b(s),e.jsx(Ee,{variant:s?"default":"secondary",children:s?"بله":"خیر"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"حالت Standalone"}),e.jsxs("div",{className:"flex items-center gap-2",children:[b(a),e.jsx(Ee,{variant:a?"default":"secondary",children:a?"بله":"خیر"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"امکان نمایش پاپ‌آپ"}),e.jsxs("div",{className:"flex items-center gap-2",children:[b(c),e.jsx(Ee,{variant:c?"default":"secondary",children:c?"بله":"خیر"})]})]})]})]}),e.jsxs(ne,{children:[e.jsx(Ie,{children:e.jsxs(Re,{className:"flex items-center gap-2",children:[e.jsx(qa,{className:"w-5 h-5"}),"تشخیص دستگاه"]})}),e.jsxs(ae,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"iOS"}),e.jsxs("div",{className:"flex items-center gap-2",children:[b(r),e.jsx(Ee,{variant:r?"default":"secondary",children:r?"بله":"خیر"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Android"}),e.jsxs("div",{className:"flex items-center gap-2",children:[b(n),e.jsx(Ee,{variant:n?"default":"secondary",children:n?"بله":"خیر"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Deferred Prompt"}),e.jsxs("div",{className:"flex items-center gap-2",children:[b(!!i),e.jsx(Ee,{variant:i?"default":"secondary",children:i?"موجود":"ناموجود"})]})]})]})]})]}),e.jsxs(ne,{className:"mb-8",children:[e.jsx(Ie,{children:e.jsx(Re,{children:"اقدامات تست"})}),e.jsx(ae,{children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs($,{onClick:x,disabled:!t,className:"flex items-center gap-2",children:[e.jsx(Ha,{className:"w-4 h-4"}),"تست نصب"]}),e.jsxs($,{onClick:y,variant:"outline",className:"flex items-center gap-2",children:[e.jsx(Pn,{className:"w-4 h-4"}),"نمایش پاپ‌آپ"]}),e.jsxs($,{onClick:g,variant:"outline",className:"flex items-center gap-2",children:[e.jsx(Na,{className:"w-4 h-4"}),"پاک کردن داده‌ها"]}),e.jsx(Cc,{variant:"default",showText:!0})]})})]}),e.jsxs(ne,{className:"mb-8",children:[e.jsx(Ie,{children:e.jsx(Re,{children:"اطلاعات دستگاه"})}),e.jsxs(ae,{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"User Agent:"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1 break-all",children:j.userAgent})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Platform:"})," ",j.platform]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Language:"})," ",j.language]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Cookies Enabled:"})," ",j.cookieEnabled?"Yes":"No"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Online:"})," ",j.onLine?"Yes":"No"]})]})]}),e.jsxs(ne,{children:[e.jsxs(Ie,{className:"flex flex-row items-center justify-between",children:[e.jsx(Re,{children:"نتایج تست"}),e.jsxs($,{onClick:f,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[e.jsx(Na,{className:"w-4 h-4"}),"پاک کردن"]})]}),e.jsx(ae,{children:d.length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"هنوز تستی انجام نشده است"}):e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:d.map((v,w)=>e.jsx("div",{className:"text-sm p-2 bg-gray-50 rounded border-r-4 border-trader-500",children:v},w))})})]})]})},c0=()=>{const[t,s]=m.useState({serviceWorker:!1,manifest:!1,https:!1,beforeInstallPrompt:!1,isStandalone:!1,isMobile:!1,isIOS:!1,isAndroid:!1}),[r,n]=m.useState([]),a=h=>{const f=new Date().toLocaleTimeString();n(x=>[...x,`[${f}] ${h}`])};m.useEffect(()=>{i()},[]);const i=async()=>{a("شروع بررسی وضعیت PWA...");const h=location.protocol==="https:"||location.hostname==="localhost";a(`HTTPS: ${h?"✅":"❌"}`);const f="serviceWorker"in navigator;a(`Service Worker Support: ${f?"✅":"❌"}`);const g=!!document.querySelector('link[rel="manifest"]');a(`Manifest Link: ${g?"✅":"❌"}`);try{const S=(await fetch("/manifest.json")).ok;a(`Manifest Accessible: ${S?"✅":"❌"}`)}catch(k){a(`Manifest Fetch Error: ❌ ${k}`)}const y=navigator.userAgent.toLowerCase(),b=/iphone|ipad|ipod/.test(y),p=/android/.test(y),j=/mobile|android|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(y),v=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0;a(`iOS: ${b?"✅":"❌"}`),a(`Android: ${p?"✅":"❌"}`),a(`Mobile: ${j?"✅":"❌"}`),a(`Standalone: ${v?"✅":"❌"}`);const w=localStorage.getItem("pwa-prompt-seen"),N=localStorage.getItem("pwa-prompt-dismissed");a(`Prompt Seen: ${w||"null"}`),a(`Prompt Dismissed: ${N||"null"}`),s({serviceWorker:f,manifest:g,https:h,beforeInstallPrompt:!1,isStandalone:v,isMobile:j,isIOS:b,isAndroid:p}),window.addEventListener("beforeinstallprompt",k=>{a("🎯 beforeinstallprompt event fired!"),s(S=>({...S,beforeInstallPrompt:!0}))}),a("بررسی وضعیت PWA تکمیل شد")},o=()=>{localStorage.removeItem("pwa-prompt-seen"),localStorage.removeItem("pwa-prompt-dismissed"),a("🗑️ PWA localStorage data cleared")},c=()=>{window.location.reload()},l=h=>h?e.jsx(mt,{className:"w-4 h-4 text-green-500"}):e.jsx(or,{className:"w-4 h-4 text-red-500"}),u=(()=>{const h=t.serviceWorker&&t.manifest&&t.https,f=t.isMobile&&!t.isStandalone;return h&&f?{status:"ready",message:"PWA آماده نمایش است",color:"green"}:h?{status:"partial",message:"PWA آماده است اما شرایط نمایش فراهم نیست",color:"yellow"}:{status:"not-ready",message:"PWA آماده نیست",color:"red"}})();return e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-4xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"PWA Debug Panel"}),e.jsx("p",{className:"text-gray-600",children:"بررسی وضعیت و تشخیص مشکلات سیستم PWA"})]}),e.jsxs(ne,{className:"mb-6",children:[e.jsx(Ie,{children:e.jsxs(Re,{className:"flex items-center gap-2",children:[e.jsx(Gs,{className:`w-5 h-5 text-${u.color}-500`}),"وضعیت کلی"]})}),e.jsx(ae,{children:e.jsx("div",{className:`p-4 rounded-lg bg-${u.color}-50 border border-${u.color}-200`,children:e.jsx("p",{className:`text-${u.color}-800 font-medium`,children:u.message})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs(ne,{children:[e.jsx(Ie,{children:e.jsx(Re,{children:"الزامات PWA"})}),e.jsxs(ae,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"HTTPS"}),e.jsxs("div",{className:"flex items-center gap-2",children:[l(t.https),e.jsx(Ee,{variant:t.https?"default":"destructive",children:t.https?"فعال":"غیرفعال"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Service Worker"}),e.jsxs("div",{className:"flex items-center gap-2",children:[l(t.serviceWorker),e.jsx(Ee,{variant:t.serviceWorker?"default":"destructive",children:t.serviceWorker?"پشتیبانی":"عدم پشتیبانی"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Manifest"}),e.jsxs("div",{className:"flex items-center gap-2",children:[l(t.manifest),e.jsx(Ee,{variant:t.manifest?"default":"destructive",children:t.manifest?"موجود":"ناموجود"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Install Prompt"}),e.jsxs("div",{className:"flex items-center gap-2",children:[l(t.beforeInstallPrompt),e.jsx(Ee,{variant:t.beforeInstallPrompt?"default":"secondary",children:t.beforeInstallPrompt?"فعال":"غیرفعال"})]})]})]})]}),e.jsxs(ne,{children:[e.jsx(Ie,{children:e.jsx(Re,{children:"اطلاعات دستگاه"})}),e.jsxs(ae,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"موبایل"}),e.jsxs("div",{className:"flex items-center gap-2",children:[l(t.isMobile),e.jsx(Ee,{variant:t.isMobile?"default":"secondary",children:t.isMobile?"بله":"خیر"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"iOS"}),e.jsxs("div",{className:"flex items-center gap-2",children:[l(t.isIOS),e.jsx(Ee,{variant:t.isIOS?"default":"secondary",children:t.isIOS?"بله":"خیر"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Android"}),e.jsxs("div",{className:"flex items-center gap-2",children:[l(t.isAndroid),e.jsx(Ee,{variant:t.isAndroid?"default":"secondary",children:t.isAndroid?"بله":"خیر"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Standalone"}),e.jsxs("div",{className:"flex items-center gap-2",children:[l(t.isStandalone),e.jsx(Ee,{variant:t.isStandalone?"default":"secondary",children:t.isStandalone?"بله":"خیر"})]})]})]})]})]}),e.jsxs(ne,{className:"mb-6",children:[e.jsx(Ie,{children:e.jsx(Re,{children:"عملیات"})}),e.jsx(ae,{children:e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs($,{onClick:i,variant:"outline",children:[e.jsx(Pn,{className:"w-4 h-4 mr-2"}),"بررسی مجدد"]}),e.jsx($,{onClick:o,variant:"outline",children:"پاک کردن داده‌ها"}),e.jsx($,{onClick:c,variant:"outline",children:"بارگیری مجدد صفحه"})]})})]}),e.jsxs(ne,{children:[e.jsx(Ie,{children:e.jsx(Re,{children:"لاگ‌ها"})}),e.jsx(ae,{children:e.jsx("div",{className:"bg-gray-900 text-green-400 p-4 rounded-lg font-mono text-sm max-h-64 overflow-y-auto",children:r.map((h,f)=>e.jsx("div",{className:"mb-1",children:h},f))})})]})]})},d0=Wr("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),ps=m.forwardRef(({className:t,variant:s,...r},n)=>e.jsx("div",{ref:n,role:"alert",className:W(d0({variant:s}),t),...r}));ps.displayName="Alert";const u0=m.forwardRef(({className:t,...s},r)=>e.jsx("h5",{ref:r,className:W("mb-1 font-medium leading-none tracking-tight",t),...s}));u0.displayName="AlertTitle";const xs=m.forwardRef(({className:t,...s},r)=>e.jsx("div",{ref:r,className:W("text-sm [&_p]:leading-relaxed",t),...s}));xs.displayName="AlertDescription";const m0=({className:t})=>{const{isSupported:s,permission:r,subscription:n,isLoading:a,error:i,requestPermission:o,subscribe:c,unsubscribe:l,sendTestNotification:d,clearError:u}=zn(),[h,f]=m.useState(!1),x=async()=>{await c()},g=async()=>{await l()},y=async()=>{await d()&&(f(!0),setTimeout(()=>f(!1),3e3))},b=async()=>{try{await Ls.sendCoursePurchaseNotification("دوره نمونه آموزش React","sample-course-123")&&(f(!0),setTimeout(()=>f(!1),3e3))}catch(v){console.error("Error sending test course purchase notification:",v)}},j=(()=>{switch(r){case"granted":return{label:"مجاز",variant:"default",color:"text-green-600"};case"denied":return{label:"رد شده",variant:"destructive",color:"text-red-600"};default:return{label:"نامشخص",variant:"secondary",color:"text-yellow-600"}}})();return s?e.jsxs(ne,{className:t,children:[e.jsxs(Ie,{children:[e.jsxs(Re,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ir,{className:"h-5 w-5"}),"اعلان‌های فوری"]}),e.jsx(Ee,{variant:j.variant,children:j.label})]}),e.jsx(Ys,{children:"برای دریافت آخرین اخبار و به‌روزرسانی‌های آموزشی"})]}),e.jsxs(ae,{className:"space-y-4",children:[i&&e.jsxs(ps,{variant:"destructive",children:[e.jsx(Gs,{className:"h-4 w-4"}),e.jsxs(xs,{className:"flex items-center justify-between",children:[e.jsx("span",{children:i}),e.jsx($,{variant:"ghost",size:"sm",onClick:u,className:"text-xs",children:"بستن"})]})]}),h&&e.jsxs(ps,{children:[e.jsx(mt,{className:"h-4 w-4"}),e.jsx(xs,{children:"اعلان آزمایشی ارسال شد! آن را در دستگاه خود بررسی کنید."})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted rounded-lg",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium",children:"وضعیت اشتراک"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:n?"فعال - شما اعلان‌ها را دریافت می‌کنید":"غیرفعال - اعلان‌ها دریافت نمی‌شوند"})]}),e.jsx("div",{className:`h-3 w-3 rounded-full ${n?"bg-green-500":"bg-gray-300"}`})]}),r==="default"&&e.jsxs($,{onClick:o,disabled:a,className:"w-full",children:[a&&e.jsx(Kt,{className:"mr-2 h-4 w-4 animate-spin"}),"درخواست مجوز اعلان‌ها"]}),r==="granted"&&!n&&e.jsxs($,{onClick:x,disabled:a,className:"w-full",children:[a&&e.jsx(Kt,{className:"mr-2 h-4 w-4 animate-spin"}),e.jsx(ir,{className:"mr-2 h-4 w-4"}),"فعال‌سازی اعلان‌ها"]}),r==="granted"&&n&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs($,{onClick:g,disabled:a,variant:"outline",className:"w-full",children:[a&&e.jsx(Kt,{className:"mr-2 h-4 w-4 animate-spin"}),e.jsx(va,{className:"mr-2 h-4 w-4"}),"غیرفعال‌سازی اعلان‌ها"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs($,{onClick:y,disabled:a,variant:"secondary",className:"w-full",children:[a&&e.jsx(Kt,{className:"mr-2 h-4 w-4 animate-spin"}),e.jsx(Vu,{className:"mr-2 h-4 w-4"}),"ارسال اعلان آزمایشی"]}),e.jsxs($,{onClick:b,disabled:a,variant:"outline",className:"w-full",children:[a&&e.jsx(Kt,{className:"mr-2 h-4 w-4 animate-spin"}),"🎉 تست اعلان خرید دوره"]})]})]}),r==="denied"&&e.jsxs(ps,{children:[e.jsx(Gs,{className:"h-4 w-4"}),e.jsx(xs,{children:"برای فعال‌سازی اعلان‌ها، لطفاً از تنظیمات مرورگر خود، مجوز اعلان‌ها را برای این سایت فعال کنید."})]})]}),e.jsx("div",{className:"pt-3 border-t",children:e.jsxs("details",{className:"group",children:[e.jsx("summary",{className:"cursor-pointer text-sm text-muted-foreground hover:text-foreground transition-colors",children:"اطلاعات فنی"}),e.jsxs("div",{className:"mt-2 space-y-2 text-xs text-muted-foreground",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("span",{children:"پشتیبانی:"}),e.jsx("span",{className:s?"text-green-600":"text-red-600",children:s?"✓ فعال":"✗ غیرفعال"}),e.jsx("span",{children:"مجوز:"}),e.jsx("span",{className:j.color,children:j.label}),e.jsx("span",{children:"اشتراک:"}),e.jsx("span",{className:n?"text-green-600":"text-gray-500",children:n?"✓ فعال":"✗ غیرفعال"})]}),n&&e.jsxs("div",{className:"mt-2 p-2 bg-muted rounded text-xs",children:[e.jsx("p",{className:"font-medium mb-1",children:"Endpoint:"}),e.jsxs("p",{className:"break-all",children:[n.endpoint.slice(0,50),"..."]})]})]})]})})]})]}):e.jsxs(ne,{className:t,children:[e.jsxs(Ie,{children:[e.jsxs(Re,{className:"flex items-center gap-2",children:[e.jsx(va,{className:"h-5 w-5"}),"اعلان‌های فوری"]}),e.jsx(Ys,{children:"مرورگر شما از اعلان‌های فوری پشتیبانی نمی‌کند"})]}),e.jsx(ae,{children:e.jsxs(ps,{children:[e.jsx(Gs,{className:"h-4 w-4"}),e.jsx(xs,{children:"برای استفاده از این قابلیت، لطفاً مرورگر خود را به‌روزرسانی کنید یا از مرورگر مدرن‌تری استفاده کنید."})]})})]})},h0=()=>{const[t,s]=m.useState({subscribe:"checking",unsubscribe:"checking",send:"checking"});m.useEffect(()=>{(async()=>{const o=[{name:"subscribe",url:"/api/push/subscribe"},{name:"unsubscribe",url:"/api/push/unsubscribe"},{name:"send",url:"/api/push/send"}],c={...t};for(const l of o)try{const d=await fetch(l.url,{method:"OPTIONS"});d.status===405?c[l.name]="missing":d.status<500?c[l.name]="available":c[l.name]="error"}catch{c[l.name]="missing"}s(c)})()},[]);const r=i=>{switch(i){case"checking":return{icon:e.jsx(Kt,{className:"h-3 w-3 animate-spin"}),text:"بررسی...",variant:"secondary",color:"text-gray-500"};case"available":return{icon:e.jsx(mt,{className:"h-3 w-3"}),text:"فعال",variant:"default",color:"text-green-600"};case"missing":return{icon:e.jsx(or,{className:"h-3 w-3"}),text:"غیرفعال",variant:"destructive",color:"text-red-600"};case"error":return{icon:e.jsx(Qs,{className:"h-3 w-3"}),text:"خطا",variant:"destructive",color:"text-red-600"}}},n=t.subscribe==="missing"&&t.unsubscribe==="missing"&&t.send==="missing";return t.subscribe==="available"&&t.unsubscribe==="available"&&t.send==="available"?e.jsxs(ps,{children:[e.jsx(mt,{className:"h-4 w-4"}),e.jsx(xs,{children:"🎉 Backend push notifications کاملاً پیکربندی شده است!"})]}):n?e.jsxs(ps,{variant:"destructive",children:[e.jsx(Qs,{className:"h-4 w-4"}),e.jsxs(xs,{className:"space-y-2",children:[e.jsx("p",{children:e.jsx("strong",{children:"Backend Push Notifications پیکربندی نشده است"})}),e.jsx("p",{className:"text-sm",children:"سیستم push notifications در حالت محلی کار می‌کند. برای عملکرد کامل، لطفاً backend را طبق مستندات پیاده‌سازی کنید."}),e.jsxs("details",{className:"text-xs",children:[e.jsx("summary",{className:"cursor-pointer hover:text-foreground",children:"جزئیات endpoints مورد نیاز"}),e.jsxs("div",{className:"mt-2 space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("code",{children:"POST /api/push/subscribe"}),e.jsx(Ee,{...r(t.subscribe),className:"text-xs",children:r(t.subscribe).text})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("code",{children:"POST /api/push/unsubscribe"}),e.jsx(Ee,{...r(t.unsubscribe),className:"text-xs",children:r(t.unsubscribe).text})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("code",{children:"POST /api/push/send"}),e.jsx(Ee,{...r(t.send),className:"text-xs",children:r(t.send).text})]})]})]})]})]}):e.jsxs(ps,{children:[e.jsx(Qs,{className:"h-4 w-4"}),e.jsxs(xs,{className:"space-y-2",children:[e.jsx("p",{children:e.jsx("strong",{children:"Backend Push Notifications جزئی پیکربندی شده است"})}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[r(t.subscribe).icon,e.jsx("span",{children:"Subscribe"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[r(t.unsubscribe).icon,e.jsx("span",{children:"Unsubscribe"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[r(t.send).icon,e.jsx("span",{children:"Send"})]})]})]})]})};var f0="Separator",To="horizontal",p0=["horizontal","vertical"],_d=m.forwardRef((t,s)=>{const{decorative:r,orientation:n=To,...a}=t,i=x0(n)?n:To,c=r?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return e.jsx($t.div,{"data-orientation":i,...c,...a,ref:s})});_d.displayName=f0;function x0(t){return p0.includes(t)}var Id=_d;const Rd=m.forwardRef(({className:t,orientation:s="horizontal",decorative:r=!0,...n},a)=>e.jsx(Id,{ref:a,decorative:r,orientation:s,className:W("shrink-0 bg-border",s==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",t),...n}));Rd.displayName=Id.displayName;function g0(){const{isSupported:t,permission:s,subscription:r}=zn();return e.jsxs("div",{className:"container mx-auto py-8 space-y-6",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"تست سیستم اعلان‌های فوری"}),e.jsx("p",{className:"text-muted-foreground",children:"این صفحه برای تست و بررسی عملکرد push notifications طراحی شده است"})]}),e.jsxs(ne,{children:[e.jsxs(Ie,{children:[e.jsx(Re,{children:"وضعیت فعلی سیستم"}),e.jsx(Ys,{children:"اطلاعات سریع از وضعیت push notifications"})]}),e.jsx(ae,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"پشتیبانی مرورگر"}),e.jsx(Ee,{variant:t?"default":"destructive",children:t?"پشتیبانی می‌کند":"پشتیبانی نمی‌کند"})]}),e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"مجوز اعلان‌ها"}),e.jsx(Ee,{variant:s==="granted"?"default":s==="denied"?"destructive":"secondary",children:s==="granted"?"مجاز":s==="denied"?"رد شده":"نامشخص"})]}),e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"وضعیت اشتراک"}),e.jsx(Ee,{variant:r?"default":"secondary",children:r?"فعال":"غیرفعال"})]})]})})]}),e.jsxs(ne,{children:[e.jsxs(Ie,{children:[e.jsx(Re,{children:"دکمه‌های سریع"}),e.jsx(Ys,{children:"مثال‌هایی از دکمه‌های مختلف push notification"})]}),e.jsx(ae,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-4 p-3 bg-muted rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium",children:"دکمه ساده (بدون متن):"}),e.jsx(hn,{})]}),e.jsxs("div",{className:"flex items-center gap-4 p-3 bg-muted rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium",children:"دکمه با متن:"}),e.jsx(hn,{showText:!0,variant:"outline"})]}),e.jsxs("div",{className:"flex items-center gap-4 p-3 bg-muted rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium",children:"دکمه بزرگ:"}),e.jsx(hn,{showText:!0,size:"lg",variant:"default"})]})]})})]}),e.jsx(h0,{}),e.jsx(Rd,{}),e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsx(m0,{})}),e.jsxs(ne,{children:[e.jsxs(Ie,{children:[e.jsx(Re,{children:"راهنمای توسعه‌دهنده"}),e.jsx(Ys,{children:"نحوه استفاده از کامپوننت‌ها و hook ها"})]}),e.jsx(ae,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"استفاده از Hook:"}),e.jsx("pre",{className:"bg-muted p-3 rounded text-sm overflow-x-auto",children:`import { usePushNotifications } from '@/hooks/use-push-notifications';

const MyComponent = () => {
  const { 
    isSupported, 
    permission, 
    subscription, 
    subscribe 
  } = usePushNotifications();
  
  return (
    <button onClick={subscribe}>
      فعال‌سازی اعلان‌ها
    </button>
  );
};`})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"استفاده از کامپوننت دکمه:"}),e.jsx("pre",{className:"bg-muted p-3 rounded text-sm overflow-x-auto",children:`import { PushNotificationButton } from '@/components/ui/push-notification-button';

<PushNotificationButton 
  showText={true} 
  variant="outline" 
  size="lg" 
/>`})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"استفاده از کامپوننت تنظیمات:"}),e.jsx("pre",{className:"bg-muted p-3 rounded text-sm overflow-x-auto",children:`import { PushNotificationSettings } from '@/components/ui/push-notification-settings';

<PushNotificationSettings className="max-w-md" />`})]})]})})]}),e.jsxs(ne,{children:[e.jsx(Ie,{children:e.jsx(Re,{children:"توضیحات فنی"})}),e.jsxs(ae,{className:"space-y-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Service Worker:"})," در مسیر ",e.jsx("code",{children:"/public/sw.js"})," قرار دارد و push events را handle می‌کند"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"VAPID Key:"})," کلید عمومی برای authentication با push service"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Subscription:"})," هر کاربر یک subscription منحصربفرد دارد که باید در backend ذخیره شود"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Manifest:"})," فایل manifest.json برای PWA functionality"]})]})]})]})}const b0=()=>{var z,D;const{isInstallable:t,isInstalled:s,isIOS:r,isAndroid:n,isStandalone:a,installApp:i,deferredPrompt:o}=Hn(),{toast:c}=ot(),l=Ze(),[d,u]=m.useState(!1),[h,f]=m.useState(1),[x,g]=m.useState(!1),[y,b]=m.useState(!1),[p,j]=m.useState({}),[v,w]=m.useState(!1),N=parseInt(localStorage.getItem("install-page-visits")||"0")+1;localStorage.setItem("install-page-visits",N.toString()),parseInt(localStorage.getItem("install-auto-refresh-count")||"0"),m.useEffect(()=>{const T=localStorage.getItem("install-last-refresh-time"),R=Date.now();if(T){const F=R-parseInt(T),Z=10*60*1e3;F>Z&&(localStorage.removeItem("install-auto-refresh-count"),localStorage.removeItem("install-last-refresh-time"))}},[]),m.useEffect(()=>{(async()=>{var Z;const R={userAgent:navigator.userAgent,isAndroid:n,isIOS:r,isInstallable:t,isInstalled:s,isStandalone:a,hasDeferredPrompt:!!o,hasServiceWorker:"serviceWorker"in navigator,hasManifest:!!document.querySelector('link[rel="manifest"]'),isHTTPS:location.protocol==="https:",displayMode:window.matchMedia("(display-mode: standalone)").matches?"standalone":"browser",timestamp:new Date().toISOString()};if("serviceWorker"in navigator)try{const B=await navigator.serviceWorker.getRegistrations();R.serviceWorkerRegistrations=B.length,R.serviceWorkerActive=B.some(Y=>Y.active)}catch(B){R.serviceWorkerError=B.message}try{const B=await fetch("/manifest.json");if(R.manifestAccessible=B.ok,B.ok){const Y=await B.json();R.manifestData={name:Y.name,start_url:Y.start_url,display:Y.display,icons:((Z=Y.icons)==null?void 0:Z.length)||0,theme_color:Y.theme_color,background_color:Y.background_color}}}catch(B){R.manifestError=B.message}const F=localStorage.getItem("pwa-debug-event");if(F)try{R.lastEventLog=JSON.parse(F)}catch{R.lastEventLog={error:"Failed to parse event log"}}j(R)})()},[n,r,t,s,a,o]),m.useEffect(()=>{(s||a)&&l("/")},[s,a,l]),m.useEffect(()=>{localStorage.removeItem("should-auto-install"),localStorage.removeItem("install-auto-refresh-count"),localStorage.removeItem("install-last-refresh-time")},[]),m.useEffect(()=>{if(n&&!s&&!a){console.log("Auto install check:",{isAndroid:n,isInstallable:t,isInstalled:s,isStandalone:a,deferredPrompt:!!o});const T=setTimeout(async()=>{if(t&&o&&!v)try{w(!0),console.log("Starting automatic installation..."),c({title:"🚀 شروع نصب خودکار...",description:"اپ در حال اضافه شدن به صفحه اصلی",duration:4e3}),await new Promise(R=>setTimeout(R,500)),await i(),c({title:"🎉 نصب با موفقیت انجام شد!",description:"اکنون می‌توانید از آیکون روی صفحه اصلی استفاده کنید",variant:"default",duration:5e3}),setTimeout(()=>{l("/")},3e3)}catch(R){console.error("Auto install on page load failed:",R),w(!1),c({title:"⚠️ نصب خودکار ناموفق",description:"می‌توانید از دکمه نصب استفاده کنید",variant:"secondary",duration:4e3})}else console.log("PWA prompt not ready for auto install",{isInstallable:t,hasDeferredPrompt:!!o,isAutoInstalling:v})},1200);return()=>clearTimeout(T)}},[n,t,s,a,o,i,c,l,v]);const k=async()=>{if(r){u(!0);return}if(n){if(t&&o)try{c({title:"🚀 در حال نصب...",description:"لطفاً منتظر باشید، Shortcut اضافه می‌شود",duration:3e3}),await i(),c({title:"🎉 نصب موفق بود!",description:"Mr Trader Academy به صفحه اصلی گوشی شما اضافه شد",variant:"default",duration:5e3}),setTimeout(()=>{l("/")},2e3);return}catch(T){console.error("Auto install failed:",T),c({title:"⚠️ نصب خودکار ناموفق",description:"لطفاً راهنمای زیر را دنبال کنید",variant:"destructive",duration:3e3})}c({title:"📱 راهنمای نصب دستی",description:`1️⃣ منوی Chrome یا مرورگر (⋮) را باز کنید
2️⃣ 'Add to Home screen' یا 'افزودن به صفحه اصلی' را بزنید
3️⃣ روی 'Add' یا 'افزودن' کلیک کنید`,duration:12e3}),setTimeout(()=>{c({title:"🔍 نمی‌تونید پیدا کنید؟",description:"در Chrome: منو (3 نقطه بالا راست) ← Install app یا Add to Home screen",duration:8e3})},5e3),setTimeout(()=>{l("/")},8e3)}else c({title:"📱 نصب Shortcut",description:"از منوی مرورگر خود 'Add to Home Screen' یا 'افزودن به صفحه اصلی' را انتخاب کنید",duration:8e3}),setTimeout(()=>{l("/")},4e3)},S=()=>{const T=parseInt(localStorage.getItem("app-install-skip-count")||"0")+1;localStorage.setItem("app-install-skip-count",T.toString()),localStorage.setItem("app-install-skipped",Date.now().toString()),T>=3?c({title:"😢 واقعاً نمی‌خوای نصب کنی؟",description:"با نصب اپ، سرعت و تجربه کاربری خیلی بهتر میشه!",duration:4e3}):T===2&&c({title:"🤔 یکبار دیگه فکر کن!",description:"نصب اپ فقط 10 ثانیه طول می‌کشه",duration:3e3}),l("/")},E=[{icon:e.jsx(oa,{className:"w-6 h-6 text-yellow-500"}),title:"دسترسی فوری",description:"یک کلیک از صفحه اصلی گوشی، مستقیماً وارد سایت شوید"},{icon:e.jsx(kr,{className:"w-6 h-6 text-blue-500"}),title:"آیکون اختصاصی",description:"آیکون زیبا و حرفه‌ای در صفحه اصلی گوشی شما"},{icon:e.jsx(Li,{className:"w-6 h-6 text-green-500"}),title:"امنیت بالا",description:"اطلاعات شما با بالاترین استانداردهای امنیتی محافظت می‌شود"},{icon:e.jsx(Qt,{className:"w-6 h-6 text-purple-500"}),title:"نصب آسان",description:"فقط 10 ثانیه طول می‌کشد و هیچ فضای اضافی اشغال نمی‌کند"}],A=[{step:1,icon:e.jsx(Ks,{className:"w-5 h-5 text-blue-500"}),title:"دکمه Share را بزنید",description:"در پایین صفحه Safari روی آیکون اشتراک‌گذاری ضربه بزنید"},{step:2,icon:e.jsx(Ir,{className:"w-5 h-5 text-blue-500"}),title:"Add to Home Screen",description:"از لیست گزینه‌ها، 'Add to Home Screen' را انتخاب کنید"},{step:3,icon:e.jsx(mt,{className:"w-5 h-5 text-green-500"}),title:"Add را بزنید",description:"نام اپ را تأیید کرده و روی 'Add' ضربه بزنید"}];return d?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:e.jsx("div",{className:"max-w-md w-full",children:e.jsx(ne,{className:"border-0 shadow-2xl bg-white/95 backdrop-blur",children:e.jsxs(ae,{className:"p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"bg-blue-100 rounded-full w-20 h-20 flex items-center justify-center mx-auto mb-4",children:e.jsx(kr,{className:"h-10 w-10 text-blue-600"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"نصب Mr Trader Academy"}),e.jsx("p",{className:"text-gray-600",children:"در iOS، این مراحل را دنبال کنید"})]}),e.jsx("div",{className:"space-y-6 mb-8",children:A.map(T=>e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"bg-blue-50 rounded-full w-10 h-10 flex items-center justify-center flex-shrink-0",children:T.icon}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-1",children:[T.step,". ",T.title]}),e.jsx("p",{className:"text-sm text-gray-600 leading-relaxed",children:T.description})]})]},T.step))}),e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-center justify-center space-x-4 rtl:space-x-reverse",children:[e.jsx("div",{className:"bg-white rounded-lg p-2 shadow-sm",children:e.jsx(Ks,{className:"w-6 h-6 text-blue-500"})}),e.jsx("div",{className:"text-gray-400",children:"→"}),e.jsx("div",{className:"bg-white rounded-lg p-2 shadow-sm",children:e.jsx(Ir,{className:"w-6 h-6 text-blue-500"})}),e.jsx("div",{className:"text-gray-400",children:"→"}),e.jsx("div",{className:"bg-white rounded-lg p-2 shadow-sm",children:e.jsx(mt,{className:"w-6 h-6 text-green-500"})})]})}),e.jsx("div",{className:"space-y-3",children:e.jsx($,{onClick:()=>u(!1),className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-3",children:"متوجه شدم، ادامه می‌دهم"})})]})})})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-trader-50 to-blue-100 relative overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 opacity-5",children:[e.jsx("div",{className:"absolute top-0 left-0 w-96 h-96 bg-trader-500 rounded-full filter blur-3xl"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-96 h-96 bg-blue-500 rounded-full filter blur-3xl"})]}),e.jsx("div",{className:"relative z-10 min-h-screen flex items-center justify-center p-4",children:e.jsx("div",{className:"max-w-lg w-full",children:e.jsx(ne,{className:"border-0 shadow-2xl bg-white/95 backdrop-blur",children:e.jsxs(ae,{className:"p-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs($,{onClick:S,variant:"ghost",className:"text-gray-400 hover:text-gray-600 p-2",children:[e.jsx(Ua,{className:"w-4 h-4 ml-1"}),"رد کن"]}),e.jsxs(Ee,{variant:"outline",className:"bg-trader-50 text-trader-600 border-trader-200",children:[e.jsx(Du,{className:"w-3 h-3 ml-1"}),"رایگان"]})]}),v&&e.jsx("div",{className:"mb-6 p-4 bg-gradient-to-r from-green-50 to-blue-50 rounded-lg border border-green-200",children:e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx("div",{className:"animate-spin",children:e.jsx(oa,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"font-semibold text-green-800",children:"🚀 نصب خودکار در حال انجام"}),e.jsx("p",{className:"text-sm text-green-600",children:"اپ خودکار نصب می‌شود..."})]})]})}),e.jsxs("div",{className:"text-center mb-8",children:[e.jsxs("div",{className:"bg-trader-100 rounded-full w-24 h-24 flex items-center justify-center mx-auto mb-6 relative",children:[e.jsx(kr,{className:"h-12 w-12 text-trader-600"}),e.jsx("div",{className:"absolute -top-1 -right-1",children:e.jsx(Ku,{className:"w-6 h-6 text-yellow-500"})})]}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-3",children:N>=3?"دوباره برگشتی! 😊":N===2?"خوشحالیم که برگشتی! 🎉":"Mr Trader Academy را نصب کنید"}),e.jsx("p",{className:"text-lg text-gray-600 leading-relaxed mb-4",children:N>=3?"به نظر واقعاً علاقه‌مندی! بیا این بار shortcut بسازیم 💪":N===2?"این بار واقعاً ارزششو داره که shortcut بسازی!":"دسترسی سریع به آموزش‌های تریدینگ، مستقیماً از صفحه اصلی گوشی"}),e.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm text-gray-500",children:[e.jsx(Sl,{className:"w-4 h-4 text-yellow-500 fill-current"}),e.jsx("span",{children:"4.9 امتیاز"}),e.jsx("span",{children:"•"}),e.jsx("span",{children:"+۱۰,۰۰۰ دانشجو"})]})]}),e.jsx("div",{className:"space-y-4 mb-8",children:E.map((T,R)=>e.jsxs("div",{className:"flex items-start gap-4 p-4 bg-gray-50 rounded-xl",children:[e.jsx("div",{className:"bg-white rounded-lg p-2 shadow-sm",children:T.icon}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:T.title}),e.jsx("p",{className:"text-sm text-gray-600 leading-relaxed",children:T.description})]})]},R))}),e.jsxs("div",{className:"space-y-4",children:[e.jsx($,{onClick:k,disabled:v,className:"w-full bg-gradient-to-r from-trader-500 to-trader-600 hover:from-trader-600 hover:to-trader-700 text-white font-bold py-4 text-lg shadow-lg hover:shadow-xl transition-all duration-300 disabled:opacity-50",children:v?e.jsxs(e.Fragment,{children:[e.jsx(oa,{className:"w-5 h-5 ml-2 animate-spin"}),"در حال نصب خودکار..."]}):r?e.jsxs(e.Fragment,{children:[e.jsx(Ks,{className:"w-5 h-5 ml-2"}),"راهنمای نصب در iOS"]}):e.jsxs(e.Fragment,{children:[e.jsx(Ha,{className:"w-5 h-5 ml-2"}),"افزودن به صفحه اصلی"]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-4",children:[e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[e.jsx(mt,{className:"w-5 h-5 text-green-500 mx-auto mb-1"}),e.jsx("span",{className:"text-xs font-medium text-green-700",children:"نصب آسان"})]}),e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[e.jsx(Li,{className:"w-5 h-5 text-blue-500 mx-auto mb-1"}),e.jsx("span",{className:"text-xs font-medium text-blue-700",children:"کاملاً امن"})]})]}),e.jsx($,{onClick:S,variant:"ghost",className:"w-full text-gray-500 hover:text-gray-700 text-sm py-2",children:"فعلاً از نسخه وب استفاده می‌کنم"})]}),e.jsx("div",{className:"text-center mt-6 pt-6 border-t border-gray-100",children:e.jsx("p",{className:"text-xs text-gray-500",children:"🔒 امن • 🚀 سریع • 📱 بهینه برای موبایل"})}),n&&!t&&e.jsx("div",{className:"mt-4",children:e.jsxs($,{onClick:()=>b(!y),variant:"ghost",size:"sm",className:"w-full text-xs text-gray-400 hover:text-gray-600",children:[e.jsx(ku,{className:"w-3 h-3 ml-1"}),y?"مخفی کردن اطلاعات فنی":"نمایش اطلاعات فنی"]})}),y&&e.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg text-xs",children:[e.jsxs("h4",{className:"font-semibold mb-2 flex items-center",children:[e.jsx(qa,{className:"w-3 h-3 ml-1"}),"اطلاعات فنی"]}),e.jsxs("div",{className:"space-y-1 text-gray-600",children:[e.jsxs("div",{children:["اندروید: ",p.isAndroid?"✅":"❌"]}),e.jsxs("div",{children:["قابل نصب: ",p.isInstallable?"✅":"❌"]}),e.jsxs("div",{children:["نصب شده: ",p.isInstalled?"✅":"❌"]}),e.jsxs("div",{children:["حالت Standalone: ",p.isStandalone?"✅":"❌"]}),e.jsxs("div",{children:["Deferred Prompt: ",p.hasDeferredPrompt?"✅":"❌"]}),e.jsxs("div",{children:["Service Worker: ",p.hasServiceWorker?"✅":"❌"]}),e.jsxs("div",{children:["SW فعال: ",p.serviceWorkerActive?"✅":"❌"]}),e.jsxs("div",{children:["Manifest: ",p.hasManifest?"✅":"❌"]}),e.jsxs("div",{children:["Manifest قابل دسترس: ",p.manifestAccessible?"✅":"❌"]}),e.jsxs("div",{children:["HTTPS: ",p.isHTTPS?"✅":"❌"]}),e.jsxs("div",{children:["حالت نمایش: ",p.displayMode]}),p.manifestData&&e.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-200",children:[e.jsxs("div",{children:["نام اپ: ",p.manifestData.name]}),e.jsxs("div",{children:["Start URL: ",p.manifestData.start_url]}),e.jsxs("div",{children:["نوع نمایش: ",p.manifestData.display]}),e.jsxs("div",{children:["تعداد آیکون: ",p.manifestData.icons]}),e.jsxs("div",{children:["رنگ تم: ",p.manifestData.theme_color]}),e.jsxs("div",{children:["رنگ پس‌زمینه: ",p.manifestData.background_color]})]}),p.lastEventLog&&e.jsxs("div",{className:"mt-2 pt-2 border-t border-green-200",children:[e.jsx("div",{className:"text-green-700 font-semibold",children:"آخرین رویداد نصب:"}),e.jsxs("div",{children:["زمان: ",p.lastEventLog.timestamp]}),e.jsxs("div",{children:["Platforms: ",((z=p.lastEventLog.platforms)==null?void 0:z.join(", "))||"N/A"]}),e.jsxs("div",{children:["User Agent: ",p.lastEventLog.userAgent]})]}),(p.serviceWorkerError||p.manifestError)&&e.jsxs("div",{className:"mt-2 pt-2 border-t border-red-200 text-red-600",children:[p.serviceWorkerError&&e.jsxs("div",{children:["خطای SW: ",p.serviceWorkerError]}),p.manifestError&&e.jsxs("div",{children:["خطای Manifest: ",p.manifestError]})]}),e.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-200 text-xs",children:["User Agent: ",(D=p.userAgent)==null?void 0:D.substring(0,100),"..."]})]}),!p.isInstallable&&e.jsxs("div",{className:"mt-3 p-2 bg-yellow-100 rounded text-yellow-800",children:[e.jsx("strong",{children:"توضیح:"})," برای نصب PWA در اندروید نیاز به این شرایط است:",e.jsxs("ul",{className:"list-disc list-inside mt-1 text-xs",children:[e.jsx("li",{children:"Service Worker فعال"}),e.jsx("li",{children:"Manifest.json معتبر"}),e.jsx("li",{children:"HTTPS"}),e.jsx("li",{children:"آیکون‌های 192x192 و 512x512"}),e.jsx("li",{children:"رویداد beforeinstallprompt"})]})]})]})]})})})})]})},y0=()=>{const{user:t,isLoading:s}=Oe(),r=dr();return console.log("ProtectedRoute: Current location:",r.pathname),console.log("ProtectedRoute: User:",t?"authenticated":"not authenticated"),console.log("ProtectedRoute: Loading:",s),s?(console.log("ProtectedRoute: Showing loading state"),e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-trader-500 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"در حال بارگذاری..."})]})})):t?!t.isProfileComplete&&r.pathname!=="/complete-profile"?(console.log("ProtectedRoute: Redirecting to complete profile"),e.jsx(Vs,{to:"/complete-profile",replace:!0})):(console.log("ProtectedRoute: Allowing access to protected route"),e.jsx(Bo,{})):(console.log("ProtectedRoute: Redirecting to login, current path:",r.pathname),e.jsx(Vs,{to:"/login",state:{from:r},replace:!0}))};function v0(){var a,i;const{user:t,isLoading:s}=Oe(),r=dr(),n=((i=(a=r.state)==null?void 0:a.from)==null?void 0:i.pathname)||"/";return console.log("PublicRoute: Current location:",r.pathname),console.log("PublicRoute: User:",t?"authenticated":"not authenticated"),console.log("PublicRoute: Loading:",s),s?(console.log("PublicRoute: Showing loading state"),e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-trader-500 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"در حال بارگذاری..."})]})})):t?(console.log("PublicRoute: User authenticated, redirecting to:",n),e.jsx(Vs,{to:n,replace:!0})):(console.log("PublicRoute: Allowing access to public route"),e.jsx(Bo,{}))}const j0=new Sh({defaultOptions:{queries:{staleTime:1e3*60*5,gcTime:1e3*60*10,retry:3,refetchOnWindowFocus:!0}}}),N0=()=>{const{id:t}=Ms();return console.log("VideoRedirect: Redirecting video ID:",t),t?/^\d+$/.test(t)?e.jsx(Vs,{to:`/content/video/${t}`,replace:!0}):(console.error("VideoRedirect: Invalid ID format:",t),e.jsx(Vs,{to:"/content?type=videos",replace:!0})):(console.error("VideoRedirect: No ID provided, redirecting to content hub"),e.jsx(Vs,{to:"/content?type=videos",replace:!0}))},w0=({children:t})=>{const{manualReload:s}=gp();return U.useEffect(()=>{window.pwaReload=s},[s]),e.jsx(e.Fragment,{children:t})},Po=()=>(console.log("App: Initializing application"),e.jsx(Eh,{client:j0,children:e.jsx(eh,{children:e.jsx(ip,{children:e.jsx(dp,{children:e.jsxs(w0,{children:[e.jsx(rm,{}),e.jsx(Mm,{}),e.jsx(Sc,{}),e.jsx(bp,{}),e.jsx(qd,{children:e.jsxs(Wd,{children:[e.jsx(ve,{element:e.jsx(v0,{}),children:e.jsx(ve,{path:"/login",element:e.jsx(Eg,{})})}),e.jsx(ve,{path:"/",element:e.jsx(mx,{})}),e.jsx(ve,{path:"/install",element:e.jsx(b0,{})}),e.jsx(ve,{path:"/about-us",element:e.jsx(qg,{})}),e.jsx(ve,{path:"/contact-us",element:e.jsx(Hg,{})}),e.jsx(ve,{path:"/content",element:e.jsx(bx,{})}),e.jsx(ve,{path:"/content/:type/:id",element:e.jsx(Xx,{})}),e.jsx(ve,{path:"/videos/:id",element:e.jsx(N0,{})}),e.jsx(ve,{path:"/articles/:id",element:e.jsx(Zx,{})}),e.jsx(ve,{path:"/podcasts/:id",element:e.jsx(eg,{})}),e.jsx(ve,{path:"/livestreams/:id",element:e.jsx(No,{})}),e.jsx(ve,{path:"/webinars/:id",element:e.jsx(No,{})}),e.jsx(ve,{path:"/courses",element:e.jsx(Ug,{})}),e.jsx(ve,{path:"/courses/:slug",element:e.jsx(Rg,{})}),e.jsx(ve,{path:"/test/comments",element:e.jsx(n0,{})}),e.jsx(ve,{path:"/test/bookmarks",element:e.jsx(o0,{})}),e.jsx(ve,{path:"/test/pwa",element:e.jsx(l0,{})}),e.jsx(ve,{path:"/test/notifications",element:e.jsx(g0,{})}),e.jsx(ve,{path:"/debug/pwa",element:e.jsx(c0,{})}),e.jsx(ve,{path:"/payment-verify",element:e.jsx(s0,{})}),e.jsxs(ve,{element:e.jsx(y0,{}),children:[e.jsx(ve,{path:"/complete-profile",element:e.jsx(kg,{})}),e.jsx(ve,{path:"/my-courses",element:e.jsx(ng,{})}),e.jsx(ve,{path:"/bookmarks",element:e.jsx(ag,{})}),e.jsx(ve,{path:"/wallet",element:e.jsx(ug,{})}),e.jsx(ve,{path:"/orders",element:e.jsx(Wg,{})}),e.jsx(ve,{path:"/learn/:courseId",element:e.jsx(e0,{})}),e.jsxs(ve,{path:"/profile",children:[e.jsx(ve,{index:!0,element:e.jsx(ig,{})}),e.jsx(ve,{path:"edit",element:e.jsx(Co,{})})]}),e.jsx(ve,{path:"/edit-profile",element:e.jsx(Co,{})})]}),e.jsx(ve,{path:"*",element:e.jsx(t0,{})})]})})]})})})})})),S0=async()=>{if("fonts"in document)try{await document.fonts.load("400 16px Vazirmatn"),await document.fonts.load("700 16px Vazirmatn"),console.log("✅ Fonts loaded successfully")}catch(t){console.warn("⚠️ Font loading failed, using fallback:",t)}},Od=document.getElementById("root");if(!Od)throw new Error("Root element not found");const Ao=xl(Od);S0().then(()=>{Ao.render(e.jsx(U.StrictMode,{children:e.jsx(Po,{})}))}).catch(()=>{Ao.render(e.jsx(U.StrictMode,{children:e.jsx(Po,{})}))});
